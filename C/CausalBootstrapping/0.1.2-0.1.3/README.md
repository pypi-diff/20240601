# Comparing `tmp/CausalBootstrapping-0.1.2.tar.gz` & `tmp/CausalBootstrapping-0.1.3.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "CausalBootstrapping-0.1.2.tar", last modified: Wed Feb  7 16:02:36 2024, max compression
+gzip compressed data, was "CausalBootstrapping-0.1.3.tar", last modified: Sat Jun  1 16:45:02 2024, max compression
```

## Comparing `CausalBootstrapping-0.1.2.tar` & `CausalBootstrapping-0.1.3.tar`

### file list

```diff
@@ -1,12 +1,12 @@
-drwxrwxrwx   0        0        0        0 2024-02-07 16:02:36.780000 CausalBootstrapping-0.1.2/
-drwxrwxrwx   0        0        0        0 2024-02-07 16:02:36.780000 CausalBootstrapping-0.1.2/CausalBootstrapping.egg-info/
--rw-rw-rw-   0        0        0      582 2024-02-07 16:02:36.000000 CausalBootstrapping-0.1.2/CausalBootstrapping.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      260 2024-02-07 16:02:38.000000 CausalBootstrapping-0.1.2/CausalBootstrapping.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2024-02-07 16:02:36.000000 CausalBootstrapping-0.1.2/CausalBootstrapping.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       19 2024-02-07 16:02:36.000000 CausalBootstrapping-0.1.2/CausalBootstrapping.egg-info/requires.txt
--rw-rw-rw-   0        0        0       32 2024-02-07 16:02:36.000000 CausalBootstrapping-0.1.2/CausalBootstrapping.egg-info/top_level.txt
--rw-rw-rw-   0        0        0      582 2024-02-07 16:02:38.000000 CausalBootstrapping-0.1.2/PKG-INFO
--rw-rw-rw-   0        0        0    30070 2024-02-07 15:16:20.000000 CausalBootstrapping-0.1.2/causalBootstrapping.py
--rw-rw-rw-   0        0        0     8197 2024-01-17 12:19:08.000000 CausalBootstrapping-0.1.2/distEst_lib.py
--rw-rw-rw-   0        0        0       42 2024-02-07 16:02:38.000000 CausalBootstrapping-0.1.2/setup.cfg
--rw-rw-rw-   0        0        0      709 2024-02-07 16:01:46.000000 CausalBootstrapping-0.1.2/setup.py
+drwxrwxrwx   0        0        0        0 2024-06-01 16:45:02.560000 CausalBootstrapping-0.1.3/
+drwxrwxrwx   0        0        0        0 2024-06-01 16:45:02.570000 CausalBootstrapping-0.1.3/CausalBootstrapping.egg-info/
+-rw-rw-rw-   0        0        0      604 2024-06-01 16:45:04.000000 CausalBootstrapping-0.1.3/CausalBootstrapping.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      260 2024-06-01 16:45:04.000000 CausalBootstrapping-0.1.3/CausalBootstrapping.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-06-01 16:45:04.000000 CausalBootstrapping-0.1.3/CausalBootstrapping.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       25 2024-06-01 16:45:04.000000 CausalBootstrapping-0.1.3/CausalBootstrapping.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       32 2024-06-01 16:45:04.000000 CausalBootstrapping-0.1.3/CausalBootstrapping.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0      604 2024-06-01 16:45:04.000000 CausalBootstrapping-0.1.3/PKG-INFO
+-rw-rw-rw-   0        0        0    31053 2024-06-01 16:41:26.000000 CausalBootstrapping-0.1.3/causalBootstrapping.py
+-rw-rw-rw-   0        0        0     8197 2024-01-17 12:19:08.000000 CausalBootstrapping-0.1.3/distEst_lib.py
+-rw-rw-rw-   0        0        0       42 2024-06-01 16:45:04.000000 CausalBootstrapping-0.1.3/setup.cfg
+-rw-rw-rw-   0        0        0      718 2024-06-01 12:57:24.000000 CausalBootstrapping-0.1.3/setup.py
```

### Comparing `CausalBootstrapping-0.1.2/CausalBootstrapping.egg-info/PKG-INFO` & `CausalBootstrapping-0.1.3/CausalBootstrapping.egg-info/PKG-INFO`

 * *Files 10% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 Metadata-Version: 2.1
 Name: CausalBootstrapping
-Version: 0.1.2
+Version: 0.1.3
 Summary: CausalBootstrapping is an easy-access implementation and extention of causal bootstrapping (CB) technique for causal analysis. With certain input of observational data, causal graph and variable distributions, CB resamples the data by adjusting the variable distributions which follow intended causal effects.
 Home-page: https://github.com/JianqiaoMao/CausalBootstrapping
 Author: Jianqiao Mao
 Author-email: jxm1417@student.bham.ac.uk
 License: GPL-3.0
 Requires-Dist: numpy
 Requires-Dist: grapl-causal
+Requires-Dist: scipy
```

### Comparing `CausalBootstrapping-0.1.2/PKG-INFO` & `CausalBootstrapping-0.1.3/PKG-INFO`

 * *Files 10% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 Metadata-Version: 2.1
 Name: CausalBootstrapping
-Version: 0.1.2
+Version: 0.1.3
 Summary: CausalBootstrapping is an easy-access implementation and extention of causal bootstrapping (CB) technique for causal analysis. With certain input of observational data, causal graph and variable distributions, CB resamples the data by adjusting the variable distributions which follow intended causal effects.
 Home-page: https://github.com/JianqiaoMao/CausalBootstrapping
 Author: Jianqiao Mao
 Author-email: jxm1417@student.bham.ac.uk
 License: GPL-3.0
 Requires-Dist: numpy
 Requires-Dist: grapl-causal
+Requires-Dist: scipy
```

### Comparing `CausalBootstrapping-0.1.2/causalBootstrapping.py` & `CausalBootstrapping-0.1.3/causalBootstrapping.py`

 * *Files 2% similar despite different names*

```diff
@@ -128,1753 +128,1814 @@
 000007f0: 6175 6c74 7320 746f 204e 6f6e 652e 0d0a  aults to None...
 00000800: 0d0a 2020 2020 5265 7475 726e 733a 0d0a  ..    Returns:..
 00000810: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
 00000820: 3a20 5468 6520 636f 7272 6573 706f 6e64  : The correspond
 00000830: 696e 6720 6361 7573 616c 2062 6f6f 7473  ing causal boots
 00000840: 7472 6170 7069 6e67 2077 6569 6768 7420  trapping weight 
 00000850: 6675 6e63 7469 6f6e 2e0d 0a20 2020 2022  function...    "
-00000860: 2222 0d0a 2020 2020 0d0a 2020 2020 6465  ""..    ..    de
-00000870: 6620 6469 7669 6465 5f66 756e 6374 696f  f divide_functio
-00000880: 6e73 282a 6675 6e63 7329 3a0d 0a20 2020  ns(*funcs):..   
-00000890: 2020 2020 2064 6566 2064 6976 6973 696f       def divisio
-000008a0: 6e28 2a2a 6b77 6172 6773 293a 0d0a 2020  n(**kwargs):..  
-000008b0: 2020 2020 2020 2020 2020 7061 7261 6d5f            param_
-000008c0: 6e61 6d65 7320 3d20 696e 7370 6563 742e  names = inspect.
-000008d0: 7369 676e 6174 7572 6528 6675 6e63 735b  signature(funcs[
-000008e0: 305d 292e 7061 7261 6d65 7465 7273 0d0a  0]).parameters..
-000008f0: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
-00000900: 6773 203d 207b 6b65 792e 7265 706c 6163  gs = {key.replac
-00000910: 6528 2227 222c 225f 7072 696d 6522 293a  e("'","_prime"):
-00000920: 2076 616c 7565 2066 6f72 206b 6579 2c20   value for key, 
-00000930: 7661 6c75 6520 696e 206b 7761 7267 732e  value in kwargs.
-00000940: 6974 656d 7328 297d 0d0a 2020 2020 2020  items()}..      
-00000950: 2020 2020 2020 7061 7261 6d20 3d20 7b6b        param = {k
-00000960: 6579 203a 206b 7761 7267 735b 6b65 795d  ey : kwargs[key]
-00000970: 2066 6f72 206b 6579 2069 6e20 7061 7261   for key in para
-00000980: 6d5f 6e61 6d65 737d 0d0a 2020 2020 2020  m_names}..      
-00000990: 2020 2020 2020 7265 7375 6c74 203d 2066        result = f
-000009a0: 756e 6373 5b30 5d28 2a2a 7061 7261 6d29  uncs[0](**param)
-000009b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000009c0: 206c 656e 2877 5f6e 6f6d 2920 3e20 313a   len(w_nom) > 1:
-000009d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000009e0: 2020 666f 7220 6e6f 6d5f 6920 696e 2072    for nom_i in r
-000009f0: 616e 6765 2831 2c6c 656e 2877 5f6e 6f6d  ange(1,len(w_nom
-00000a00: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-00000a10: 2020 2020 2020 2020 2070 6172 616d 5f6e           param_n
-00000a20: 616d 6573 203d 2069 6e73 7065 6374 2e73  ames = inspect.s
-00000a30: 6967 6e61 7475 7265 2866 756e 6373 5b6e  ignature(funcs[n
-00000a40: 6f6d 5f69 5d29 2e70 6172 616d 6574 6572  om_i]).parameter
-00000a50: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00000a60: 2020 2020 2020 2070 6172 616d 203d 207b         param = {
-00000a70: 6b65 7920 3a20 6b77 6172 6773 5b6b 6579  key : kwargs[key
-00000a80: 5d20 666f 7220 6b65 7920 696e 2070 6172  ] for key in par
-00000a90: 616d 5f6e 616d 6573 7d0d 0a20 2020 2020  am_names}..     
-00000aa0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00000ab0: 6573 756c 7420 2a3d 2066 756e 6373 5b6e  esult *= funcs[n
-00000ac0: 6f6d 5f69 5d28 2a2a 7061 7261 6d29 0d0a  om_i](**param)..
-00000ad0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00000ae0: 6465 6e6f 6d5f 6920 696e 2072 616e 6765  denom_i in range
-00000af0: 286c 656e 2877 5f6e 6f6d 292c 6c65 6e28  (len(w_nom),len(
-00000b00: 775f 6465 6e6f 6d29 2b6c 656e 2877 5f6e  w_denom)+len(w_n
-00000b10: 6f6d 2929 3a0d 0a20 2020 2020 2020 2020  om)):..         
-00000b20: 2020 2020 2020 2070 6172 616d 5f6e 616d         param_nam
-00000b30: 6573 203d 2069 6e73 7065 6374 2e73 6967  es = inspect.sig
-00000b40: 6e61 7475 7265 2866 756e 6373 5b64 656e  nature(funcs[den
-00000b50: 6f6d 5f69 5d29 2e70 6172 616d 6574 6572  om_i]).parameter
-00000b60: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00000b70: 2020 2070 6172 616d 203d 207b 6b65 7920     param = {key 
-00000b80: 3a20 6b77 6172 6773 5b6b 6579 5d20 666f  : kwargs[key] fo
-00000b90: 7220 6b65 7920 696e 2070 6172 616d 5f6e  r key in param_n
-00000ba0: 616d 6573 7d0d 0a20 2020 2020 2020 2020  ames}..         
-00000bb0: 2020 2020 2020 2072 6573 756c 7420 2f3d         result /=
-00000bc0: 2066 756e 6373 5b64 656e 6f6d 5f69 5d28   funcs[denom_i](
-00000bd0: 2a2a 7061 7261 6d29 0d0a 2020 2020 2020  **param)..      
-00000be0: 2020 2020 2020 6966 2063 6175 7365 5f6b        if cause_k
-00000bf0: 6572 6e65 6c5f 666c 6167 3a0d 0a20 2020  ernel_flag:..   
-00000c00: 2020 2020 2020 2020 2020 2020 2070 6172               par
-00000c10: 616d 5f6e 616d 6573 203d 2069 6e73 7065  am_names = inspe
-00000c20: 6374 2e73 6967 6e61 7475 7265 2866 756e  ct.signature(fun
-00000c30: 6373 5b2d 315d 292e 7061 7261 6d65 7465  cs[-1]).paramete
-00000c40: 7273 0d0a 2020 2020 2020 2020 2020 2020  rs..            
-00000c50: 2020 2020 7061 7261 6d20 3d20 7b6b 6579      param = {key
-00000c60: 203a 206b 7761 7267 735b 6b65 795d 2066   : kwargs[key] f
-00000c70: 6f72 206b 6579 2069 6e20 7061 7261 6d5f  or key in param_
-00000c80: 6e61 6d65 737d 0d0a 2020 2020 2020 2020  names}..        
-00000c90: 2020 2020 2020 2020 7265 7375 6c74 202a          result *
-00000ca0: 3d20 6675 6e63 735b 2d31 5d28 2a2a 7061  = funcs[-1](**pa
-00000cb0: 7261 6d29 0d0a 2020 2020 2020 2020 2020  ram)..          
-00000cc0: 2020 7265 7375 6c74 202a 3d20 286c 616d    result *= (lam
-00000cd0: 6264 6120 6e3a 2031 2f6e 2928 4e29 0d0a  bda n: 1/n)(N)..
-00000ce0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00000cf0: 726e 2072 6573 756c 740d 0a20 2020 2020  rn result..     
-00000d00: 2020 2072 6574 7572 6e20 6469 7669 7369     return divisi
-00000d10: 6f6e 2020 2020 0d0a 2020 2020 0d0a 2020  on    ..    ..  
-00000d20: 2020 6361 7573 655f 7661 7220 3d20 696e    cause_var = in
-00000d30: 7476 5f70 726f 622e 6c68 732e 646f 760d  tv_prob.lhs.dov.
-00000d40: 0a20 2020 2065 6666 5f76 6172 203d 2069  .    eff_var = i
-00000d50: 6e74 765f 7072 6f62 2e6c 6873 2e6e 756d  ntv_prob.lhs.num
-00000d60: 5b30 5d0d 0a20 2020 2077 5f64 656e 6f6d  [0]..    w_denom
-00000d70: 203d 2069 6e74 765f 7072 6f62 2e72 6873   = intv_prob.rhs
-00000d80: 2e64 656e 0d0a 2020 2020 775f 6465 6e6f  .den..    w_deno
-00000d90: 6d20 3d20 5b73 6f72 7465 6428 775f 6465  m = [sorted(w_de
-00000da0: 6e6f 6d5b 695d 2920 666f 7220 6920 696e  nom[i]) for i in
-00000db0: 2072 616e 6765 286c 656e 2877 5f64 656e   range(len(w_den
-00000dc0: 6f6d 2929 5d0d 0a20 2020 2077 5f6e 6f6d  om))]..    w_nom
-00000dd0: 203d 2069 6e74 765f 7072 6f62 2e72 6873   = intv_prob.rhs
-00000de0: 2e6e 756d 0d0a 2020 2020 775f 6e6f 6d20  .num..    w_nom 
-00000df0: 3d20 5b73 6f72 7465 6428 775f 6e6f 6d5b  = [sorted(w_nom[
-00000e00: 695d 2920 666f 7220 6920 696e 2072 616e  i]) for i in ran
-00000e10: 6765 286c 656e 2877 5f6e 6f6d 2929 5d0d  ge(len(w_nom))].
-00000e20: 0a20 2020 2065 7073 696c 6f20 3d20 696e  .    epsilo = in
-00000e30: 7476 5f70 726f 622e 7268 732e 6d72 670d  tv_prob.rhs.mrg.
-00000e40: 0a20 2020 2070 615f 7661 7220 3d20 736f  .    pa_var = so
-00000e50: 7274 6564 2865 7073 696c 6f2e 756e 696f  rted(epsilo.unio
-00000e60: 6e28 6566 665f 7661 7229 2e75 6e69 6f6e  n(eff_var).union
-00000e70: 2863 6175 7365 5f76 6172 2929 0d0a 2020  (cause_var))..  
-00000e80: 2020 6966 2070 615f 7661 7220 696e 2077    if pa_var in w
-00000e90: 5f6e 6f6d 3a0d 0a20 2020 2020 2020 2077  _nom:..        w
-00000ea0: 5f6e 6f6d 2e72 656d 6f76 6528 7061 5f76  _nom.remove(pa_v
-00000eb0: 6172 290d 0a20 2020 2020 2020 2063 6175  ar)..        cau
-00000ec0: 7365 5f6b 6572 6e65 6c5f 666c 6167 203d  se_kernel_flag =
-00000ed0: 2054 7275 650d 0a20 2020 2020 2020 2066   True..        f
-00000ee0: 756e 6373 203d 205b 6469 7374 5f6d 6170  uncs = [dist_map
-00000ef0: 5b74 7570 6c65 2877 5f6e 6f6d 5f69 295d  [tuple(w_nom_i)]
-00000f00: 2066 6f72 2077 5f6e 6f6d 5f69 2069 6e20   for w_nom_i in 
-00000f10: 775f 6e6f 6d5d 202b 205b 6469 7374 5f6d  w_nom] + [dist_m
-00000f20: 6170 5b74 7570 6c65 2877 5f64 656e 6f6d  ap[tuple(w_denom
-00000f30: 5f69 295d 2066 6f72 2077 5f64 656e 6f6d  _i)] for w_denom
-00000f40: 5f69 2069 6e20 775f 6465 6e6f 6d5d 202b  _i in w_denom] +
-00000f50: 205b 6b65 726e 656c 5d0d 0a20 2020 2065   [kernel]..    e
-00000f60: 6c73 653a 0d0a 2020 2020 2020 2020 7061  lse:..        pa
-00000f70: 5f76 6172 203d 2073 6574 2870 615f 7661  _var = set(pa_va
-00000f80: 7229 0d0a 2020 2020 2020 2020 7061 5f76  r)..        pa_v
-00000f90: 6172 202d 3d20 6361 7573 655f 7661 720d  ar -= cause_var.
-00000fa0: 0a20 2020 2020 2020 2070 615f 7661 7220  .        pa_var 
-00000fb0: 3d20 736f 7274 6564 286c 6973 7428 7061  = sorted(list(pa
-00000fc0: 5f76 6172 2929 0d0a 2020 2020 2020 2020  _var))..        
-00000fd0: 775f 6e6f 6d2e 7265 6d6f 7665 286c 6973  w_nom.remove(lis
-00000fe0: 7428 7061 5f76 6172 2929 0d0a 2020 2020  t(pa_var))..    
-00000ff0: 2020 2020 6361 7573 655f 6b65 726e 656c      cause_kernel
-00001000: 5f66 6c61 6720 3d20 4661 6c73 650d 0a20  _flag = False.. 
-00001010: 2020 2020 2020 2066 756e 6373 203d 205b         funcs = [
-00001020: 6469 7374 5f6d 6170 5b74 7570 6c65 2877  dist_map[tuple(w
-00001030: 5f6e 6f6d 5f69 295d 2066 6f72 2077 5f6e  _nom_i)] for w_n
-00001040: 6f6d 5f69 2069 6e20 775f 6e6f 6d5d 202b  om_i in w_nom] +
-00001050: 205b 6469 7374 5f6d 6170 5b74 7570 6c65   [dist_map[tuple
-00001060: 2877 5f64 656e 6f6d 5f69 295d 2066 6f72  (w_denom_i)] for
-00001070: 2077 5f64 656e 6f6d 5f69 2069 6e20 775f   w_denom_i in w_
-00001080: 6465 6e6f 6d5d 0d0a 2020 2020 0d0a 2020  denom]..    ..  
-00001090: 2020 7765 6967 6874 5f66 756e 6320 3d20    weight_func = 
-000010a0: 6469 7669 6465 5f66 756e 6374 696f 6e73  divide_functions
-000010b0: 282a 6675 6e63 7329 0d0a 0d0a 2020 2020  (*funcs)....    
-000010c0: 7265 7475 726e 2077 6569 6768 745f 6675  return weight_fu
-000010d0: 6e63 0d0a 0d0a 6465 6620 626f 6f74 7374  nc....def bootst
-000010e0: 7261 7070 6572 2864 6174 612c 2077 6569  rapper(data, wei
-000010f0: 6768 7473 2c20 696e 7476 5f76 6172 5f6e  ghts, intv_var_n
-00001100: 616d 655f 696e 5f64 6174 612c 206d 6f64  ame_in_data, mod
-00001110: 6520 3d20 2266 6173 7422 293a 0d0a 2020  e = "fast"):..  
-00001120: 2020 2222 220d 0a20 2020 2050 6572 666f    """..    Perfo
-00001130: 726d 2062 6f6f 7473 7472 6170 7069 6e67  rm bootstrapping
-00001140: 206f 6e20 7468 6520 696e 7075 7420 6f62   on the input ob
-00001150: 7365 7276 6174 696f 6e61 6c20 6461 7461  servational data
-00001160: 2075 7369 6e67 2074 6865 2070 726f 7669   using the provi
-00001170: 6465 6420 7765 6967 6874 732e 0d0a 2020  ded weights...  
-00001180: 2020 0d0a 2020 2020 5061 7261 6d65 7465    ..    Paramete
-00001190: 7273 3a0d 0a20 2020 2020 2020 2064 6174  rs:..        dat
-000011a0: 6120 2864 6963 7429 3a20 4120 6469 6374  a (dict): A dict
-000011b0: 696f 6e61 7279 2063 6f6e 7461 696e 696e  ionary containin
-000011c0: 6720 7661 7269 6162 6c65 206e 616d 6573  g variable names
-000011d0: 2061 7320 6b65 7973 2061 6e64 2074 6865   as keys and the
-000011e0: 6972 2063 6f72 7265 7370 6f6e 6469 6e67  ir corresponding
-000011f0: 2064 6174 6120 6172 7261 7973 2061 7320   data arrays as 
-00001200: 7661 6c75 6573 2e0d 0a20 2020 2020 2020  values...       
-00001210: 2077 6569 6768 7473 2028 6e75 6d70 792e   weights (numpy.
-00001220: 6e64 6172 7261 7929 3a20 416e 2061 7272  ndarray): An arr
-00001230: 6179 2063 6f6e 7461 696e 696e 6720 7468  ay containing th
-00001240: 6520 7765 6967 6874 7320 636f 6d70 7574  e weights comput
-00001250: 6564 2066 6f72 2065 6163 6820 6461 7461  ed for each data
-00001260: 2070 6f69 6e74 2067 6976 656e 2074 6865   point given the
-00001270: 2069 6e74 6572 7665 6e74 696f 6e61 6c20   interventional 
-00001280: 7661 6c75 6573 2061 7320 616c 6c20 706f  values as all po
-00001290: 7373 6962 6c65 206f 6273 6572 7661 7469  ssible observati
-000012a0: 6f6e 616c 2076 616c 7565 732e 0d0a 2020  onal values...  
-000012b0: 2020 2020 2020 696e 7476 5f76 6172 5f6e        intv_var_n
-000012c0: 616d 655f 696e 5f64 6174 6120 286c 6973  ame_in_data (lis
-000012d0: 7429 3a20 4120 6c69 7374 206f 6620 7661  t): A list of va
-000012e0: 7269 6162 6c65 206e 616d 6573 206f 6620  riable names of 
-000012f0: 6f62 7365 7276 6174 696f 6e61 6c20 6461  observational da
-00001300: 7461 2075 7365 6420 6173 2074 6865 2069  ta used as the i
-00001310: 6e74 6572 7665 6e74 696f 6e61 6c20 7661  nterventional va
-00001320: 6c75 6573 2e0d 0a20 2020 2020 2020 206d  lues...        m
-00001330: 6f64 6520 2873 7472 2c20 6f70 7469 6f6e  ode (str, option
-00001340: 616c 293a 2054 6865 206d 6f64 6520 666f  al): The mode fo
-00001350: 7220 626f 6f74 7374 7261 7070 696e 672e  r bootstrapping.
-00001360: 204f 7074 696f 6e73 3a20 2766 6173 7427   Options: 'fast'
-00001370: 206f 7220 2772 6f62 7573 7427 2e20 4465   or 'robust'. De
-00001380: 6661 756c 7473 2074 6f20 2766 6173 7427  faults to 'fast'
-00001390: 2e0d 0a20 2020 200d 0a20 2020 2052 6574  ...    ..    Ret
-000013a0: 7572 6e73 3a0d 0a20 2020 2020 2020 2064  urns:..        d
-000013b0: 6963 743a 2041 2064 6963 7469 6f6e 6172  ict: A dictionar
-000013c0: 7920 636f 6e74 6169 6e69 6e67 2076 6172  y containing var
-000013d0: 6961 626c 6520 6e61 6d65 7320 6173 206b  iable names as k
-000013e0: 6579 7320 616e 6420 7468 6569 7220 636f  eys and their co
-000013f0: 7272 6573 706f 6e64 696e 6720 626f 6f74  rresponding boot
-00001400: 7374 7261 7070 6564 2064 6174 6120 6172  strapped data ar
-00001410: 7261 7973 2061 7320 7661 6c75 6573 2e0d  rays as values..
-00001420: 0a20 2020 2022 2222 0d0a 2020 2020 0d0a  .    """..    ..
-00001430: 2020 2020 6966 206d 6f64 6520 3d3d 2022      if mode == "
-00001440: 726f 6275 7374 223a 0d0a 2020 2020 2020  robust":..      
-00001450: 2020 6e6f 726d 5f77 6569 6768 7473 203d    norm_weights =
-00001460: 2077 6569 6768 7473 2f6e 702e 7375 6d28   weights/np.sum(
-00001470: 7765 6967 6874 7329 0d0a 2020 2020 2020  weights)..      
-00001480: 2020 7765 6967 6874 7320 3d20 6e70 2e77    weights = np.w
-00001490: 6865 7265 286e 6f72 6d5f 7765 6967 6874  here(norm_weight
-000014a0: 7320 3e20 302c 202d 312f 6e70 2e6c 6f67  s > 0, -1/np.log
-000014b0: 286e 6f72 6d5f 7765 6967 6874 7329 2c20  (norm_weights), 
-000014c0: 3029 0d0a 2020 2020 2020 2020 0d0a 2020  0)..        ..  
-000014d0: 2020 7661 725f 6e61 6d65 7320 3d20 6c69    var_names = li
-000014e0: 7374 2864 6174 612e 6b65 7973 2829 290d  st(data.keys()).
-000014f0: 0a20 2020 204e 203d 2064 6174 615b 7661  .    N = data[va
-00001500: 725f 6e61 6d65 735b 305d 5d2e 7368 6170  r_names[0]].shap
-00001510: 655b 305d 0d0a 2020 2020 626f 6f74 7374  e[0]..    bootst
-00001520: 7261 705f 6461 7461 5f6b 6579 7320 3d20  rap_data_keys = 
-00001530: 7661 725f 6e61 6d65 7320 2b20 5b22 696e  var_names + ["in
-00001540: 7476 5f22 2b69 6e74 765f 7661 725f 6e61  tv_"+intv_var_na
-00001550: 6d65 5f69 6e5f 6461 7461 5b69 5d20 666f  me_in_data[i] fo
-00001560: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
-00001570: 2869 6e74 765f 7661 725f 6e61 6d65 5f69  (intv_var_name_i
-00001580: 6e5f 6461 7461 2929 5d0d 0a20 2020 2062  n_data))]..    b
-00001590: 6f6f 7473 7472 6170 5f64 6174 6120 3d20  ootstrap_data = 
-000015a0: 6469 6374 287a 6970 2862 6f6f 7473 7472  dict(zip(bootstr
-000015b0: 6170 5f64 6174 615f 6b65 7973 2c20 5b5b  ap_data_keys, [[
-000015c0: 5d20 666f 7220 6920 696e 2072 616e 6765  ] for i in range
-000015d0: 286c 656e 2862 6f6f 7473 7472 6170 5f64  (len(bootstrap_d
-000015e0: 6174 615f 6b65 7973 2929 5d29 290d 0a20  ata_keys))])).. 
-000015f0: 2020 2069 6e74 765f 7661 6c75 6573 203d     intv_values =
-00001600: 206e 702e 6172 7261 7928 5b64 6174 615b   np.array([data[
-00001610: 765d 2e72 6573 6861 7065 282d 3129 2066  v].reshape(-1) f
-00001620: 6f72 2076 2069 6e20 696e 7476 5f76 6172  or v in intv_var
-00001630: 5f6e 616d 655f 696e 5f64 6174 615d 290d  _name_in_data]).
-00001640: 0a20 2020 2069 6e74 765f 7661 6c75 6573  .    intv_values
-00001650: 5f63 6f6d 6269 6e65 6420 3d20 6c69 7374  _combined = list
-00001660: 2873 6574 287a 6970 282a 696e 7476 5f76  (set(zip(*intv_v
-00001670: 616c 7565 7329 2929 0d0a 0d0a 2020 2020  alues)))....    
-00001680: 666f 7220 692c 2076 2069 6e20 656e 756d  for i, v in enum
-00001690: 6572 6174 6528 696e 7476 5f76 616c 7565  erate(intv_value
-000016a0: 735f 636f 6d62 696e 6564 293a 0d0a 2020  s_combined):..  
-000016b0: 2020 2020 2020 7765 6967 6874 5f69 6e74        weight_int
-000016c0: 7620 3d20 7765 6967 6874 735b 3a2c 2069  v = weights[:, i
-000016d0: 5d0d 0a20 2020 2020 2020 206e 5f73 616d  ]..        n_sam
-000016e0: 706c 6520 3d20 6e70 2e77 6865 7265 286e  ple = np.where(n
-000016f0: 702e 616c 6c28 696e 7476 5f76 616c 7565  p.all(intv_value
-00001700: 735b 3a6c 656e 2876 292c 203a 5d2e 5420  s[:len(v), :].T 
-00001710: 3d3d 206e 702e 6172 7261 7928 7629 2c20  == np.array(v), 
-00001720: 6178 6973 3d31 2929 5b30 5d2e 7368 6170  axis=1))[0].shap
-00001730: 655b 305d 0d0a 2020 2020 2020 2020 7361  e[0]..        sa
-00001740: 6d70 6c65 5f69 6e64 6963 6573 203d 2072  mple_indices = r
-00001750: 616e 646f 6d2e 6368 6f69 6365 7328 5b6e  andom.choices([n
-00001760: 2066 6f72 206e 2069 6e20 7261 6e67 6528   for n in range(
-00001770: 4e29 5d2c 2077 6569 6768 7473 203d 2077  N)], weights = w
-00001780: 6569 6768 745f 696e 7476 2c20 6b20 3d20  eight_intv, k = 
-00001790: 6e5f 7361 6d70 6c65 290d 0a20 2020 2020  n_sample)..     
-000017a0: 2020 200d 0a20 2020 2020 2020 2066 6f72     ..        for
-000017b0: 2076 6172 2069 6e20 7661 725f 6e61 6d65   var in var_name
-000017c0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-000017d0: 626f 6f74 7374 7261 705f 6461 7461 5b76  bootstrap_data[v
-000017e0: 6172 5d2e 6170 7065 6e64 2864 6174 615b  ar].append(data[
-000017f0: 7661 725d 5b73 616d 706c 655f 696e 6469  var][sample_indi
-00001800: 6365 735d 290d 0a20 2020 2020 2020 2020  ces])..         
-00001810: 2020 200d 0a20 2020 2020 2020 2066 6f72     ..        for
-00001820: 2069 6e74 765f 7661 7220 696e 2069 6e74   intv_var in int
-00001830: 765f 7661 725f 6e61 6d65 5f69 6e5f 6461  v_var_name_in_da
-00001840: 7461 3a0d 0a20 2020 2020 2020 2020 2020  ta:..           
-00001850: 2062 6f6f 7473 7472 6170 5f64 6174 615b   bootstrap_data[
-00001860: 2269 6e74 765f 222b 696e 7476 5f76 6172  "intv_"+intv_var
-00001870: 5d2e 6170 7065 6e64 286e 702e 6172 7261  ].append(np.arra
-00001880: 7928 5b76 2066 6f72 2069 2069 6e20 7261  y([v for i in ra
-00001890: 6e67 6528 6c65 6e28 7361 6d70 6c65 5f69  nge(len(sample_i
-000018a0: 6e64 6963 6573 2929 5d29 290d 0a20 2020  ndices))]))..   
-000018b0: 200d 0a20 2020 2066 6f72 2076 6172 2069   ..    for var i
-000018c0: 6e20 626f 6f74 7374 7261 705f 6461 7461  n bootstrap_data
-000018d0: 5f6b 6579 733a 0d0a 2020 2020 2020 2020  _keys:..        
-000018e0: 626f 6f74 7374 7261 705f 6461 7461 5b76  bootstrap_data[v
-000018f0: 6172 5d20 3d20 6e70 2e76 7374 6163 6b28  ar] = np.vstack(
-00001900: 626f 6f74 7374 7261 705f 6461 7461 5b76  bootstrap_data[v
-00001910: 6172 5d29 0d0a 2020 2020 2020 2020 626f  ar])..        bo
-00001920: 6f74 7374 7261 705f 6461 7461 5b76 6172  otstrap_data[var
-00001930: 2e72 6570 6c61 6365 2822 2722 2c20 2222  .replace("'", ""
-00001940: 295d 203d 2062 6f6f 7473 7472 6170 5f64  )] = bootstrap_d
-00001950: 6174 612e 706f 7028 7661 7229 0d0a 2020  ata.pop(var)..  
-00001960: 2020 7265 7475 726e 2062 6f6f 7473 7472    return bootstr
-00001970: 6170 5f64 6174 610d 0a0d 0a64 6566 2073  ap_data....def s
-00001980: 696d 755f 626f 6f74 7374 7261 7070 6572  imu_bootstrapper
-00001990: 2864 6174 612c 2077 6569 6768 745f 6675  (data, weight_fu
-000019a0: 6e63 2c20 696e 7476 5f76 6172 5f76 616c  nc, intv_var_val
-000019b0: 7565 2c20 6e5f 7361 6d70 6c65 2c20 6d6f  ue, n_sample, mo
-000019c0: 6465 203d 2022 6661 7374 2229 3a0d 0a20  de = "fast"):.. 
-000019d0: 2020 2022 2222 0d0a 2020 2020 5065 7266     """..    Perf
-000019e0: 6f72 6d20 7369 6d75 6c61 7469 6f6e 616c  orm simulational
-000019f0: 2062 6f6f 7473 7472 6170 7069 6e67 206f   bootstrapping o
-00001a00: 6e20 7468 6520 696e 7075 7420 6f62 7365  n the input obse
-00001a10: 7276 6174 696f 6e61 6c20 6461 7461 2075  rvational data u
-00001a20: 7369 6e67 2074 6865 2070 726f 7669 6465  sing the provide
-00001a30: 6420 7765 6967 6874 2066 756e 6374 696f  d weight functio
-00001a40: 6e20 616e 6420 0d0a 2020 2020 6465 7369  n and ..    desi
-00001a50: 676e 6174 6564 2069 6e74 6572 7669 6f6e  gnated intervion
-00001a60: 2076 616c 7565 732e 0d0a 0d0a 2020 2020   values.....    
-00001a70: 5061 7261 6d65 7465 7273 3a0d 0a20 2020  Parameters:..   
-00001a80: 2020 2020 2064 6174 6120 2864 6963 7429       data (dict)
-00001a90: 3a20 4120 6469 6374 696f 6e61 7279 2063  : A dictionary c
-00001aa0: 6f6e 7461 696e 696e 6720 7661 7269 6162  ontaining variab
-00001ab0: 6c65 206e 616d 6573 2061 7320 6b65 7973  le names as keys
-00001ac0: 2061 6e64 2074 6865 6972 2063 6f72 7265   and their corre
-00001ad0: 7370 6f6e 6469 6e67 2064 6174 6120 6172  sponding data ar
-00001ae0: 7261 7973 2061 7320 7661 6c75 6573 2e0d  rays as values..
-00001af0: 0a20 2020 2020 2020 2077 6569 6768 745f  .        weight_
-00001b00: 6675 6e63 2028 6675 6e63 7469 6f6e 293a  func (function):
-00001b10: 2054 6865 2063 6175 7361 6c20 626f 6f74   The causal boot
-00001b20: 7374 7261 7070 696e 6720 7765 6967 6874  strapping weight
-00001b30: 2066 756e 6374 696f 6e2e 0d0a 2020 2020   function...    
-00001b40: 2020 2020 696e 7476 5f76 6172 5f76 616c      intv_var_val
-00001b50: 7565 2028 6469 6374 293a 2041 2064 6963  ue (dict): A dic
-00001b60: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
-00001b70: 6e67 2074 6865 2069 6e74 6572 7665 6e74  ng the intervent
-00001b80: 696f 6e20 7661 7269 6162 6c65 206e 616d  ion variable nam
-00001b90: 6520 6173 2061 206b 6579 2061 6e64 2069  e as a key and i
-00001ba0: 7473 2064 6174 6120 6172 7261 7920 6173  ts data array as
-00001bb0: 2074 6865 2076 616c 7565 2e0d 0a20 2020   the value...   
-00001bc0: 2020 2020 206e 5f73 616d 706c 6520 2869       n_sample (i
-00001bd0: 6e74 293a 2054 6865 206e 756d 6265 7220  nt): The number 
-00001be0: 6f66 2073 616d 706c 6573 2074 6f20 6265  of samples to be
-00001bf0: 2067 656e 6572 6174 6564 2074 6872 6f75   generated throu
-00001c00: 6768 2062 6f6f 7473 7472 6170 7069 6e67  gh bootstrapping
-00001c10: 2e0d 0a20 2020 2020 2020 206d 6f64 6520  ...        mode 
-00001c20: 2873 7472 2c20 6f70 7469 6f6e 616c 293a  (str, optional):
-00001c30: 2054 6865 206d 6f64 6520 666f 7220 626f   The mode for bo
-00001c40: 6f74 7374 7261 7070 696e 672e 204f 7074  otstrapping. Opt
-00001c50: 696f 6e73 3a20 2766 6173 7427 206f 7220  ions: 'fast' or 
-00001c60: 2772 6f62 7573 7427 2e20 4465 6661 756c  'robust'. Defaul
-00001c70: 7473 2074 6f20 2766 6173 7427 2e0d 0a0d  ts to 'fast'....
-00001c80: 0a20 2020 2052 6574 7572 6e73 3a0d 0a20  .    Returns:.. 
-00001c90: 2020 2020 2020 2064 6963 743a 2041 2064         dict: A d
-00001ca0: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
-00001cb0: 6e69 6e67 2076 6172 6961 626c 6520 6e61  ning variable na
-00001cc0: 6d65 7320 6173 206b 6579 7320 616e 6420  mes as keys and 
-00001cd0: 7468 6569 7220 636f 7272 6573 706f 6e64  their correspond
-00001ce0: 696e 6720 626f 6f74 7374 7261 7070 6564  ing bootstrapped
-00001cf0: 2064 6174 6120 6172 7261 7973 2061 7320   data arrays as 
-00001d00: 7661 6c75 6573 2e0d 0a20 2020 2022 2222  values...    """
-00001d10: 0d0a 2020 2020 0d0a 2020 2020 7765 6967  ..    ..    weig
-00001d20: 6874 7320 3d20 7765 6967 6874 5f63 6f6d  hts = weight_com
-00001d30: 7075 7465 2877 6569 6768 745f 6675 6e63  pute(weight_func
-00001d40: 2c20 6461 7461 2c20 696e 7476 5f76 6172  , data, intv_var
-00001d50: 5f76 616c 7565 290d 0a20 2020 2069 6620  _value)..    if 
-00001d60: 6d6f 6465 203d 3d20 2272 6f62 7573 7422  mode == "robust"
-00001d70: 3a0d 0a20 2020 2020 2020 206e 6f72 6d5f  :..        norm_
-00001d80: 7765 6967 6874 7320 3d20 7765 6967 6874  weights = weight
-00001d90: 732f 6e70 2e73 756d 2877 6569 6768 7473  s/np.sum(weights
-00001da0: 290d 0a20 2020 2020 2020 2077 6569 6768  )..        weigh
-00001db0: 7473 203d 206e 702e 7768 6572 6528 6e6f  ts = np.where(no
-00001dc0: 726d 5f77 6569 6768 7473 203e 2030 2c20  rm_weights > 0, 
-00001dd0: 2d31 2f6e 702e 6c6f 6728 6e6f 726d 5f77  -1/np.log(norm_w
-00001de0: 6569 6768 7473 292c 2030 290d 0a20 2020  eights), 0)..   
-00001df0: 2020 2020 2020 0d0a 2020 2020 696e 7476        ..    intv
-00001e00: 5f76 6172 5f6e 616d 6520 3d20 6c69 7374  _var_name = list
-00001e10: 2869 6e74 765f 7661 725f 7661 6c75 652e  (intv_var_value.
-00001e20: 6b65 7973 2829 290d 0a20 2020 2076 6172  keys())..    var
-00001e30: 5f6e 616d 6573 203d 206c 6973 7428 6461  _names = list(da
-00001e40: 7461 2e6b 6579 7328 2929 0d0a 2020 2020  ta.keys())..    
-00001e50: 4e20 3d20 6461 7461 5b76 6172 5f6e 616d  N = data[var_nam
-00001e60: 6573 5b30 5d5d 2e73 6861 7065 5b30 5d0d  es[0]].shape[0].
-00001e70: 0a20 2020 2023 2076 6172 5f6e 616d 6573  .    # var_names
-00001e80: 203d 205b 6974 656d 2066 6f72 2069 7465   = [item for ite
-00001e90: 6d20 696e 2076 6172 5f6e 616d 6573 2069  m in var_names i
-00001ea0: 6620 2869 7465 6d20 696e 2076 6172 5f6e  f (item in var_n
-00001eb0: 616d 6573 2920 616e 6420 2869 7465 6d2e  ames) and (item.
-00001ec0: 7265 706c 6163 6528 2227 222c 2222 2920  replace("'","") 
-00001ed0: 6e6f 7420 696e 2069 6e74 765f 7661 725f  not in intv_var_
-00001ee0: 6e61 6d65 295d 0d0a 2020 2020 626f 6f74  name)]..    boot
-00001ef0: 7374 7261 705f 6461 7461 203d 207b 7d0d  strap_data = {}.
-00001f00: 0a20 2020 2073 616d 706c 655f 696e 6469  .    sample_indi
-00001f10: 6365 7320 3d20 7261 6e64 6f6d 2e63 686f  ces = random.cho
-00001f20: 6963 6573 285b 6e20 666f 7220 6e20 696e  ices([n for n in
-00001f30: 2072 616e 6765 284e 295d 2c20 7765 6967   range(N)], weig
-00001f40: 6874 7320 3d20 7765 6967 6874 732c 206b  hts = weights, k
-00001f50: 203d 206e 5f73 616d 706c 6529 0d0a 2020   = n_sample)..  
-00001f60: 2020 0d0a 2020 2020 666f 7220 7661 7220    ..    for var 
-00001f70: 696e 2076 6172 5f6e 616d 6573 3a0d 0a20  in var_names:.. 
-00001f80: 2020 2020 2020 2062 6f6f 7473 7472 6170         bootstrap
-00001f90: 5f64 6174 615b 7661 722e 7265 706c 6163  _data[var.replac
-00001fa0: 6528 2227 222c 2222 295d 203d 2064 6174  e("'","")] = dat
-00001fb0: 615b 7661 725d 5b73 616d 706c 655f 696e  a[var][sample_in
-00001fc0: 6469 6365 735d 0d0a 2020 2020 666f 7220  dices]..    for 
-00001fd0: 696e 7476 5f76 6172 2069 6e20 696e 7476  intv_var in intv
-00001fe0: 5f76 6172 5f6e 616d 653a 0d0a 2020 2020  _var_name:..    
-00001ff0: 2020 2020 696e 7476 5f76 616c 7565 5f69      intv_value_i
-00002000: 3d20 6e70 2e61 7272 6179 2869 6e74 765f  = np.array(intv_
-00002010: 7661 725f 7661 6c75 655b 696e 7476 5f76  var_value[intv_v
-00002020: 6172 5d29 0d0a 2020 2020 2020 2020 6966  ar])..        if
-00002030: 2069 6e74 765f 7661 6c75 655f 692e 6e64   intv_value_i.nd
-00002040: 696d 203d 3d20 313a 0d0a 2020 2020 2020  im == 1:..      
-00002050: 2020 2020 2020 696e 7476 5f76 616c 7565        intv_value
-00002060: 5f69 203d 2069 6e74 765f 7661 6c75 655f  _i = intv_value_
-00002070: 692e 7265 7368 6170 6528 2d31 2c31 290d  i.reshape(-1,1).
-00002080: 0a20 2020 2020 2020 2062 6f6f 7473 7472  .        bootstr
-00002090: 6170 5f64 6174 615b 2269 6e74 765f 222b  ap_data["intv_"+
-000020a0: 696e 7476 5f76 6172 2069 6620 696e 7476  intv_var if intv
-000020b0: 5f76 6172 2069 6e20 626f 6f74 7374 7261  _var in bootstra
-000020c0: 705f 6461 7461 2e6b 6579 7328 2920 656c  p_data.keys() el
-000020d0: 7365 2069 6e74 765f 7661 725d 203d 2069  se intv_var] = i
-000020e0: 6e74 765f 7661 6c75 655f 695b 7361 6d70  ntv_value_i[samp
-000020f0: 6c65 5f69 6e64 6963 6573 5d0d 0a20 2020  le_indices]..   
-00002100: 2072 6574 7572 6e20 626f 6f74 7374 7261   return bootstra
-00002110: 705f 6461 7461 2c20 7765 6967 6874 730d  p_data, weights.
-00002120: 0a0d 0a64 6566 2067 656e 6572 616c 5f63  ...def general_c
-00002130: 625f 616e 616c 7973 6973 2863 6175 7361  b_analysis(causa
-00002140: 6c5f 6772 6170 682c 2065 6666 6563 745f  l_graph, effect_
-00002150: 7661 725f 6e61 6d65 2c20 6361 7573 655f  var_name, cause_
-00002160: 7661 725f 6e61 6d65 2c20 696e 666f 5f70  var_name, info_p
-00002170: 7269 6e74 203d 2054 7275 652c 2069 646d  rint = True, idm
-00002180: 6f64 6520 3d20 2261 6c6c 222c 2069 6467  ode = "all", idg
-00002190: 7265 6564 7920 3d20 5472 7565 293a 0d0a  reedy = True):..
-000021a0: 2020 2020 0d0a 2020 2020 2222 220d 0a20      ..    """.. 
-000021b0: 2020 2050 6572 666f 726d 2070 7265 2d61     Perform pre-a
-000021c0: 6e61 6c79 7369 7320 666f 7220 7468 6520  nalysis for the 
-000021d0: 6769 7665 6e20 6361 7573 616c 2067 7261  given causal gra
-000021e0: 7068 2077 6974 6820 696e 7465 6e64 6564  ph with intended
-000021f0: 2063 6175 7365 2869 6e74 656e 7665 6e74   cause(intenvent
-00002200: 696f 6e61 6c29 2061 6e64 2065 6666 6563  ional) and effec
-00002210: 7420 7661 7269 6162 6c65 7320 746f 200d  t variables to .
-00002220: 0a20 2020 2066 6f72 6d75 6c61 7465 2074  .    formulate t
-00002230: 6865 2077 6569 6768 7420 6675 6e63 7469  he weight functi
-00002240: 6f6e 2e0d 0a0d 0a20 2020 2054 6869 7320  on.....    This 
-00002250: 6675 6e63 7469 6f6e 2067 656e 6572 6174  function generat
-00002260: 6573 2063 6175 7361 6c20 626f 6f74 7374  es causal bootst
-00002270: 7261 7070 696e 6720 7765 6967 6874 2066  rapping weight f
-00002280: 756e 6374 696f 6e20 616e 6420 7265 7175  unction and requ
-00002290: 6972 6564 2064 6973 7472 6962 7574 696f  ired distributio
-000022a0: 6e73 0d0a 2020 2020 666f 7220 6120 6769  ns..    for a gi
-000022b0: 7665 6e20 6361 7573 616c 2067 7261 7068  ven causal graph
-000022c0: 2061 6e64 2061 2073 7065 6369 6669 6564   and a specified
-000022d0: 2069 6e74 6572 7665 6e74 696f 6e2e 0d0a   intervention...
-000022e0: 0d0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-000022f0: 3a0d 0a20 2020 202d 2063 6175 7361 6c5f  :..    - causal_
-00002300: 6772 6170 6820 2867 7261 706c 2e61 646d  graph (grapl.adm
-00002310: 672e 4144 4d47 206f 626a 6563 7429 3a20  g.ADMG object): 
-00002320: 4120 6361 7573 616c 2067 7261 7068 2072  A causal graph r
-00002330: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
-00002340: 7265 6c61 7469 6f6e 7368 6970 7320 6265  relationships be
-00002350: 7477 6565 6e20 7661 7269 6162 6c65 732e  tween variables.
-00002360: 0d0a 2020 2020 2d20 6566 6665 6374 5f76  ..    - effect_v
-00002370: 6172 5f6e 616d 6520 2873 7472 293a 2054  ar_name (str): T
-00002380: 6865 206e 616d 6520 6f66 2074 6865 2065  he name of the e
-00002390: 6666 6563 7420 7661 7269 6162 6c65 2066  ffect variable f
-000023a0: 6f72 2074 6865 2063 6175 7361 6c20 696e  or the causal in
-000023b0: 7465 7276 656e 7469 6f6e 2e0d 0a20 2020  tervention...   
-000023c0: 202d 2063 6175 7365 5f76 6172 5f6e 616d   - cause_var_nam
-000023d0: 6520 2873 7472 293a 2054 6865 206e 616d  e (str): The nam
-000023e0: 6520 6f66 2074 6865 2063 6175 7365 2076  e of the cause v
-000023f0: 6172 6961 626c 6520 7265 7370 6f6e 7369  ariable responsi
-00002400: 626c 6520 666f 7220 7468 6520 696e 7465  ble for the inte
-00002410: 7276 656e 7469 6f6e 2e0d 0a20 2020 202d  rvention...    -
-00002420: 2069 6e66 6f5f 7072 696e 74ef bc88 626f   info_print...bo
-00002430: 6f6c 2c20 6f70 7469 6f6e 616c 293a 2041  ol, optional): A
-00002440: 2062 6f6f 6c65 616e 2069 6e64 6963 6174   boolean indicat
-00002450: 696e 6720 7768 6574 6865 7220 746f 2070  ing whether to p
-00002460: 7269 6e74 2074 6865 2077 6569 6768 7420  rint the weight 
-00002470: 6675 6e63 7469 6f6e 2061 6e64 2072 6571  function and req
-00002480: 7569 7265 6420 6469 7374 7269 6275 7469  uired distributi
-00002490: 6f6e 732e 2044 6566 6175 6c74 2069 7320  ons. Default is 
-000024a0: 5472 7565 2e0d 0a20 2020 202d 2069 646d  True...    - idm
-000024b0: 6f64 6520 2873 7472 2c20 6f70 7469 6f6e  ode (str, option
-000024c0: 616c 293a 2041 2073 7472 696e 6720 696e  al): A string in
-000024d0: 6469 6361 7469 6e67 2074 6865 206d 6f64  dicating the mod
-000024e0: 6520 666f 7220 6964 656e 7469 6679 696e  e for identifyin
-000024f0: 6720 7468 6520 696e 7465 7276 656e 7469  g the interventi
-00002500: 6f6e 616c 2070 726f 6261 6269 6c69 7479  onal probability
-00002510: 2e20 4974 2063 616e 2062 6520 6569 7468  . It can be eith
-00002520: 6572 2027 616c 6c27 2c20 2773 686f 7274  er 'all', 'short
-00002530: 6573 7427 2c20 276d 6f73 746d 7267 2720  est', 'mostmrg' 
-00002540: 6f72 2027 7261 6e64 6f6d 272e 2044 6566  or 'random'. Def
-00002550: 6175 6c74 2069 7320 2761 6c6c 272e 0d0a  ault is 'all'...
-00002560: 2020 2020 2d20 6964 6772 6565 6479 2028      - idgreedy (
-00002570: 626f 6f6c 2c20 6f70 7469 6f6e 616c 293a  bool, optional):
-00002580: 2041 2062 6f6f 6c65 616e 2069 6e64 6963   A boolean indic
-00002590: 6174 696e 6720 7768 6574 6865 7220 746f  ating whether to
-000025a0: 2075 7365 2074 6865 2067 7265 6564 7920   use the greedy 
-000025b0: 7374 7261 7465 6779 2066 6f72 2069 6465  strategy for ide
-000025c0: 6e74 6966 7969 6e67 2074 6865 2069 6e74  ntifying the int
-000025d0: 6572 7665 6e74 696f 6e61 6c20 7072 6f62  erventional prob
-000025e0: 6162 696c 6974 792e 2044 6566 6175 6c74  ability. Default
-000025f0: 2069 7320 5472 7565 2e0d 0a0d 0a20 2020   is True.....   
-00002600: 2052 6574 7572 6e73 3a0d 0a20 2020 202d   Returns:..    -
-00002610: 2077 6569 6768 745f 6675 6e63 5f6c 616d   weight_func_lam
-00002620: 2028 6675 6e63 7469 6f6e 293a 2041 206c   (function): A l
-00002630: 616d 6264 6120 6675 6e63 7469 6f6e 2074  ambda function t
-00002640: 6f20 6361 6c63 756c 6174 6520 6361 7573  o calculate caus
-00002650: 616c 2062 6f6f 7473 7472 6170 7069 6e67  al bootstrapping
-00002660: 2077 6569 6768 7473 2e0d 0a20 2020 202d   weights...    -
-00002670: 2077 6569 6768 745f 6675 6e63 5f73 7472   weight_func_str
-00002680: 2028 7374 7229 3a20 5468 6520 7374 7269   (str): The stri
-00002690: 6e67 2072 6570 7265 7365 6e74 6174 696f  ng representatio
-000026a0: 6e20 6f66 2074 6865 2063 6175 7361 6c20  n of the causal 
-000026b0: 626f 6f74 7374 7261 7070 696e 6720 7765  bootstrapping we
-000026c0: 6967 6874 7320 6675 6e63 7469 6f6e 2e0d  ights function..
-000026d0: 0a0d 0a20 2020 2055 7361 6765 2049 6e73  ...    Usage Ins
-000026e0: 7472 7563 7469 6f6e 733a 0d0a 2020 2020  tructions:..    
-000026f0: 312e 2043 616c 6c20 7468 6973 2066 756e  1. Call this fun
-00002700: 6374 696f 6e20 7769 7468 2074 6865 2063  ction with the c
-00002710: 6175 7361 6c20 6772 6170 6820 616e 6420  ausal graph and 
-00002720: 7661 7269 6162 6c65 206e 616d 6573 2e0d  variable names..
-00002730: 0a20 2020 2032 2e20 4966 2074 6865 2069  .    2. If the i
-00002740: 6e74 6572 7665 6e74 696f 6e20 6973 2069  ntervention is i
-00002750: 6465 6e74 6966 6961 626c 652c 2069 7420  dentifiable, it 
-00002760: 7769 6c6c 2072 6574 7572 6e20 6120 6c61  will return a la
-00002770: 6d62 6461 2066 756e 6374 696f 6e20 616e  mbda function an
-00002780: 6420 7468 6520 7765 6967 6874 7320 6675  d the weights fu
-00002790: 6e63 7469 6f6e 2073 7472 696e 672e 0d0a  nction string...
-000027a0: 2020 2020 332e 2050 7265 7061 7265 2069      3. Prepare i
-000027b0: 6e70 7574 7320 666f 7220 7468 6520 6c61  nputs for the la
-000027c0: 6d62 6461 2066 756e 6374 696f 6e3a 0d0a  mbda function:..
-000027d0: 2020 2020 2020 202d 2064 6973 745f 6d61         - dist_ma
-000027e0: 703a 2041 2064 6963 7469 6f6e 6172 7920  p: A dictionary 
-000027f0: 636f 6e74 6169 6e69 6e67 2072 6571 7569  containing requi
-00002800: 7265 6420 7072 6f62 6162 696c 6974 7920  red probability 
-00002810: 6469 7374 7269 6275 7469 6f6e 732e 0d0a  distributions...
-00002820: 2020 2020 2020 202d 204e 3a20 5361 6d70         - N: Samp
-00002830: 6c65 2073 697a 6520 666f 7220 7468 6520  le size for the 
-00002840: 696e 7465 7276 656e 7469 6f6e 2e0d 0a20  intervention... 
-00002850: 2020 2020 2020 2d20 6b65 726e 656c 3a20        - kernel: 
-00002860: 284f 7074 696f 6e61 6c29 2041 206b 6572  (Optional) A ker
-00002870: 6e65 6c20 6675 6e63 7469 6f6e 2069 6620  nel function if 
-00002880: 6e65 6564 6564 2e0d 0a20 2020 2034 2e20  needed...    4. 
-00002890: 4361 6c6c 2077 6569 6768 745f 6675 6e63  Call weight_func
-000028a0: 5f6c 616d 2864 6973 745f 6d61 702c 204e  _lam(dist_map, N
-000028b0: 2c20 6b65 726e 656c 2920 746f 2065 7374  , kernel) to est
-000028c0: 696d 6174 6520 7468 6520 6361 7573 616c  imate the causal
-000028d0: 2065 6666 6563 742e 0d0a 2020 2020 2222   effect...    ""
-000028e0: 2220 2020 200d 0a20 2020 200d 0a20 2020  "    ..    ..   
-000028f0: 2067 7261 706c 5f6f 626a 203d 2064 736c   grapl_obj = dsl
-00002900: 2e47 7261 706c 4453 4c28 290d 0a20 2020  .GraplDSL()..   
-00002910: 2047 203d 2067 7261 706c 5f6f 626a 2e72   G = grapl_obj.r
-00002920: 6561 6467 7261 706c 2863 6175 7361 6c5f  eadgrapl(causal_
-00002930: 6772 6170 6829 0d0a 2020 2020 6964 5f73  graph)..    id_s
-00002940: 7472 5f61 6c6c 2c20 6964 5f65 716e 5f61  tr_all, id_eqn_a
-00002950: 6c6c 2c20 6964 656e 7469 6669 6162 6c65  ll, identifiable
-00002960: 203d 2061 6c67 732e 6964 6669 7861 6c6c   = algs.idfixall
-00002970: 2847 2c20 7365 7428 6361 7573 655f 7661  (G, set(cause_va
-00002980: 725f 6e61 6d65 292c 2073 6574 2865 6666  r_name), set(eff
-00002990: 6563 745f 7661 725f 6e61 6d65 292c 200d  ect_var_name), .
-000029a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000029b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000029c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000029d0: 2020 2020 2020 2020 2020 6d6f 6465 203d            mode =
-000029e0: 2069 646d 6f64 652c 2067 7265 6564 7920   idmode, greedy 
-000029f0: 3d20 6964 6772 6565 6479 290d 0a0d 0a20  = idgreedy).... 
-00002a00: 2020 2069 6620 6e6f 7420 6964 656e 7469     if not identi
-00002a10: 6669 6162 6c65 3a0d 0a20 2020 2020 2020  fiable:..       
-00002a20: 2070 7269 6e74 2822 4e6f 7420 6964 656e   print("Not iden
-00002a30: 7469 6669 6162 6c65 2229 0d0a 2020 2020  tifiable")..    
-00002a40: 2020 2020 7265 7475 726e 204e 6f6e 652c      return None,
-00002a50: 204e 6f6e 650d 0a0d 0a20 2020 2069 6620   None....    if 
-00002a60: 6964 6d6f 6465 2021 3d20 2261 6c6c 223a  idmode != "all":
-00002a70: 0d0a 2020 2020 2020 2020 6964 5f73 7472  ..        id_str
-00002a80: 5f61 6c6c 203d 205b 6964 5f73 7472 5f61  _all = [id_str_a
-00002a90: 6c6c 5d0d 0a20 2020 2020 2020 2069 645f  ll]..        id_
-00002aa0: 6571 6e5f 616c 6c20 3d20 5b69 645f 6571  eqn_all = [id_eq
-00002ab0: 6e5f 616c 6c5d 0d0a 2020 2020 2020 2020  n_all]..        
-00002ac0: 0d0a 2020 2020 7369 6d70 6c69 6369 7479  ..    simplicity
-00002ad0: 5f73 636f 7265 203d 2030 0d0a 2020 2020  _score = 0..    
-00002ae0: 6265 7374 5f73 696d 705f 7363 6f72 6520  best_simp_score 
-00002af0: 3d20 300d 0a20 2020 200d 0a20 2020 2063  = 0..    ..    c
-00002b00: 6175 7365 5f76 6172 203d 2069 645f 6571  ause_var = id_eq
-00002b10: 6e5f 616c 6c5b 305d 2e6c 6873 2e64 6f76  n_all[0].lhs.dov
-00002b20: 0d0a 2020 2020 6566 665f 7661 7220 3d20  ..    eff_var = 
-00002b30: 6964 5f65 716e 5f61 6c6c 5b30 5d2e 6c68  id_eqn_all[0].lh
-00002b40: 732e 6e75 6d5b 305d 0d0a 2020 2020 666f  s.num[0]..    fo
-00002b50: 7220 692c 6964 5f65 716e 2069 6e20 656e  r i,id_eqn in en
-00002b60: 756d 6572 6174 6528 6964 5f65 716e 5f61  umerate(id_eqn_a
-00002b70: 6c6c 293a 0d0a 2020 2020 2020 2020 0d0a  ll):..        ..
-00002b80: 2020 2020 2020 2020 775f 6465 6e6f 6d20          w_denom 
-00002b90: 3d20 6964 5f65 716e 2e72 6873 2e64 656e  = id_eqn.rhs.den
-00002ba0: 0d0a 2020 2020 2020 2020 775f 6465 6e6f  ..        w_deno
-00002bb0: 6d20 3d20 5b73 6f72 7465 6428 775f 6465  m = [sorted(w_de
-00002bc0: 6e6f 6d5b 695d 2920 666f 7220 6920 696e  nom[i]) for i in
-00002bd0: 2072 616e 6765 286c 656e 2877 5f64 656e   range(len(w_den
-00002be0: 6f6d 2929 5d0d 0a20 2020 2020 2020 2077  om))]..        w
-00002bf0: 5f6e 6f6d 203d 2069 645f 6571 6e2e 7268  _nom = id_eqn.rh
-00002c00: 732e 6e75 6d0d 0a20 2020 2020 2020 2077  s.num..        w
-00002c10: 5f6e 6f6d 203d 205b 736f 7274 6564 2877  _nom = [sorted(w
-00002c20: 5f6e 6f6d 5b69 5d29 2066 6f72 2069 2069  _nom[i]) for i i
-00002c30: 6e20 7261 6e67 6528 6c65 6e28 775f 6e6f  n range(len(w_no
-00002c40: 6d29 295d 0d0a 2020 2020 2020 2020 0d0a  m))]..        ..
-00002c50: 2020 2020 2020 2020 6566 665f 7661 725f          eff_var_
-00002c60: 636e 745f 6e6f 6d20 3d20 6c65 6e28 5b30  cnt_nom = len([0
-00002c70: 2066 6f72 2077 5f6e 6f6d 5f69 2069 6e20   for w_nom_i in 
-00002c80: 775f 6e6f 6d20 666f 7220 656c 656d 656e  w_nom for elemen
-00002c90: 7420 696e 2077 5f6e 6f6d 5f69 2069 6620  t in w_nom_i if 
-00002ca0: 6c69 7374 2865 6666 5f76 6172 295b 305d  list(eff_var)[0]
-00002cb0: 2069 6e20 656c 656d 656e 745d 290d 0a20   in element]).. 
-00002cc0: 2020 2020 2020 2065 6666 5f76 6172 5f63         eff_var_c
-00002cd0: 6e74 5f64 656e 6f6d 203d 206c 656e 285b  nt_denom = len([
-00002ce0: 3020 666f 7220 775f 6465 6e6f 6d5f 6920  0 for w_denom_i 
-00002cf0: 696e 2077 5f64 656e 6f6d 2066 6f72 2065  in w_denom for e
-00002d00: 6c65 6d65 6e74 2069 6e20 775f 6465 6e6f  lement in w_deno
-00002d10: 6d5f 6920 6966 206c 6973 7428 6566 665f  m_i if list(eff_
-00002d20: 7661 7229 5b30 5d20 696e 2065 6c65 6d65  var)[0] in eleme
-00002d30: 6e74 5d29 0d0a 2020 2020 2020 2020 6566  nt])..        ef
-00002d40: 665f 7661 725f 636e 7420 3d20 6566 665f  f_var_cnt = eff_
-00002d50: 7661 725f 636e 745f 6e6f 6d20 2b20 6566  var_cnt_nom + ef
-00002d60: 665f 7661 725f 636e 745f 6465 6e6f 6d0d  f_var_cnt_denom.
-00002d70: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00002d80: 2020 2023 2043 6865 636b 2069 6620 6f6e     # Check if on
-00002d90: 6c79 206f 6e65 2065 6666 6563 7420 7661  ly one effect va
-00002da0: 7269 6162 6c65 2069 6e20 7468 6520 6578  riable in the ex
-00002db0: 7072 6573 7369 6f6e 0d0a 2020 2020 2020  pression..      
-00002dc0: 2020 7661 6c69 645f 636f 6e64 3120 3d20    valid_cond1 = 
-00002dd0: 6566 665f 7661 725f 636e 743c 3d31 0d0a  eff_var_cnt<=1..
-00002de0: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
-00002df0: 6966 2069 6e74 6572 7665 6e74 696f 6e61  if interventiona
-00002e00: 6c20 7661 7269 6162 6c65 2069 6e20 7468  l variable in th
-00002e10: 6520 6578 7072 6573 7369 6f6e 0d0a 2020  e expression..  
-00002e20: 2020 2020 2020 7661 6c69 645f 636f 6e64        valid_cond
-00002e30: 3220 3d20 2828 616e 7928 6c69 7374 2863  2 = ((any(list(c
-00002e40: 6175 7365 5f76 6172 295b 305d 2069 6e20  ause_var)[0] in 
-00002e50: 775f 6e6f 6d5f 6920 666f 7220 775f 6e6f  w_nom_i for w_no
-00002e60: 6d5f 6920 696e 2077 5f6e 6f6d 2929 206f  m_i in w_nom)) o
-00002e70: 7220 2861 6e79 286c 6973 7428 6361 7573  r (any(list(caus
-00002e80: 655f 7661 7229 5b30 5d20 696e 2077 5f64  e_var)[0] in w_d
-00002e90: 656e 6f6d 5f69 2066 6f72 2077 5f64 656e  enom_i for w_den
-00002ea0: 6f6d 5f69 2069 6e20 775f 6465 6e6f 6d29  om_i in w_denom)
-00002eb0: 2929 0d0a 2020 2020 2020 2020 2320 4368  ))..        # Ch
-00002ec0: 6563 6b20 6966 2050 6128 6566 6665 6374  eck if Pa(effect
-00002ed0: 5f76 6172 2920 6f72 2050 6128 6566 6665  _var) or Pa(effe
-00002ee0: 6374 5f76 6172 295c 6361 7573 655f 7661  ct_var)\cause_va
-00002ef0: 7220 6973 2069 6e20 7468 6520 6e6f 6d69  r is in the nomi
-00002f00: 6e61 746f 720d 0a20 2020 2020 2020 2065  nator..        e
-00002f10: 7073 696c 6f20 3d20 6964 5f65 716e 2e72  psilo = id_eqn.r
-00002f20: 6873 2e6d 7267 0d0a 2020 2020 2020 2020  hs.mrg..        
-00002f30: 5975 5061 3d20 736f 7274 6564 2865 7073  YuPa= sorted(eps
-00002f40: 696c 6f2e 756e 696f 6e28 6566 665f 7661  ilo.union(eff_va
-00002f50: 7229 290d 0a20 2020 2020 2020 2058 7559  r))..        XuY
-00002f60: 7550 6120 3d20 736f 7274 6564 2873 6574  uPa = sorted(set
-00002f70: 2859 7550 6129 2e75 6e69 6f6e 2863 6175  (YuPa).union(cau
-00002f80: 7365 5f76 6172 2929 0d0a 2020 2020 2020  se_var))..      
-00002f90: 2020 2320 6966 2059 2069 7320 696e 2074    # if Y is in t
-00002fa0: 6865 2050 6128 5829 0d0a 2020 2020 2020  he Pa(X)..      
-00002fb0: 2020 5975 5061 5f69 6e5f 6e6f 6d20 3d20    YuPa_in_nom = 
-00002fc0: 5975 5061 2069 6e20 775f 6e6f 6d0d 0a20  YuPa in w_nom.. 
-00002fd0: 2020 2020 2020 2023 2069 6620 5920 6973         # if Y is
-00002fe0: 206e 6f74 2069 6e20 7468 6520 5061 2858   not in the Pa(X
-00002ff0: 2920 0d0a 2020 2020 2020 2020 5875 5975  ) ..        XuYu
-00003000: 5061 5f69 6e5f 6e6f 6d20 3d20 5875 5975  Pa_in_nom = XuYu
-00003010: 5061 2069 6e20 775f 6e6f 6d0d 0a20 2020  Pa in w_nom..   
-00003020: 2020 2020 2076 616c 6964 5f63 6f6e 6433       valid_cond3
-00003030: 203d 2059 7550 615f 696e 5f6e 6f6d 206f   = YuPa_in_nom o
-00003040: 7220 5875 5975 5061 5f69 6e5f 6e6f 6d0d  r XuYuPa_in_nom.
-00003050: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
-00003060: 2069 6620 6974 2069 7320 6120 7661 6c69   if it is a vali
-00003070: 6420 6964 5f65 716e 0d0a 2020 2020 2020  d id_eqn..      
-00003080: 2020 7661 6c69 645f 6964 5f65 716e 203d    valid_id_eqn =
-00003090: 2076 616c 6964 5f63 6f6e 6431 2061 6e64   valid_cond1 and
-000030a0: 2076 616c 6964 5f63 6f6e 6432 2061 6e64   valid_cond2 and
-000030b0: 2076 616c 6964 5f63 6f6e 6433 0d0a 2020   valid_cond3..  
-000030c0: 2020 2020 2020 2320 4372 6974 6572 6961        # Criteria
-000030d0: 2074 6f20 7365 6c65 6374 2074 6865 2073   to select the s
-000030e0: 696d 706c 6573 7420 6964 5f65 716e 0d0a  implest id_eqn..
-000030f0: 2020 2020 2020 2020 7369 6d70 6c69 6369          simplici
-00003100: 7479 5f73 636f 7265 203d 2031 2f28 6c65  ty_score = 1/(le
-00003110: 6e28 775f 6e6f 6d29 2b6c 656e 2877 5f64  n(w_nom)+len(w_d
-00003120: 656e 6f6d 2929 0d0a 2020 2020 2020 2020  enom))..        
-00003130: 0d0a 2020 2020 2020 2020 6966 2076 616c  ..        if val
-00003140: 6964 5f69 645f 6571 6e20 616e 6420 7369  id_id_eqn and si
-00003150: 6d70 6c69 6369 7479 5f73 636f 7265 203e  mplicity_score >
-00003160: 2062 6573 745f 7369 6d70 5f73 636f 7265   best_simp_score
-00003170: 3a0d 0a20 2020 2020 2020 2020 2020 2062  :..            b
-00003180: 6573 745f 7369 6d70 5f73 636f 7265 203d  est_simp_score =
-00003190: 2073 696d 706c 6963 6974 795f 7363 6f72   simplicity_scor
-000031a0: 650d 0a20 2020 2020 2020 2020 2020 200d  e..            .
-000031b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000031c0: 5975 5061 5f69 6e5f 6e6f 6d3a 0d0a 2020  YuPa_in_nom:..  
-000031d0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-000031e0: 726e 656c 5f66 6c61 6720 3d20 4661 6c73  rnel_flag = Fals
-000031f0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00003200: 2020 2077 5f6e 6f6d 2e72 656d 6f76 6528     w_nom.remove(
-00003210: 5975 5061 290d 0a20 2020 2020 2020 2020  YuPa)..         
-00003220: 2020 2069 6620 5875 5975 5061 5f69 6e5f     if XuYuPa_in_
-00003230: 6e6f 6d3a 0d0a 2020 2020 2020 2020 2020  nom:..          
-00003240: 2020 2020 2020 6b65 726e 656c 5f66 6c61        kernel_fla
-00003250: 6720 3d20 5472 7565 0d0a 2020 2020 2020  g = True..      
-00003260: 2020 2020 2020 2020 2020 775f 6e6f 6d2e            w_nom.
-00003270: 7265 6d6f 7665 2858 7559 7550 6129 0d0a  remove(XuYuPa)..
-00003280: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00003290: 2020 2020 2020 2020 2020 6265 7374 5f77            best_w
-000032a0: 5f6e 6f6d 203d 2077 5f6e 6f6d 0d0a 2020  _nom = w_nom..  
-000032b0: 2020 2020 2020 2020 2020 6265 7374 5f77            best_w
-000032c0: 5f64 656e 6f6d 203d 2077 5f64 656e 6f6d  _denom = w_denom
-000032d0: 0d0a 2020 2020 2020 2020 2020 2020 6265  ..            be
-000032e0: 7374 5f69 645f 7374 7220 3d20 6964 5f73  st_id_str = id_s
-000032f0: 7472 5f61 6c6c 5b69 5d0d 0a20 2020 2020  tr_all[i]..     
-00003300: 2020 2020 2020 2062 6573 745f 6964 5f65         best_id_e
-00003310: 716e 203d 2069 645f 6571 6e0d 0a20 2020  qn = id_eqn..   
-00003320: 200d 0a20 2020 2077 6569 6768 745f 6675   ..    weight_fu
-00003330: 6e63 5f6c 616d 203d 206c 616d 6264 6120  nc_lam = lambda 
-00003340: 6469 7374 5f6d 6170 2c20 4e2c 206b 6572  dist_map, N, ker
-00003350: 6e65 6c3a 2077 6569 6768 745f 6675 6e63  nel: weight_func
-00003360: 2862 6573 745f 6964 5f65 716e 2c20 6469  (best_id_eqn, di
-00003370: 7374 5f6d 6170 2c20 4e2c 206b 6572 6e65  st_map, N, kerne
-00003380: 6c29 2020 2020 2020 2020 0d0a 2020 2020  l)        ..    
-00003390: 0d0a 2020 2020 7761 6e74 6564 5f64 6973  ..    wanted_dis
-000033a0: 7420 3d20 5b5d 0d0a 2020 2020 775f 6e6f  t = []..    w_no
-000033b0: 6d5f 7374 7220 3d20 2222 0d0a 2020 2020  m_str = ""..    
-000033c0: 666f 7220 6e6f 6d20 696e 2062 6573 745f  for nom in best_
-000033d0: 775f 6e6f 6d3a 0d0a 2020 2020 2020 2020  w_nom:..        
-000033e0: 6a6f 696e 745f 7661 725f 7374 7220 3d20  joint_var_str = 
-000033f0: 2222 0d0a 2020 2020 2020 2020 666f 7220  ""..        for 
-00003400: 6920 696e 2072 616e 6765 286c 656e 286e  i in range(len(n
-00003410: 6f6d 2929 3a0d 0a20 2020 2020 2020 2020  om)):..         
-00003420: 2020 206a 6f69 6e74 5f76 6172 5f73 7472     joint_var_str
-00003430: 202b 3d20 6e6f 6d5b 695d 0d0a 2020 2020   += nom[i]..    
-00003440: 2020 2020 2020 2020 6966 2069 2021 3d20          if i != 
-00003450: 6c65 6e28 6e6f 6d29 2d31 3a0d 0a20 2020  len(nom)-1:..   
-00003460: 2020 2020 2020 2020 2020 2020 206a 6f69               joi
-00003470: 6e74 5f76 6172 5f73 7472 202b 3d20 222c  nt_var_str += ",
-00003480: 220d 0a20 2020 2020 2020 2077 5f6e 6f6d  "..        w_nom
-00003490: 5f73 7472 202b 3d20 2250 2822 202b 206a  _str += "P(" + j
-000034a0: 6f69 6e74 5f76 6172 5f73 7472 202b 2022  oint_var_str + "
-000034b0: 2922 0d0a 2020 2020 2020 2020 7761 6e74  )"..        want
-000034c0: 6564 5f64 6973 742e 6170 7065 6e64 2822  ed_dist.append("
-000034d0: 5028 2220 2b20 6a6f 696e 745f 7661 725f  P(" + joint_var_
-000034e0: 7374 7220 2b20 2229 2229 0d0a 2020 2020  str + ")")..    
-000034f0: 6966 206b 6572 6e65 6c5f 666c 6167 3a0d  if kernel_flag:.
-00003500: 0a20 2020 2020 2020 206b 6572 6e65 6c5f  .        kernel_
-00003510: 6675 6e63 5f73 7472 203d 2022 4b28 222b  func_str = "K("+
-00003520: 6c69 7374 2863 6175 7365 5f76 6172 295b  list(cause_var)[
-00003530: 305d 2b22 2c22 2b6c 6973 7428 6361 7573  0]+","+list(caus
-00003540: 655f 7661 7229 5b30 5d2b 2227 2922 0d0a  e_var)[0]+"')"..
-00003550: 2020 2020 2020 2020 775f 6e6f 6d5f 7374          w_nom_st
-00003560: 7220 2b3d 206b 6572 6e65 6c5f 6675 6e63  r += kernel_func
-00003570: 5f73 7472 0d0a 2020 2020 0d0a 2020 2020  _str..    ..    
-00003580: 775f 6465 6e6f 6d5f 7374 7220 3d20 2222  w_denom_str = ""
-00003590: 0d0a 2020 2020 666f 7220 6465 6e6f 6d20  ..    for denom 
-000035a0: 696e 2062 6573 745f 775f 6465 6e6f 6d3a  in best_w_denom:
-000035b0: 0d0a 2020 2020 2020 2020 6a6f 696e 745f  ..        joint_
-000035c0: 7661 725f 7374 7220 3d20 2222 0d0a 2020  var_str = ""..  
-000035d0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-000035e0: 616e 6765 286c 656e 2864 656e 6f6d 2929  ange(len(denom))
-000035f0: 3a0d 0a20 2020 2020 2020 2020 2020 206a  :..            j
-00003600: 6f69 6e74 5f76 6172 5f73 7472 202b 3d20  oint_var_str += 
-00003610: 6465 6e6f 6d5b 695d 0d0a 2020 2020 2020  denom[i]..      
-00003620: 2020 2020 2020 6966 2069 2021 3d20 6c65        if i != le
-00003630: 6e28 6465 6e6f 6d29 2d31 3a0d 0a20 2020  n(denom)-1:..   
-00003640: 2020 2020 2020 2020 2020 2020 206a 6f69               joi
-00003650: 6e74 5f76 6172 5f73 7472 202b 3d20 222c  nt_var_str += ",
-00003660: 220d 0a20 2020 2020 2020 2077 5f64 656e  "..        w_den
-00003670: 6f6d 5f73 7472 202b 3d20 2250 2822 202b  om_str += "P(" +
-00003680: 206a 6f69 6e74 5f76 6172 5f73 7472 202b   joint_var_str +
-00003690: 2022 2922 0d0a 2020 2020 2020 2020 7761   ")"..        wa
-000036a0: 6e74 6564 5f64 6973 742e 6170 7065 6e64  nted_dist.append
-000036b0: 2822 5028 2220 2b20 6a6f 696e 745f 7661  ("P(" + joint_va
-000036c0: 725f 7374 7220 2b20 2229 2229 0d0a 2020  r_str + ")")..  
-000036d0: 2020 2020 2020 0d0a 2020 2020 7765 6967        ..    weig
-000036e0: 6874 5f66 756e 635f 7374 7220 3d20 225b  ht_func_str = "[
-000036f0: 222b 775f 6e6f 6d5f 7374 722b 225d 222b  "+w_nom_str+"]"+
-00003700: 222f 4e2a 5b22 202b 775f 6465 6e6f 6d5f  "/N*[" +w_denom_
-00003710: 7374 7220 2b20 225d 220d 0a20 2020 2023  str + "]"..    #
-00003720: 2070 7269 6e74 206f 7574 2069 6e74 6572   print out inter
-00003730: 7665 6e74 696f 6e61 6c20 7072 6f62 6162  ventional probab
-00003740: 696c 6974 7920 6578 7072 6573 7369 6f6e  ility expression
-00003750: 2061 6e64 2072 6571 7569 7265 6420 6469   and required di
-00003760: 7374 7269 6275 7469 6f6e 730d 0a20 2020  stributions..   
-00003770: 2069 6620 696e 666f 5f70 7269 6e74 3a0d   if info_print:.
-00003780: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-00003790: 496e 7465 7276 656e 7469 6f6e 616c 2070  Interventional p
-000037a0: 726f 622e 3a7b 7d22 2e66 6f72 6d61 7428  rob.:{}".format(
-000037b0: 6265 7374 5f69 645f 7374 7229 2920 2020  best_id_str))   
-000037c0: 200d 0a20 2020 2020 2020 2070 7269 6e74   ..        print
-000037d0: 2822 4361 7573 616c 2062 6f6f 7473 7472  ("Causal bootstr
-000037e0: 6170 7069 6e67 2077 6569 6768 7473 2066  apping weights f
-000037f0: 756e 6374 696f 6e3a 207b 7d22 2e66 6f72  unction: {}".for
-00003800: 6d61 7428 7765 6967 6874 5f66 756e 635f  mat(weight_func_
-00003810: 7374 7229 290d 0a20 2020 2020 2020 2070  str))..        p
-00003820: 7269 6e74 2822 5265 7175 6972 6564 2064  rint("Required d
-00003830: 6973 7472 6962 7574 696f 6e73 3a22 290d  istributions:").
-00003840: 0a20 2020 2020 2020 2069 203d 2030 0d0a  .        i = 0..
-00003850: 2020 2020 2020 2020 666f 7220 6469 7374          for dist
-00003860: 2069 6e20 7761 6e74 6564 5f64 6973 743a   in wanted_dist:
-00003870: 0d0a 2020 2020 2020 2020 2020 2020 6920  ..            i 
-00003880: 2b3d 2031 0d0a 2020 2020 2020 2020 2020  += 1..          
-00003890: 2020 7072 696e 7428 227b 7d3a 207b 7d22    print("{}: {}"
-000038a0: 2e66 6f72 6d61 7428 692c 2064 6973 7429  .format(i, dist)
-000038b0: 290d 0a20 2020 2020 2020 2069 6620 6b65  )..        if ke
-000038c0: 726e 656c 5f66 6c61 673a 0d0a 2020 2020  rnel_flag:..    
-000038d0: 2020 2020 2020 2020 7072 696e 7428 224b          print("K
-000038e0: 6572 6e65 6c20 6675 6e63 7469 6f6e 2072  ernel function r
-000038f0: 6571 7569 7265 643a 207b 7d22 2e66 6f72  equired: {}".for
-00003900: 6d61 7428 6b65 726e 656c 5f66 756e 635f  mat(kernel_func_
-00003910: 7374 7229 290d 0a20 2020 200d 0a20 2020  str))..    ..   
-00003920: 2072 6574 7572 6e20 7765 6967 6874 5f66   return weight_f
-00003930: 756e 635f 6c61 6d2c 2077 6569 6768 745f  unc_lam, weight_
-00003940: 6675 6e63 5f73 7472 0d0a 0d0a 6465 6620  func_str....def 
-00003950: 6765 6e65 7261 6c5f 6361 7573 616c 5f62  general_causal_b
-00003960: 6f6f 7473 7472 6170 7069 6e67 5f73 696d  ootstrapping_sim
-00003970: 706c 6528 7765 6967 6874 5f66 756e 635f  ple(weight_func_
-00003980: 6c61 6d2c 2064 6973 745f 6d61 702c 2064  lam, dist_map, d
-00003990: 6174 612c 2069 6e74 765f 7661 725f 6e61  ata, intv_var_na
-000039a0: 6d65 2c20 6b65 726e 656c 203d 204e 6f6e  me, kernel = Non
-000039b0: 652c 206d 6f64 6520 3d20 2266 6173 7422  e, mode = "fast"
-000039c0: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-000039d0: 2050 6572 666f 726d 2063 6175 7361 6c20   Perform causal 
-000039e0: 626f 6f74 7374 7261 7070 696e 6720 666f  bootstrapping fo
-000039f0: 7220 6120 6765 6e65 7261 6c20 6361 7573  r a general caus
-00003a00: 616c 2067 7261 7068 2069 6620 6974 2069  al graph if it i
-00003a10: 7320 6964 656e 7469 6669 6162 6c65 2075  s identifiable u
-00003a20: 7369 6e67 2061 2073 7065 6369 6669 6564  sing a specified
-00003a30: 2077 6569 6768 7420 6675 6e63 7469 6f6e   weight function
-00003a40: 2e20 0d0a 2020 2020 5468 6973 2066 756e  . ..    This fun
-00003a50: 6374 696f 6e20 6973 2064 6573 6967 6e65  ction is designe
-00003a60: 6420 746f 2063 7265 6174 6520 6120 626f  d to create a bo
-00003a70: 6f74 7374 7261 7070 6564 2064 6174 6173  otstrapped datas
-00003a80: 6574 2062 6173 6564 206f 6e20 7468 6520  et based on the 
-00003a90: 7370 6563 6966 6965 6420 696e 7465 7276  specified interv
-00003aa0: 656e 7469 6f6e 2076 6172 6961 626c 6573  ention variables
-00003ab0: 2061 6e64 2074 6865 200d 0a20 2020 2077   and the ..    w
-00003ac0: 6569 6768 7469 6e67 2066 756e 6374 696f  eighting functio
-00003ad0: 6e2e 2054 6865 2066 756e 6374 696f 6e20  n. The function 
-00003ae0: 616c 6c6f 7773 2066 6f72 2061 6e20 6f70  allows for an op
-00003af0: 7469 6f6e 616c 206b 6572 6e65 6c20 746f  tional kernel to
-00003b00: 2062 6520 7370 6563 6966 6965 642e 0d0a   be specified...
-00003b10: 0d0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00003b20: 3a0d 0a20 2020 2020 2020 2077 6569 6768  :..        weigh
-00003b30: 745f 6675 6e63 5f6c 616d 2028 6675 6e63  t_func_lam (func
-00003b40: 7469 6f6e 293a 2041 206c 616d 6264 6120  tion): A lambda 
-00003b50: 6f72 2066 756e 6374 696f 6e20 7468 6174  or function that
-00003b60: 2063 616c 6375 6c61 7465 7320 7765 6967   calculates weig
-00003b70: 6874 732e 2049 7420 7368 6f75 6c64 2074  hts. It should t
-00003b80: 616b 6520 2764 6973 745f 6d61 7027 2c20  ake 'dist_map', 
-00003b90: 274e 272c 2061 6e64 206f 7074 696f 6e61  'N', and optiona
-00003ba0: 6c6c 7920 276b 6572 6e65 6c27 2061 7320  lly 'kernel' as 
-00003bb0: 6172 6775 6d65 6e74 732e 0d0a 2020 2020  arguments...    
-00003bc0: 2020 2020 6469 7374 5f6d 6170 2028 6469      dist_map (di
-00003bd0: 6374 293a 2041 6e20 6f62 6a65 6374 2072  ct): An object r
-00003be0: 6570 7265 7365 6e74 696e 6720 6120 6469  epresenting a di
-00003bf0: 7374 616e 6365 206d 6170 2c20 7768 6963  stance map, whic
-00003c00: 6820 6973 2075 7365 6420 6279 2027 7765  h is used by 'we
-00003c10: 6967 6874 5f66 756e 635f 6c61 6d27 2074  ight_func_lam' t
-00003c20: 6f20 6361 6c63 756c 6174 6520 7765 6967  o calculate weig
-00003c30: 6874 732e 0d0a 2020 2020 2020 2020 6461  hts...        da
-00003c40: 7461 2028 6469 6374 293a 2041 2064 6963  ta (dict): A dic
-00003c50: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
-00003c60: 6e67 2074 6865 2064 6174 6173 6574 2e20  ng the dataset. 
-00003c70: 4b65 7973 2061 7265 2076 6172 6961 626c  Keys are variabl
-00003c80: 6520 6e61 6d65 7320 616e 6420 7661 6c75  e names and valu
-00003c90: 6573 2061 7265 2063 6f72 7265 7370 6f6e  es are correspon
-00003ca0: 6469 6e67 2064 6174 6120 6172 7261 7973  ding data arrays
-00003cb0: 2e0d 0a20 2020 2020 2020 2069 6e74 765f  ...        intv_
-00003cc0: 7661 725f 6e61 6d65 2028 7374 7229 3a20  var_name (str): 
-00003cd0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
-00003ce0: 696e 7465 7276 656e 7469 6f6e 2076 6172  intervention var
-00003cf0: 6961 626c 652e 2054 6869 7320 7661 7269  iable. This vari
-00003d00: 6162 6c65 2073 686f 756c 6420 6265 2061  able should be a
-00003d10: 206b 6579 2069 6e20 7468 6520 2764 6174   key in the 'dat
-00003d20: 6127 2064 6963 7469 6f6e 6172 792e 0d0a  a' dictionary...
-00003d30: 2020 2020 2020 2020 6b65 726e 656c 2028          kernel (
-00003d40: 6675 6e63 7469 6f6e 2c20 6f70 7469 6f6e  function, option
-00003d50: 616c 293a 2041 6e20 6f70 7469 6f6e 616c  al): An optional
-00003d60: 206b 6572 6e65 6c20 6675 6e63 7469 6f6e   kernel function
-00003d70: 2074 6861 7420 6361 6e20 6265 2075 7365   that can be use
-00003d80: 6420 696e 2077 6569 6768 7420 636f 6d70  d in weight comp
-00003d90: 7574 6174 696f 6e2e 2044 6566 6175 6c74  utation. Default
-00003da0: 2069 7320 4e6f 6e65 2e0d 0a20 2020 2020   is None...     
-00003db0: 2020 206d 6f64 6520 2873 7472 2c20 6f70     mode (str, op
-00003dc0: 7469 6f6e 616c 293a 2041 2073 7472 696e  tional): A strin
-00003dd0: 6720 696e 6469 6361 7469 6e67 2074 6865  g indicating the
-00003de0: 2062 6f6f 7473 7472 6170 7069 6e67 206d   bootstrapping m
-00003df0: 6f64 652e 2049 7420 6361 6e20 6265 2065  ode. It can be e
-00003e00: 6974 6865 7220 2766 6173 7427 206f 7220  ither 'fast' or 
-00003e10: 2772 6f62 7573 7427 2064 6570 656e 6469  'robust' dependi
-00003e20: 6e67 206f 6e20 7468 6520 696d 706c 656d  ng on the implem
-00003e30: 656e 7461 7469 6f6e 2e20 4465 6661 756c  entation. Defaul
-00003e40: 7420 6973 2027 6661 7374 272e 0d0a 0d0a  t is 'fast'.....
-00003e50: 2020 2020 5265 7475 726e 733a 0d0a 2020      Returns:..  
-00003e60: 2020 2020 2020 6469 6374 3a20 4120 6469        dict: A di
-00003e70: 6374 696f 6e61 7279 2063 6f6e 7461 696e  ctionary contain
-00003e80: 696e 6720 7661 7269 6162 6c65 206e 616d  ing variable nam
-00003e90: 6573 2061 7320 6b65 7973 2061 6e64 2074  es as keys and t
-00003ea0: 6865 6972 2063 6f72 7265 7370 6f6e 6469  heir correspondi
-00003eb0: 6e67 2062 6f6f 7473 7472 6170 7065 6420  ng bootstrapped 
-00003ec0: 6461 7461 2061 7272 6179 7320 6173 2076  data arrays as v
-00003ed0: 616c 7565 732e 0d0a 2020 2020 2222 220d  alues...    """.
-00003ee0: 0a20 2020 2063 6175 7365 5f64 6174 6120  .    cause_data 
-00003ef0: 3d20 5b76 616c 7565 2066 6f72 206b 6579  = [value for key
-00003f00: 2c20 7661 6c75 6520 696e 2064 6174 612e  , value in data.
-00003f10: 6974 656d 7328 2920 6966 2069 6e74 765f  items() if intv_
-00003f20: 7661 725f 6e61 6d65 2069 6e20 6b65 795d  var_name in key]
-00003f30: 5b30 5d0d 0a20 2020 2069 6e74 765f 7661  [0]..    intv_va
-00003f40: 725f 6e61 6d65 5f69 6e5f 6461 7461 203d  r_name_in_data =
-00003f50: 205b 6b65 7920 666f 7220 6b65 792c 2076   [key for key, v
-00003f60: 616c 7565 2069 6e20 6461 7461 2e69 7465  alue in data.ite
-00003f70: 6d73 2829 2069 6620 696e 7476 5f76 6172  ms() if intv_var
-00003f80: 5f6e 616d 6520 696e 206b 6579 5d5b 305d  _name in key][0]
-00003f90: 0d0a 2020 2020 4e20 3d20 6361 7573 655f  ..    N = cause_
-00003fa0: 6461 7461 2e73 6861 7065 5b30 5d0d 0a20  data.shape[0].. 
-00003fb0: 2020 2069 6620 6b65 726e 656c 2069 7320     if kernel is 
-00003fc0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-00003fd0: 2020 2069 6e74 765f 7661 725f 6e61 6d65     intv_var_name
-00003fe0: 203d 205b 7061 7261 6d20 666f 7220 7061   = [param for pa
-00003ff0: 7261 6d20 696e 2069 6e73 7065 6374 2e73  ram in inspect.s
-00004000: 6967 6e61 7475 7265 286b 6572 6e65 6c29  ignature(kernel)
-00004010: 2e70 6172 616d 6574 6572 7320 6966 2070  .parameters if p
-00004020: 6172 616d 2021 3d20 696e 7476 5f76 6172  aram != intv_var
-00004030: 5f6e 616d 655f 696e 5f64 6174 615d 5b30  _name_in_data][0
-00004040: 5d0d 0a20 2020 200d 0a20 2020 2077 5f66  ]..    ..    w_f
-00004050: 756e 6320 3d20 7765 6967 6874 5f66 756e  unc = weight_fun
-00004060: 635f 6c61 6d28 6469 7374 5f6d 6170 203d  c_lam(dist_map =
-00004070: 2064 6973 745f 6d61 702c 204e 203d 204e   dist_map, N = N
-00004080: 2c20 6b65 726e 656c 203d 206b 6572 6e65  , kernel = kerne
-00004090: 6c29 0d0a 2020 2020 6361 7573 655f 756e  l)..    cause_un
-000040a0: 6971 7565 203d 2073 6574 2863 6175 7365  ique = set(cause
-000040b0: 5f64 6174 612e 7265 7368 6170 6528 2d31  _data.reshape(-1
-000040c0: 2929 0d0a 2020 2020 7765 6967 6874 7320  ))..    weights 
-000040d0: 3d20 6e70 2e7a 6572 6f73 2828 4e2c 206c  = np.zeros((N, l
-000040e0: 656e 2863 6175 7365 5f75 6e69 7175 6529  en(cause_unique)
-000040f0: 2929 0d0a 2020 2020 666f 7220 692c 2079  ))..    for i, y
-00004100: 2069 6e20 656e 756d 6572 6174 6528 6361   in enumerate(ca
-00004110: 7573 655f 756e 6971 7565 293a 0d0a 2020  use_unique):..  
-00004120: 2020 2020 2020 7765 6967 6874 735b 3a2c        weights[:,
-00004130: 695d 3d77 6569 6768 745f 636f 6d70 7574  i]=weight_comput
-00004140: 6528 7765 6967 6874 5f66 756e 6320 3d20  e(weight_func = 
-00004150: 775f 6675 6e63 2c20 6461 7461 203d 2064  w_func, data = d
-00004160: 6174 6120 2c69 6e74 765f 7661 7220 3d20  ata ,intv_var = 
-00004170: 7b69 6e74 765f 7661 725f 6e61 6d65 3a20  {intv_var_name: 
-00004180: 5b79 2066 6f72 2069 2069 6e20 7261 6e67  [y for i in rang
-00004190: 6528 4e29 5d7d 290d 0a20 2020 2020 2020  e(N)]})..       
-000041a0: 200d 0a20 2020 2062 6f6f 7473 7472 6170   ..    bootstrap
-000041b0: 7065 645f 6461 7461 203d 2062 6f6f 7473  ped_data = boots
-000041c0: 7472 6170 7065 7228 6461 7461 203d 2064  trapper(data = d
-000041d0: 6174 612c 2077 6569 6768 7473 203d 2077  ata, weights = w
-000041e0: 6569 6768 7473 2c20 696e 7476 5f76 6172  eights, intv_var
-000041f0: 5f6e 616d 655f 696e 5f64 6174 6120 3d20  _name_in_data = 
-00004200: 5b69 6e74 765f 7661 725f 6e61 6d65 5f69  [intv_var_name_i
-00004210: 6e5f 6461 7461 5d2c 206d 6f64 6520 3d20  n_data], mode = 
-00004220: 6d6f 6465 290d 0a20 2020 200d 0a20 2020  mode)..    ..   
-00004230: 2072 6574 7572 6e20 626f 6f74 7374 7261   return bootstra
-00004240: 7070 6564 5f64 6174 610d 0a0d 0a64 6566  pped_data....def
-00004250: 2067 656e 6572 616c 5f63 6175 7361 6c5f   general_causal_
-00004260: 626f 6f74 7374 7261 7070 696e 675f 7369  bootstrapping_si
-00004270: 6d75 2877 6569 6768 745f 6675 6e63 5f6c  mu(weight_func_l
-00004280: 616d 2c20 6469 7374 5f6d 6170 2c20 6461  am, dist_map, da
-00004290: 7461 2c20 696e 7476 5f76 6172 5f76 616c  ta, intv_var_val
-000042a0: 7565 2c20 6e5f 7361 6d70 6c65 2c20 6b65  ue, n_sample, ke
-000042b0: 726e 656c 203d 204e 6f6e 652c 206d 6f64  rnel = None, mod
-000042c0: 6520 3d20 2266 6173 7422 293a 0d0a 2020  e = "fast"):..  
-000042d0: 2020 2222 220d 0a20 2020 2050 6572 666f    """..    Perfo
-000042e0: 726d 2073 696d 756c 6174 696f 6e61 6c20  rm simulational 
-000042f0: 6361 7573 616c 2062 6f6f 7473 7472 6170  causal bootstrap
-00004300: 7069 6e67 2066 6f72 2061 2067 656e 6572  ping for a gener
-00004310: 616c 2063 6175 7361 6c20 6772 6170 6820  al causal graph 
-00004320: 6966 2069 7420 6973 2069 6465 6e74 6966  if it is identif
-00004330: 6961 626c 6520 7573 696e 6720 6120 7370  iable using a sp
-00004340: 6563 6966 6965 6420 7765 6967 6874 2066  ecified weight f
-00004350: 756e 6374 696f 6e2e 200d 0a20 2020 2054  unction. ..    T
-00004360: 6869 7320 6675 6e63 7469 6f6e 2069 7320  his function is 
-00004370: 6465 7369 676e 6564 2074 6f20 6372 6561  designed to crea
-00004380: 7465 2061 2062 6f6f 7473 7472 6170 7065  te a bootstrappe
-00004390: 6420 6461 7461 7365 7420 6261 7365 6420  d dataset based 
-000043a0: 6f6e 2074 6865 2073 7065 6369 6669 6564  on the specified
-000043b0: 2069 6e74 6572 7665 6e74 696f 6e20 7b76   intervention {v
-000043c0: 6172 6961 626c 653a 7661 6c75 6573 7d20  ariable:values} 
-000043d0: 7061 6972 2061 6e64 2074 6865 2077 6569  pair and the wei
-000043e0: 6768 7469 6e67 2066 756e 6374 696f 6e2e  ghting function.
-000043f0: 0d0a 2020 2020 5468 6520 6675 6e63 7469  ..    The functi
-00004400: 6f6e 2061 6c6c 6f77 7320 666f 7220 616e  on allows for an
-00004410: 206f 7074 696f 6e61 6c20 6b65 726e 656c   optional kernel
-00004420: 2074 6f20 6265 2073 7065 6369 6669 6564   to be specified
-00004430: 2e0d 0a0d 0a20 2020 2050 6172 616d 6574  .....    Paramet
-00004440: 6572 733a 0d0a 2020 2020 2020 2020 7765  ers:..        we
-00004450: 6967 6874 5f66 756e 635f 6c61 6d20 2866  ight_func_lam (f
-00004460: 756e 6374 696f 6e29 3a20 4120 6c61 6d62  unction): A lamb
-00004470: 6461 206f 7220 6675 6e63 7469 6f6e 2074  da or function t
-00004480: 6861 7420 6361 6c63 756c 6174 6573 2077  hat calculates w
-00004490: 6569 6768 7473 2e20 4974 2073 686f 756c  eights. It shoul
-000044a0: 6420 7461 6b65 2027 6469 7374 5f6d 6170  d take 'dist_map
-000044b0: 272c 2027 4e27 2c20 616e 6420 6f70 7469  ', 'N', and opti
-000044c0: 6f6e 616c 6c79 2027 6b65 726e 656c 2720  onally 'kernel' 
-000044d0: 6173 2061 7267 756d 656e 7473 2e0d 0a20  as arguments... 
-000044e0: 2020 2020 2020 2064 6973 745f 6d61 7020         dist_map 
-000044f0: 2864 6963 7429 3a20 416e 206f 626a 6563  (dict): An objec
-00004500: 7420 7265 7072 6573 656e 7469 6e67 2061  t representing a
-00004510: 2064 6973 7461 6e63 6520 6d61 702c 2077   distance map, w
-00004520: 6869 6368 2069 7320 7573 6564 2062 7920  hich is used by 
-00004530: 2777 6569 6768 745f 6675 6e63 5f6c 616d  'weight_func_lam
-00004540: 2720 746f 2063 616c 6375 6c61 7465 2077  ' to calculate w
-00004550: 6569 6768 7473 2e0d 0a20 2020 2020 2020  eights...       
-00004560: 2064 6174 6120 2864 6963 7429 3a20 4120   data (dict): A 
-00004570: 6469 6374 696f 6e61 7279 2063 6f6e 7461  dictionary conta
-00004580: 696e 696e 6720 7468 6520 6461 7461 7365  ining the datase
-00004590: 742e 204b 6579 7320 6172 6520 7661 7269  t. Keys are vari
-000045a0: 6162 6c65 206e 616d 6573 2061 6e64 2076  able names and v
-000045b0: 616c 7565 7320 6172 6520 636f 7272 6573  alues are corres
-000045c0: 706f 6e64 696e 6720 6461 7461 2061 7272  ponding data arr
-000045d0: 6179 732e 0d0a 2020 2020 2020 2020 696e  ays...        in
-000045e0: 7476 5f76 6172 5f76 616c 7565 2028 6469  tv_var_value (di
-000045f0: 6374 293a 2041 2064 6963 7469 6f6e 6172  ct): A dictionar
-00004600: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
-00004610: 2069 6e74 6572 7665 6e74 696f 6e20 7661   intervention va
-00004620: 7269 6162 6c65 206e 616d 6520 6173 2061  riable name as a
-00004630: 206b 6579 2061 6e64 2069 7473 2064 6174   key and its dat
-00004640: 6120 6172 7261 7920 6173 2074 6865 2076  a array as the v
-00004650: 616c 7565 2e0d 0a20 2020 2020 2020 206e  alue...        n
-00004660: 5f73 616d 706c 6520 2869 6e74 293a 2054  _sample (int): T
-00004670: 6865 206e 756d 6265 7220 6f66 2073 616d  he number of sam
-00004680: 706c 6573 2074 6f20 6265 2067 656e 6572  ples to be gener
-00004690: 6174 6564 2074 6872 6f75 6768 2062 6f6f  ated through boo
-000046a0: 7473 7472 6170 7069 6e67 2e0d 0a20 2020  tstrapping...   
-000046b0: 2020 2020 206b 6572 6e65 6c20 2866 756e       kernel (fun
-000046c0: 6374 696f 6e2c 206f 7074 696f 6e61 6c29  ction, optional)
-000046d0: 3a20 416e 206f 7074 696f 6e61 6c20 6b65  : An optional ke
-000046e0: 726e 656c 2066 756e 6374 696f 6e20 7468  rnel function th
-000046f0: 6174 2063 616e 2062 6520 7573 6564 2069  at can be used i
-00004700: 6e20 7765 6967 6874 2063 6f6d 7075 7461  n weight computa
-00004710: 7469 6f6e 2e20 4465 6661 756c 7420 6973  tion. Default is
-00004720: 204e 6f6e 652e 0d0a 2020 2020 2020 2020   None...        
-00004730: 6d6f 6465 2028 7374 722c 206f 7074 696f  mode (str, optio
-00004740: 6e61 6c29 3a20 4120 7374 7269 6e67 2069  nal): A string i
-00004750: 6e64 6963 6174 696e 6720 7468 6520 626f  ndicating the bo
-00004760: 6f74 7374 7261 7070 696e 6720 6d6f 6465  otstrapping mode
-00004770: 2e20 4974 2063 616e 2062 6520 6569 7468  . It can be eith
-00004780: 6572 2027 6661 7374 2720 6f72 2027 726f  er 'fast' or 'ro
-00004790: 6275 7374 2720 6465 7065 6e64 696e 6720  bust' depending 
-000047a0: 6f6e 2074 6865 2069 6d70 6c65 6d65 6e74  on the implement
-000047b0: 6174 696f 6e2e 2044 6566 6175 6c74 2069  ation. Default i
-000047c0: 7320 2766 6173 7427 2e0d 0a0d 0a20 2020  s 'fast'.....   
-000047d0: 2052 6574 7572 6e73 3a0d 0a20 2020 2020   Returns:..     
-000047e0: 2020 2064 6963 743a 2041 2064 6963 7469     dict: A dicti
-000047f0: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
-00004800: 2076 6172 6961 626c 6520 6e61 6d65 7320   variable names 
-00004810: 6173 206b 6579 7320 616e 6420 7468 6569  as keys and thei
-00004820: 7220 636f 7272 6573 706f 6e64 696e 6720  r corresponding 
-00004830: 626f 6f74 7374 7261 7070 6564 2064 6174  bootstrapped dat
-00004840: 6120 6172 7261 7973 2061 7320 7661 6c75  a arrays as valu
-00004850: 6573 2e0d 0a20 2020 2022 2222 2020 2020  es...    """    
-00004860: 0d0a 2020 2020 4e20 3d20 6c69 7374 2864  ..    N = list(d
-00004870: 6174 612e 7661 6c75 6573 2829 295b 305d  ata.values())[0]
-00004880: 2e73 6861 7065 5b30 5d0d 0a20 2020 2077  .shape[0]..    w
-00004890: 5f66 756e 6320 3d20 7765 6967 6874 5f66  _func = weight_f
-000048a0: 756e 635f 6c61 6d28 6469 7374 5f6d 6170  unc_lam(dist_map
-000048b0: 203d 2064 6973 745f 6d61 702c 204e 203d   = dist_map, N =
-000048c0: 204e 2c20 6b65 726e 656c 203d 206b 6572   N, kernel = ker
-000048d0: 6e65 6c29 0d0a 2020 2020 626f 6f74 7374  nel)..    bootst
-000048e0: 7261 7070 6564 5f64 6174 612c 2077 6569  rapped_data, wei
-000048f0: 6768 7473 203d 2073 696d 755f 626f 6f74  ghts = simu_boot
-00004900: 7374 7261 7070 6572 2864 6174 6120 3d20  strapper(data = 
-00004910: 6461 7461 2c20 7765 6967 6874 5f66 756e  data, weight_fun
-00004920: 6320 3d20 775f 6675 6e63 2c20 696e 7476  c = w_func, intv
-00004930: 5f76 6172 5f76 616c 7565 203d 2069 6e74  _var_value = int
-00004940: 765f 7661 725f 7661 6c75 652c 206e 5f73  v_var_value, n_s
-00004950: 616d 706c 6520 3d20 6e5f 7361 6d70 6c65  ample = n_sample
-00004960: 2c20 6d6f 6465 203d 206d 6f64 6529 0d0a  , mode = mode)..
-00004970: 2020 2020 0d0a 2020 2020 7265 7475 726e      ..    return
-00004980: 2062 6f6f 7473 7472 6170 7065 645f 6461   bootstrapped_da
-00004990: 7461 0d0a 0d0a 6465 6620 6261 636b 646f  ta....def backdo
-000049a0: 6f72 5f73 696d 706c 6528 6361 7573 655f  or_simple(cause_
-000049b0: 6461 7461 2c20 6566 6665 6374 5f64 6174  data, effect_dat
-000049c0: 612c 2063 6f6e 666f 756e 6465 725f 6461  a, confounder_da
-000049d0: 7461 2c20 6469 7374 5f6d 6170 2c20 6b65  ta, dist_map, ke
-000049e0: 726e 656c 5f69 6e74 7620 3d20 4e6f 6e65  rnel_intv = None
-000049f0: 2c20 6d6f 6465 203d 2022 6661 7374 2229  , mode = "fast")
-00004a00: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-00004a10: 5065 7266 6f72 6d20 6261 636b 646f 6f72  Perform backdoor
-00004a20: 2063 6175 7361 6c20 626f 6f74 7374 7261   causal bootstra
-00004a30: 7070 696e 6720 746f 2064 652d 636f 6e66  pping to de-conf
-00004a40: 6f75 6e64 2074 6865 2063 6175 7361 6c20  ound the causal 
-00004a50: 6566 6665 6374 2075 7369 6e67 2074 6865  effect using the
-00004a60: 2070 726f 7669 6465 6420 6f62 7365 7276   provided observ
-00004a70: 6174 696f 6e61 6c20 0d0a 2020 2020 6461  ational ..    da
-00004a80: 7461 2061 6e64 2064 6973 7472 6962 7574  ta and distribut
-00004a90: 696f 6e20 6d61 7073 2e0d 0a0d 0a20 2020  ion maps.....   
-00004aa0: 2050 6172 616d 6574 6572 733a 0d0a 2020   Parameters:..  
-00004ab0: 2020 2020 2020 6361 7573 655f 6461 7461        cause_data
-00004ac0: 2028 6469 6374 293a 2041 2064 6963 7469   (dict): A dicti
-00004ad0: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
-00004ae0: 2074 6865 2063 6175 7365 2076 6172 6961   the cause varia
-00004af0: 626c 6520 6e61 6d65 2061 7320 6120 6b65  ble name as a ke
-00004b00: 7920 616e 6420 6974 7320 6461 7461 2061  y and its data a
-00004b10: 7272 6179 2061 7320 7468 6520 7661 6c75  rray as the valu
-00004b20: 652e 0d0a 2020 2020 2020 2020 6566 6665  e...        effe
-00004b30: 6374 5f64 6174 6120 2864 6963 7429 3a20  ct_data (dict): 
-00004b40: 4120 6469 6374 696f 6e61 7279 2063 6f6e  A dictionary con
-00004b50: 7461 696e 696e 6720 7468 6520 6566 6665  taining the effe
-00004b60: 6374 2076 6172 6961 626c 6520 6e61 6d65  ct variable name
-00004b70: 2061 7320 6120 6b65 7920 616e 6420 6974   as a key and it
-00004b80: 7320 6461 7461 2061 7272 6179 2061 7320  s data array as 
-00004b90: 7468 6520 7661 6c75 652e 0d0a 2020 2020  the value...    
-00004ba0: 2020 2020 636f 6e66 6f75 6e64 6572 5f64      confounder_d
-00004bb0: 6174 6120 2864 6963 7429 3a20 4120 6469  ata (dict): A di
-00004bc0: 6374 696f 6e61 7279 2063 6f6e 7461 696e  ctionary contain
-00004bd0: 696e 6720 7468 6520 636f 6e66 6f75 6e64  ing the confound
-00004be0: 6572 2076 6172 6961 626c 6520 6e61 6d65  er variable name
-00004bf0: 2061 7320 6120 6b65 7920 616e 6420 6974   as a key and it
-00004c00: 7320 6461 7461 2061 7272 6179 2061 7320  s data array as 
-00004c10: 7468 6520 7661 6c75 652e 0d0a 2020 2020  the value...    
-00004c20: 2020 2020 6469 7374 5f6d 6170 2028 6469      dist_map (di
-00004c30: 6374 293a 2041 2064 6963 7469 6f6e 6172  ct): A dictionar
-00004c40: 7920 6d61 7070 696e 6720 7475 706c 6573  y mapping tuples
-00004c50: 206f 6620 7661 7269 6162 6c65 2063 6f6d   of variable com
-00004c60: 6269 6e61 7469 6f6e 7320 746f 2074 6865  binations to the
-00004c70: 6972 2063 6f72 7265 7370 6f6e 6469 6e67  ir corresponding
-00004c80: 2064 6973 7472 6962 7574 696f 6e20 6675   distribution fu
-00004c90: 6e63 7469 6f6e 732e 0d0a 2020 2020 2020  nctions...      
-00004ca0: 2020 6b65 726e 656c 5f69 6e74 7620 2866    kernel_intv (f
-00004cb0: 756e 6374 696f 6e2c 206f 7074 696f 6e61  unction, optiona
-00004cc0: 6c29 3a20 5468 6520 6b65 726e 656c 2066  l): The kernel f
-00004cd0: 756e 6374 696f 6e20 746f 2062 6520 7573  unction to be us
-00004ce0: 6564 2069 6e20 7468 6520 6261 636b 646f  ed in the backdo
-00004cf0: 6f72 2062 6f6f 7473 7472 6170 7069 6e67  or bootstrapping
-00004d00: 2066 6f72 2074 6865 2063 6175 7365 2076   for the cause v
-00004d10: 6172 6961 626c 652e 2044 6566 6175 6c74  ariable. Default
-00004d20: 7320 746f 204e 6f6e 652e 0d0a 2020 2020  s to None...    
-00004d30: 2020 2020 6d6f 6465 2028 7374 722c 206f      mode (str, o
-00004d40: 7074 696f 6e61 6c29 3a20 4120 7374 7269  ptional): A stri
-00004d50: 6e67 2069 6e64 6963 6174 696e 6720 7468  ng indicating th
-00004d60: 6520 626f 6f74 7374 7261 7070 696e 6720  e bootstrapping 
-00004d70: 6d6f 6465 2e20 4974 2063 616e 2062 6520  mode. It can be 
-00004d80: 6569 7468 6572 2027 6661 7374 2720 6f72  either 'fast' or
-00004d90: 2027 726f 6275 7374 2720 6465 7065 6e64   'robust' depend
-00004da0: 696e 6720 6f6e 2074 6865 2069 6d70 6c65  ing on the imple
-00004db0: 6d65 6e74 6174 696f 6e2e 2044 6566 6175  mentation. Defau
-00004dc0: 6c74 2069 7320 2766 6173 7427 2e0d 0a20  lt is 'fast'... 
-00004dd0: 2020 2020 2020 200d 0a20 2020 2052 6574         ..    Ret
-00004de0: 7572 6e73 3a0d 0a20 2020 2020 2020 2064  urns:..        d
-00004df0: 6963 743a 2041 2064 6963 7469 6f6e 6172  ict: A dictionar
-00004e00: 7920 636f 6e74 6169 6e69 6e67 2076 6172  y containing var
-00004e10: 6961 626c 6520 6e61 6d65 7320 6173 206b  iable names as k
-00004e20: 6579 7320 616e 6420 7468 6569 7220 636f  eys and their co
-00004e30: 7272 6573 706f 6e64 696e 6720 6465 2d63  rresponding de-c
-00004e40: 6f6e 666f 756e 6465 6420 6461 7461 2061  onfounded data a
-00004e50: 7272 6179 7320 6173 2076 616c 7565 732e  rrays as values.
-00004e60: 0d0a 2020 2020 2222 220d 0a20 2020 200d  ..    """..    .
-00004e70: 0a20 2020 2063 6175 7365 5f76 6172 5f6e  .    cause_var_n
-00004e80: 616d 6520 3d20 6c69 7374 2863 6175 7365  ame = list(cause
-00004e90: 5f64 6174 612e 6b65 7973 2829 295b 305d  _data.keys())[0]
-00004ea0: 0d0a 2020 2020 6566 6665 6374 5f76 6172  ..    effect_var
-00004eb0: 5f6e 616d 6520 3d20 6c69 7374 2865 6666  _name = list(eff
-00004ec0: 6563 745f 6461 7461 2e6b 6579 7328 2929  ect_data.keys())
-00004ed0: 5b30 5d0d 0a20 2020 2063 6f6e 666f 756e  [0]..    confoun
-00004ee0: 6465 725f 7661 725f 6e61 6d65 203d 206c  der_var_name = l
-00004ef0: 6973 7428 636f 6e66 6f75 6e64 6572 5f64  ist(confounder_d
-00004f00: 6174 612e 6b65 7973 2829 295b 305d 0d0a  ata.keys())[0]..
-00004f10: 2020 2020 0d0a 2020 2020 6461 7461 203d      ..    data =
-00004f20: 2063 6175 7365 5f64 6174 612e 636f 7079   cause_data.copy
-00004f30: 2829 0d0a 2020 2020 6461 7461 2e75 7064  ()..    data.upd
-00004f40: 6174 6528 6566 6665 6374 5f64 6174 6129  ate(effect_data)
-00004f50: 0d0a 2020 2020 6461 7461 2e75 7064 6174  ..    data.updat
-00004f60: 6528 636f 6e66 6f75 6e64 6572 5f64 6174  e(confounder_dat
-00004f70: 6129 0d0a 2020 2020 0d0a 2020 2020 6361  a)..    ..    ca
-00004f80: 7573 616c 5f67 7261 7068 203d 2063 6175  usal_graph = cau
-00004f90: 7365 5f76 6172 5f6e 616d 6520 2b20 223b  se_var_name + ";
-00004fa0: 2220 2b20 6566 6665 6374 5f76 6172 5f6e  " + effect_var_n
-00004fb0: 616d 6520 2b20 223b 2220 2b20 636f 6e66  ame + ";" + conf
-00004fc0: 6f75 6e64 6572 5f76 6172 5f6e 616d 6520  ounder_var_name 
-00004fd0: 2b20 223b 205c 6e22 0d0a 2020 2020 6361  + "; \n"..    ca
-00004fe0: 7573 616c 5f67 7261 7068 203d 2063 6175  usal_graph = cau
-00004ff0: 7361 6c5f 6772 6170 6820 2b20 6361 7573  sal_graph + caus
-00005000: 655f 7661 725f 6e61 6d65 202b 2022 2d3e  e_var_name + "->
-00005010: 2220 2b20 6566 6665 6374 5f76 6172 5f6e  " + effect_var_n
-00005020: 616d 6520 2b20 223b 205c 6e22 0d0a 2020  ame + "; \n"..  
-00005030: 2020 6361 7573 616c 5f67 7261 7068 203d    causal_graph =
-00005040: 2063 6175 7361 6c5f 6772 6170 6820 2b20   causal_graph + 
-00005050: 636f 6e66 6f75 6e64 6572 5f76 6172 5f6e  confounder_var_n
-00005060: 616d 6520 2b20 222d 3e22 202b 2065 6666  ame + "->" + eff
-00005070: 6563 745f 7661 725f 6e61 6d65 202b 2022  ect_var_name + "
-00005080: 3b20 5c6e 220d 0a20 2020 2063 6175 7361  ; \n"..    causa
-00005090: 6c5f 6772 6170 6820 3d20 6361 7573 616c  l_graph = causal
-000050a0: 5f67 7261 7068 202b 2063 6f6e 666f 756e  _graph + confoun
-000050b0: 6465 725f 7661 725f 6e61 6d65 202b 2022  der_var_name + "
-000050c0: 2d3e 2220 2b20 6361 7573 655f 7661 725f  ->" + cause_var_
-000050d0: 6e61 6d65 202b 2022 3b20 5c6e 220d 0a20  name + "; \n".. 
-000050e0: 2020 200d 0a20 2020 2077 6569 6768 745f     ..    weight_
-000050f0: 6675 6e63 5f6c 616d 2c20 7765 6967 6874  func_lam, weight
-00005100: 5f66 756e 635f 7374 7220 3d20 6765 6e65  _func_str = gene
-00005110: 7261 6c5f 6362 5f61 6e61 6c79 7369 7328  ral_cb_analysis(
-00005120: 6361 7573 616c 5f67 7261 7068 203d 2063  causal_graph = c
-00005130: 6175 7361 6c5f 6772 6170 682c 200d 0a20  ausal_graph, .. 
-00005140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005170: 2020 2020 2020 2020 2020 6566 6665 6374            effect
-00005180: 5f76 6172 5f6e 616d 6520 3d20 6566 6665  _var_name = effe
-00005190: 6374 5f76 6172 5f6e 616d 652c 200d 0a20  ct_var_name, .. 
-000051a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000051d0: 2020 2020 2020 2020 2020 6361 7573 655f            cause_
-000051e0: 7661 725f 6e61 6d65 203d 2063 6175 7365  var_name = cause
-000051f0: 5f76 6172 5f6e 616d 652c 2069 6e66 6f5f  _var_name, info_
-00005200: 7072 696e 743d 2046 616c 7365 290d 0a20  print= False).. 
-00005210: 2020 200d 0a20 2020 2069 6620 6b65 726e     ..    if kern
-00005220: 656c 5f69 6e74 7620 6973 204e 6f6e 653a  el_intv is None:
-00005230: 0d0a 2020 2020 2020 2020 696e 7476 5f76  ..        intv_v
-00005240: 6172 5f6e 616d 6520 3d20 2269 6e74 765f  ar_name = "intv_
-00005250: 2220 2b20 6361 7573 655f 7661 725f 6e61  " + cause_var_na
-00005260: 6d65 0d0a 2020 2020 2020 2020 6b65 726e  me..        kern
-00005270: 656c 5f69 6e74 7620 3d20 6576 616c 2822  el_intv = eval("
-00005280: 6c61 6d62 6461 2022 2b69 6e74 765f 7661  lambda "+intv_va
-00005290: 725f 6e61 6d65 2b22 2c22 2b63 6175 7365  r_name+","+cause
-000052a0: 5f76 6172 5f6e 616d 652b 223a 2031 2069  _var_name+": 1 i
-000052b0: 6620 222b 696e 7476 5f76 6172 5f6e 616d  f "+intv_var_nam
-000052c0: 652b 223d 3d22 202b 2063 6175 7365 5f76  e+"==" + cause_v
-000052d0: 6172 5f6e 616d 6520 2b20 2220 656c 7365  ar_name + " else
-000052e0: 2030 2229 0d0a 2020 2020 656c 7365 3a0d   0")..    else:.
-000052f0: 0a20 2020 2020 2020 206b 6572 6e65 6c5f  .        kernel_
-00005300: 7061 7261 6d73 203d 2073 6574 2869 6e73  params = set(ins
-00005310: 7065 6374 2e73 6967 6e61 7475 7265 286b  pect.signature(k
-00005320: 6572 6e65 6c5f 696e 7476 292e 7061 7261  ernel_intv).para
-00005330: 6d65 7465 7273 2e6b 6579 7328 2929 0d0a  meters.keys())..
-00005340: 2020 2020 2020 2020 696e 7476 5f76 6172          intv_var
-00005350: 5f6e 616d 6520 3d20 6c69 7374 286b 6572  _name = list(ker
-00005360: 6e65 6c5f 7061 7261 6d73 202d 2073 6574  nel_params - set
-00005370: 2864 6174 612e 6b65 7973 2829 2929 0d0a  (data.keys()))..
-00005380: 2020 2020 2020 2020 6966 206c 656e 2869          if len(i
-00005390: 6e74 765f 7661 725f 6e61 6d65 2920 3d3d  ntv_var_name) ==
-000053a0: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
-000053b0: 2069 6e74 765f 7661 725f 6e61 6d65 203d   intv_var_name =
-000053c0: 2022 696e 7476 5f22 202b 2063 6175 7365   "intv_" + cause
-000053d0: 5f76 6172 5f6e 616d 650d 0a20 2020 2020  _var_name..     
-000053e0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000053f0: 2020 2020 2020 696e 7476 5f76 6172 5f6e        intv_var_n
-00005400: 616d 6520 3d20 696e 7476 5f76 6172 5f6e  ame = intv_var_n
-00005410: 616d 655b 305d 0d0a 2020 2020 6362 5f64  ame[0]..    cb_d
-00005420: 6174 6120 3d20 6765 6e65 7261 6c5f 6361  ata = general_ca
-00005430: 7573 616c 5f62 6f6f 7473 7472 6170 7069  usal_bootstrappi
-00005440: 6e67 5f73 696d 706c 6528 7765 6967 6874  ng_simple(weight
-00005450: 5f66 756e 635f 6c61 6d20 3d20 7765 6967  _func_lam = weig
-00005460: 6874 5f66 756e 635f 6c61 6d2c 200d 0a20  ht_func_lam, .. 
-00005470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054a0: 2064 6973 745f 6d61 7020 3d20 6469 7374   dist_map = dist
-000054b0: 5f6d 6170 2c20 6461 7461 203d 2064 6174  _map, data = dat
-000054c0: 612c 200d 0a20 2020 2020 2020 2020 2020  a, ..           
-000054d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000054f0: 2020 2020 2020 2069 6e74 765f 7661 725f         intv_var_
-00005500: 6e61 6d65 203d 2063 6175 7365 5f76 6172  name = cause_var
-00005510: 5f6e 616d 652c 200d 0a20 2020 2020 2020  _name, ..       
+00000860: 2222 0d0a 2020 2020 0d0a 2020 2020 6469  ""..    ..    di
+00000870: 7374 5f6d 6170 5f73 6570 203d 2022 2c22  st_map_sep = ","
+00000880: 0d0a 2020 2020 6469 7374 5f6d 6170 5f73  ..    dist_map_s
+00000890: 6f72 7465 6420 3d20 7b7d 0d0a 2020 2020  orted = {}..    
+000008a0: 0d0a 2020 2020 666f 7220 6b65 7920 2c76  ..    for key ,v
+000008b0: 616c 7565 2069 6e20 6469 7374 5f6d 6170  alue in dist_map
+000008c0: 2e69 7465 6d73 2829 3a0d 0a20 2020 2020  .items():..     
+000008d0: 2020 2073 6f72 7465 645f 6b65 7920 3d20     sorted_key = 
+000008e0: 6469 7374 5f6d 6170 5f73 6570 2e6a 6f69  dist_map_sep.joi
+000008f0: 6e28 736f 7274 6564 286b 6579 2e73 706c  n(sorted(key.spl
+00000900: 6974 2822 2c22 2929 292e 7265 706c 6163  it(","))).replac
+00000910: 6528 2220 222c 2222 290d 0a20 2020 2020  e(" ","")..     
+00000920: 2020 2064 6973 745f 6d61 705f 736f 7274     dist_map_sort
+00000930: 6564 5b73 6f72 7465 645f 6b65 795d 203d  ed[sorted_key] =
+00000940: 2076 616c 7565 0d0a 2020 2020 0d0a 2020   value..    ..  
+00000950: 2020 6465 6620 6469 7669 6465 5f66 756e    def divide_fun
+00000960: 6374 696f 6e73 282a 6675 6e63 7329 3a0d  ctions(*funcs):.
+00000970: 0a20 2020 2020 2020 2064 6566 2064 6976  .        def div
+00000980: 6973 696f 6e28 2a2a 6b77 6172 6773 293a  ision(**kwargs):
+00000990: 0d0a 2020 2020 2020 2020 2020 2020 7061  ..            pa
+000009a0: 7261 6d5f 6e61 6d65 7320 3d20 696e 7370  ram_names = insp
+000009b0: 6563 742e 7369 676e 6174 7572 6528 6675  ect.signature(fu
+000009c0: 6e63 735b 305d 292e 7061 7261 6d65 7465  ncs[0]).paramete
+000009d0: 7273 0d0a 2020 2020 2020 2020 2020 2020  rs..            
+000009e0: 6b77 6172 6773 203d 207b 6b65 792e 7265  kwargs = {key.re
+000009f0: 706c 6163 6528 2227 222c 225f 7072 696d  place("'","_prim
+00000a00: 6522 293a 2076 616c 7565 2066 6f72 206b  e"): value for k
+00000a10: 6579 2c20 7661 6c75 6520 696e 206b 7761  ey, value in kwa
+00000a20: 7267 732e 6974 656d 7328 297d 0d0a 2020  rgs.items()}..  
+00000a30: 2020 2020 2020 2020 2020 7061 7261 6d20            param 
+00000a40: 3d20 7b6b 6579 203a 206b 7761 7267 735b  = {key : kwargs[
+00000a50: 6b65 795d 2066 6f72 206b 6579 2069 6e20  key] for key in 
+00000a60: 7061 7261 6d5f 6e61 6d65 737d 0d0a 2020  param_names}..  
+00000a70: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00000a80: 203d 2066 756e 6373 5b30 5d28 2a2a 7061   = funcs[0](**pa
+00000a90: 7261 6d29 0d0a 2020 2020 2020 2020 2020  ram)..          
+00000aa0: 2020 6966 206c 656e 2877 5f6e 6f6d 2920    if len(w_nom) 
+00000ab0: 3e20 313a 0d0a 2020 2020 2020 2020 2020  > 1:..          
+00000ac0: 2020 2020 2020 666f 7220 6e6f 6d5f 6920        for nom_i 
+00000ad0: 696e 2072 616e 6765 2831 2c6c 656e 2877  in range(1,len(w
+00000ae0: 5f6e 6f6d 2929 3a0d 0a20 2020 2020 2020  _nom)):..       
+00000af0: 2020 2020 2020 2020 2020 2020 2070 6172               par
+00000b00: 616d 5f6e 616d 6573 203d 2069 6e73 7065  am_names = inspe
+00000b10: 6374 2e73 6967 6e61 7475 7265 2866 756e  ct.signature(fun
+00000b20: 6373 5b6e 6f6d 5f69 5d29 2e70 6172 616d  cs[nom_i]).param
+00000b30: 6574 6572 730d 0a20 2020 2020 2020 2020  eters..         
+00000b40: 2020 2020 2020 2020 2020 2070 6172 616d             param
+00000b50: 203d 207b 6b65 7920 3a20 6b77 6172 6773   = {key : kwargs
+00000b60: 5b6b 6579 5d20 666f 7220 6b65 7920 696e  [key] for key in
+00000b70: 2070 6172 616d 5f6e 616d 6573 7d0d 0a20   param_names}.. 
+00000b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000b90: 2020 2072 6573 756c 7420 2a3d 2066 756e     result *= fun
+00000ba0: 6373 5b6e 6f6d 5f69 5d28 2a2a 7061 7261  cs[nom_i](**para
+00000bb0: 6d29 0d0a 2020 2020 2020 2020 2020 2020  m)..            
+00000bc0: 666f 7220 6465 6e6f 6d5f 6920 696e 2072  for denom_i in r
+00000bd0: 616e 6765 286c 656e 2877 5f6e 6f6d 292c  ange(len(w_nom),
+00000be0: 6c65 6e28 775f 6465 6e6f 6d29 2b6c 656e  len(w_denom)+len
+00000bf0: 2877 5f6e 6f6d 2929 3a0d 0a20 2020 2020  (w_nom)):..     
+00000c00: 2020 2020 2020 2020 2020 2070 6172 616d             param
+00000c10: 5f6e 616d 6573 203d 2069 6e73 7065 6374  _names = inspect
+00000c20: 2e73 6967 6e61 7475 7265 2866 756e 6373  .signature(funcs
+00000c30: 5b64 656e 6f6d 5f69 5d29 2e70 6172 616d  [denom_i]).param
+00000c40: 6574 6572 730d 0a20 2020 2020 2020 2020  eters..         
+00000c50: 2020 2020 2020 2070 6172 616d 203d 207b         param = {
+00000c60: 6b65 7920 3a20 6b77 6172 6773 5b6b 6579  key : kwargs[key
+00000c70: 5d20 666f 7220 6b65 7920 696e 2070 6172  ] for key in par
+00000c80: 616d 5f6e 616d 6573 7d0d 0a20 2020 2020  am_names}..     
+00000c90: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00000ca0: 7420 2f3d 2066 756e 6373 5b64 656e 6f6d  t /= funcs[denom
+00000cb0: 5f69 5d28 2a2a 7061 7261 6d29 0d0a 2020  _i](**param)..  
+00000cc0: 2020 2020 2020 2020 2020 6966 2063 6175            if cau
+00000cd0: 7365 5f6b 6572 6e65 6c5f 666c 6167 3a0d  se_kernel_flag:.
+00000ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000cf0: 2070 6172 616d 5f6e 616d 6573 203d 2069   param_names = i
+00000d00: 6e73 7065 6374 2e73 6967 6e61 7475 7265  nspect.signature
+00000d10: 2866 756e 6373 5b2d 315d 292e 7061 7261  (funcs[-1]).para
+00000d20: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00000d30: 2020 2020 2020 2020 7061 7261 6d20 3d20          param = 
+00000d40: 7b6b 6579 203a 206b 7761 7267 735b 6b65  {key : kwargs[ke
+00000d50: 795d 2066 6f72 206b 6579 2069 6e20 7061  y] for key in pa
+00000d60: 7261 6d5f 6e61 6d65 737d 0d0a 2020 2020  ram_names}..    
+00000d70: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00000d80: 6c74 202a 3d20 6675 6e63 735b 2d31 5d28  lt *= funcs[-1](
+00000d90: 2a2a 7061 7261 6d29 0d0a 2020 2020 2020  **param)..      
+00000da0: 2020 2020 2020 7265 7375 6c74 202a 3d20        result *= 
+00000db0: 286c 616d 6264 6120 6e3a 2031 2f6e 2928  (lambda n: 1/n)(
+00000dc0: 4e29 0d0a 2020 2020 2020 2020 2020 2020  N)..            
+00000dd0: 7265 7475 726e 2072 6573 756c 740d 0a20  return result.. 
+00000de0: 2020 2020 2020 2072 6574 7572 6e20 6469         return di
+00000df0: 7669 7369 6f6e 2020 2020 0d0a 2020 2020  vision    ..    
+00000e00: 0d0a 2020 2020 6361 7573 655f 7661 7220  ..    cause_var 
+00000e10: 3d20 696e 7476 5f70 726f 622e 6c68 732e  = intv_prob.lhs.
+00000e20: 646f 760d 0a20 2020 2065 6666 5f76 6172  dov..    eff_var
+00000e30: 203d 2069 6e74 765f 7072 6f62 2e6c 6873   = intv_prob.lhs
+00000e40: 2e6e 756d 5b30 5d0d 0a20 2020 2077 5f64  .num[0]..    w_d
+00000e50: 656e 6f6d 203d 2069 6e74 765f 7072 6f62  enom = intv_prob
+00000e60: 2e72 6873 2e64 656e 0d0a 2020 2020 775f  .rhs.den..    w_
+00000e70: 6465 6e6f 6d20 3d20 5b73 6f72 7465 6428  denom = [sorted(
+00000e80: 775f 6465 6e6f 6d5b 695d 2920 666f 7220  w_denom[i]) for 
+00000e90: 6920 696e 2072 616e 6765 286c 656e 2877  i in range(len(w
+00000ea0: 5f64 656e 6f6d 2929 5d0d 0a20 2020 2077  _denom))]..    w
+00000eb0: 5f6e 6f6d 203d 2069 6e74 765f 7072 6f62  _nom = intv_prob
+00000ec0: 2e72 6873 2e6e 756d 0d0a 2020 2020 775f  .rhs.num..    w_
+00000ed0: 6e6f 6d20 3d20 5b73 6f72 7465 6428 775f  nom = [sorted(w_
+00000ee0: 6e6f 6d5b 695d 2920 666f 7220 6920 696e  nom[i]) for i in
+00000ef0: 2072 616e 6765 286c 656e 2877 5f6e 6f6d   range(len(w_nom
+00000f00: 2929 5d0d 0a20 2020 2065 7073 696c 6f20  ))]..    epsilo 
+00000f10: 3d20 696e 7476 5f70 726f 622e 7268 732e  = intv_prob.rhs.
+00000f20: 6d72 670d 0a20 2020 2070 615f 7661 7220  mrg..    pa_var 
+00000f30: 3d20 736f 7274 6564 2865 7073 696c 6f2e  = sorted(epsilo.
+00000f40: 756e 696f 6e28 6566 665f 7661 7229 2e75  union(eff_var).u
+00000f50: 6e69 6f6e 2863 6175 7365 5f76 6172 2929  nion(cause_var))
+00000f60: 0d0a 2020 2020 6966 2070 615f 7661 7220  ..    if pa_var 
+00000f70: 696e 2077 5f6e 6f6d 3a0d 0a20 2020 2020  in w_nom:..     
+00000f80: 2020 2077 5f6e 6f6d 2e72 656d 6f76 6528     w_nom.remove(
+00000f90: 7061 5f76 6172 290d 0a20 2020 2020 2020  pa_var)..       
+00000fa0: 2063 6175 7365 5f6b 6572 6e65 6c5f 666c   cause_kernel_fl
+00000fb0: 6167 203d 2054 7275 650d 0a20 2020 2020  ag = True..     
+00000fc0: 2020 2066 756e 6373 203d 205b 6469 7374     funcs = [dist
+00000fd0: 5f6d 6170 5f73 6f72 7465 645b 222c 222e  _map_sorted[",".
+00000fe0: 6a6f 696e 2877 5f6e 6f6d 5f69 295d 2066  join(w_nom_i)] f
+00000ff0: 6f72 2077 5f6e 6f6d 5f69 2069 6e20 775f  or w_nom_i in w_
+00001000: 6e6f 6d5d 202b 205b 6469 7374 5f6d 6170  nom] + [dist_map
+00001010: 5f73 6f72 7465 645b 222c 222e 6a6f 696e  _sorted[",".join
+00001020: 2877 5f64 656e 6f6d 5f69 295d 2066 6f72  (w_denom_i)] for
+00001030: 2077 5f64 656e 6f6d 5f69 2069 6e20 775f   w_denom_i in w_
+00001040: 6465 6e6f 6d5d 202b 205b 6b65 726e 656c  denom] + [kernel
+00001050: 5d0d 0a20 2020 2065 6c73 653a 0d0a 2020  ]..    else:..  
+00001060: 2020 2020 2020 7061 5f76 6172 203d 2073        pa_var = s
+00001070: 6574 2870 615f 7661 7229 0d0a 2020 2020  et(pa_var)..    
+00001080: 2020 2020 7061 5f76 6172 202d 3d20 6361      pa_var -= ca
+00001090: 7573 655f 7661 720d 0a20 2020 2020 2020  use_var..       
+000010a0: 2070 615f 7661 7220 3d20 736f 7274 6564   pa_var = sorted
+000010b0: 2870 615f 7661 7229 0d0a 2020 2020 2020  (pa_var)..      
+000010c0: 2020 775f 6e6f 6d2e 7265 6d6f 7665 286c    w_nom.remove(l
+000010d0: 6973 7428 7061 5f76 6172 2929 0d0a 2020  ist(pa_var))..  
+000010e0: 2020 2020 2020 6361 7573 655f 6b65 726e        cause_kern
+000010f0: 656c 5f66 6c61 6720 3d20 4661 6c73 650d  el_flag = False.
+00001100: 0a20 2020 2020 2020 2066 756e 6373 203d  .        funcs =
+00001110: 205b 6469 7374 5f6d 6170 5f73 6f72 7465   [dist_map_sorte
+00001120: 645b 222c 222e 6a6f 696e 2877 5f6e 6f6d  d[",".join(w_nom
+00001130: 5f69 295d 2066 6f72 2077 5f6e 6f6d 5f69  _i)] for w_nom_i
+00001140: 2069 6e20 775f 6e6f 6d5d 202b 205b 6469   in w_nom] + [di
+00001150: 7374 5f6d 6170 5f73 6f72 7465 645b 222c  st_map_sorted[",
+00001160: 222e 6a6f 696e 2877 5f64 656e 6f6d 5f69  ".join(w_denom_i
+00001170: 295d 2066 6f72 2077 5f64 656e 6f6d 5f69  )] for w_denom_i
+00001180: 2069 6e20 775f 6465 6e6f 6d5d 0d0a 2020   in w_denom]..  
+00001190: 2020 0d0a 2020 2020 7765 6967 6874 5f66    ..    weight_f
+000011a0: 756e 6320 3d20 6469 7669 6465 5f66 756e  unc = divide_fun
+000011b0: 6374 696f 6e73 282a 6675 6e63 7329 0d0a  ctions(*funcs)..
+000011c0: 0d0a 2020 2020 7265 7475 726e 2077 6569  ..    return wei
+000011d0: 6768 745f 6675 6e63 0d0a 0d0a 6465 6620  ght_func....def 
+000011e0: 6775 6d62 656c 5f6d 6178 2877 6569 6768  gumbel_max(weigh
+000011f0: 7473 293a 0d0a 2020 2020 2222 220d 0a20  ts):..    """.. 
+00001200: 2020 2041 7070 6c79 2074 6865 2047 756d     Apply the Gum
+00001210: 6265 6c2d 6d61 7820 7472 6963 6b20 746f  bel-max trick to
+00001220: 2073 616d 706c 6520 696e 6469 6365 7320   sample indices 
+00001230: 6261 7365 6420 6f6e 2074 6865 2070 726f  based on the pro
+00001240: 7669 6465 6420 7765 6967 6874 732e 0d0a  vided weights...
+00001250: 2020 2020 0d0a 2020 2020 5061 7261 6d65      ..    Parame
+00001260: 7465 7273 3a0d 0a20 2020 2020 2020 2077  ters:..        w
+00001270: 6569 6768 7473 2028 6e75 6d70 792e 6e64  eights (numpy.nd
+00001280: 6172 7261 7929 3a20 5468 6520 7765 6967  array): The weig
+00001290: 6874 7320 666f 7220 7361 6d70 6c69 6e67  hts for sampling
+000012a0: 2e0d 0a20 2020 200d 0a20 2020 2052 6574  ...    ..    Ret
+000012b0: 7572 6e73 3a0d 0a20 2020 2020 2020 2069  urns:..        i
+000012c0: 6e74 3a20 5468 6520 696e 6465 7820 6f66  nt: The index of
+000012d0: 2074 6865 2073 616d 706c 6564 2077 6569   the sampled wei
+000012e0: 6768 742e 0d0a 2020 2020 2222 220d 0a20  ght...    """.. 
+000012f0: 2020 2067 756d 6265 6c5f 6e6f 6973 6520     gumbel_noise 
+00001300: 3d20 2d6e 702e 6c6f 6728 2d6e 702e 6c6f  = -np.log(-np.lo
+00001310: 6728 6e70 2e72 616e 646f 6d2e 7261 6e64  g(np.random.rand
+00001320: 282a 7765 6967 6874 732e 7368 6170 6529  (*weights.shape)
+00001330: 2929 0d0a 2020 2020 7265 7475 726e 206e  ))..    return n
+00001340: 702e 6172 676d 6178 286e 702e 6c6f 6728  p.argmax(np.log(
+00001350: 7765 6967 6874 7329 202b 2067 756d 6265  weights) + gumbe
+00001360: 6c5f 6e6f 6973 6529 0d0a 0d0a 6465 6620  l_noise)....def 
+00001370: 626f 6f74 7374 7261 7070 6572 2864 6174  bootstrapper(dat
+00001380: 612c 2077 6569 6768 7473 2c20 696e 7476  a, weights, intv
+00001390: 5f76 6172 5f6e 616d 655f 696e 5f64 6174  _var_name_in_dat
+000013a0: 612c 206d 6f64 6520 3d20 2266 6173 7422  a, mode = "fast"
+000013b0: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+000013c0: 2050 6572 666f 726d 2062 6f6f 7473 7472   Perform bootstr
+000013d0: 6170 7069 6e67 206f 6e20 7468 6520 696e  apping on the in
+000013e0: 7075 7420 6f62 7365 7276 6174 696f 6e61  put observationa
+000013f0: 6c20 6461 7461 2075 7369 6e67 2074 6865  l data using the
+00001400: 2070 726f 7669 6465 6420 7765 6967 6874   provided weight
+00001410: 732e 0d0a 2020 2020 0d0a 2020 2020 5061  s...    ..    Pa
+00001420: 7261 6d65 7465 7273 3a0d 0a20 2020 2020  rameters:..     
+00001430: 2020 2064 6174 6120 2864 6963 7429 3a20     data (dict): 
+00001440: 4120 6469 6374 696f 6e61 7279 2063 6f6e  A dictionary con
+00001450: 7461 696e 696e 6720 7661 7269 6162 6c65  taining variable
+00001460: 206e 616d 6573 2061 7320 6b65 7973 2061   names as keys a
+00001470: 6e64 2074 6865 6972 2063 6f72 7265 7370  nd their corresp
+00001480: 6f6e 6469 6e67 2064 6174 6120 6172 7261  onding data arra
+00001490: 7973 2061 7320 7661 6c75 6573 2e0d 0a20  ys as values... 
+000014a0: 2020 2020 2020 2077 6569 6768 7473 2028         weights (
+000014b0: 6e75 6d70 792e 6e64 6172 7261 7929 3a20  numpy.ndarray): 
+000014c0: 416e 2061 7272 6179 2063 6f6e 7461 696e  An array contain
+000014d0: 696e 6720 7468 6520 7765 6967 6874 7320  ing the weights 
+000014e0: 636f 6d70 7574 6564 2066 6f72 2065 6163  computed for eac
+000014f0: 6820 6461 7461 2070 6f69 6e74 2067 6976  h data point giv
+00001500: 656e 2074 6865 2069 6e74 6572 7665 6e74  en the intervent
+00001510: 696f 6e61 6c20 7661 6c75 6573 2061 7320  ional values as 
+00001520: 616c 6c20 706f 7373 6962 6c65 206f 6273  all possible obs
+00001530: 6572 7661 7469 6f6e 616c 2076 616c 7565  ervational value
+00001540: 732e 0d0a 2020 2020 2020 2020 696e 7476  s...        intv
+00001550: 5f76 6172 5f6e 616d 655f 696e 5f64 6174  _var_name_in_dat
+00001560: 6120 286c 6973 7429 3a20 4120 6c69 7374  a (list): A list
+00001570: 206f 6620 7661 7269 6162 6c65 206e 616d   of variable nam
+00001580: 6573 206f 6620 6f62 7365 7276 6174 696f  es of observatio
+00001590: 6e61 6c20 6461 7461 2075 7365 6420 6173  nal data used as
+000015a0: 2074 6865 2069 6e74 6572 7665 6e74 696f   the interventio
+000015b0: 6e61 6c20 7661 6c75 6573 2e0d 0a20 2020  nal values...   
+000015c0: 2020 2020 206d 6f64 6520 2873 7472 2c20       mode (str, 
+000015d0: 6f70 7469 6f6e 616c 293a 2054 6865 206d  optional): The m
+000015e0: 6f64 6520 666f 7220 626f 6f74 7374 7261  ode for bootstra
+000015f0: 7070 696e 672e 204f 7074 696f 6e73 3a20  pping. Options: 
+00001600: 2766 6173 7427 206f 7220 2772 6f62 7573  'fast' or 'robus
+00001610: 7427 2e20 4465 6661 756c 7473 2074 6f20  t'. Defaults to 
+00001620: 2766 6173 7427 2e0d 0a20 2020 200d 0a20  'fast'...    .. 
+00001630: 2020 2052 6574 7572 6e73 3a0d 0a20 2020     Returns:..   
+00001640: 2020 2020 2064 6963 743a 2041 2064 6963       dict: A dic
+00001650: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
+00001660: 6e67 2076 6172 6961 626c 6520 6e61 6d65  ng variable name
+00001670: 7320 6173 206b 6579 7320 616e 6420 7468  s as keys and th
+00001680: 6569 7220 636f 7272 6573 706f 6e64 696e  eir correspondin
+00001690: 6720 626f 6f74 7374 7261 7070 6564 2064  g bootstrapped d
+000016a0: 6174 6120 6172 7261 7973 2061 7320 7661  ata arrays as va
+000016b0: 6c75 6573 2e0d 0a20 2020 2022 2222 0d0a  lues...    """..
+000016c0: 2020 2020 0d0a 2020 2020 7661 725f 6e61      ..    var_na
+000016d0: 6d65 7320 3d20 6c69 7374 2864 6174 612e  mes = list(data.
+000016e0: 6b65 7973 2829 290d 0a20 2020 204e 203d  keys())..    N =
+000016f0: 2064 6174 615b 7661 725f 6e61 6d65 735b   data[var_names[
+00001700: 305d 5d2e 7368 6170 655b 305d 0d0a 2020  0]].shape[0]..  
+00001710: 2020 626f 6f74 7374 7261 705f 6461 7461    bootstrap_data
+00001720: 5f6b 6579 7320 3d20 7661 725f 6e61 6d65  _keys = var_name
+00001730: 7320 2b20 5b22 696e 7476 5f22 2b69 6e74  s + ["intv_"+int
+00001740: 765f 7661 725f 6e61 6d65 5f69 6e5f 6461  v_var_name_in_da
+00001750: 7461 5b69 5d20 666f 7220 6920 696e 2072  ta[i] for i in r
+00001760: 616e 6765 286c 656e 2869 6e74 765f 7661  ange(len(intv_va
+00001770: 725f 6e61 6d65 5f69 6e5f 6461 7461 2929  r_name_in_data))
+00001780: 5d0d 0a20 2020 2062 6f6f 7473 7472 6170  ]..    bootstrap
+00001790: 5f64 6174 6120 3d20 6469 6374 287a 6970  _data = dict(zip
+000017a0: 2862 6f6f 7473 7472 6170 5f64 6174 615f  (bootstrap_data_
+000017b0: 6b65 7973 2c20 5b5b 5d20 666f 7220 6920  keys, [[] for i 
+000017c0: 696e 2072 616e 6765 286c 656e 2862 6f6f  in range(len(boo
+000017d0: 7473 7472 6170 5f64 6174 615f 6b65 7973  tstrap_data_keys
+000017e0: 2929 5d29 290d 0a20 2020 2069 6e74 765f  ))]))..    intv_
+000017f0: 7661 6c75 6573 203d 206e 702e 6172 7261  values = np.arra
+00001800: 7928 5b64 6174 615b 765d 2e72 6573 6861  y([data[v].resha
+00001810: 7065 282d 3129 2066 6f72 2076 2069 6e20  pe(-1) for v in 
+00001820: 696e 7476 5f76 6172 5f6e 616d 655f 696e  intv_var_name_in
+00001830: 5f64 6174 615d 290d 0a20 2020 2069 6e74  _data])..    int
+00001840: 765f 7661 6c75 6573 5f63 6f6d 6269 6e65  v_values_combine
+00001850: 6420 3d20 6c69 7374 2873 6574 287a 6970  d = list(set(zip
+00001860: 282a 696e 7476 5f76 616c 7565 7329 2929  (*intv_values)))
+00001870: 0d0a 0d0a 2020 2020 666f 7220 692c 2076  ....    for i, v
+00001880: 2069 6e20 656e 756d 6572 6174 6528 696e   in enumerate(in
+00001890: 7476 5f76 616c 7565 735f 636f 6d62 696e  tv_values_combin
+000018a0: 6564 293a 0d0a 2020 2020 2020 2020 7765  ed):..        we
+000018b0: 6967 6874 5f69 6e74 7620 3d20 7765 6967  ight_intv = weig
+000018c0: 6874 735b 3a2c 2069 5d0d 0a20 2020 2020  hts[:, i]..     
+000018d0: 2020 206e 5f73 616d 706c 6520 3d20 6e70     n_sample = np
+000018e0: 2e77 6865 7265 286e 702e 616c 6c28 696e  .where(np.all(in
+000018f0: 7476 5f76 616c 7565 735b 3a6c 656e 2876  tv_values[:len(v
+00001900: 292c 203a 5d2e 5420 3d3d 206e 702e 6172  ), :].T == np.ar
+00001910: 7261 7928 7629 2c20 6178 6973 3d31 2929  ray(v), axis=1))
+00001920: 5b30 5d2e 7368 6170 655b 305d 0d0a 2020  [0].shape[0]..  
+00001930: 2020 2020 2020 2320 7361 6d70 6c65 5f69        # sample_i
+00001940: 6e64 6963 6573 203d 2072 616e 646f 6d2e  ndices = random.
+00001950: 6368 6f69 6365 7328 5b6e 2066 6f72 206e  choices([n for n
+00001960: 2069 6e20 7261 6e67 6528 4e29 5d2c 2077   in range(N)], w
+00001970: 6569 6768 7473 203d 2077 6569 6768 745f  eights = weight_
+00001980: 696e 7476 2c20 6b20 3d20 6e5f 7361 6d70  intv, k = n_samp
+00001990: 6c65 290d 0a20 2020 2020 2020 200d 0a20  le)..        .. 
+000019a0: 2020 2020 2020 2069 6620 6d6f 6465 203d         if mode =
+000019b0: 3d20 2266 6173 7422 3a0d 0a20 2020 2020  = "fast":..     
+000019c0: 2020 2020 2020 2073 616d 706c 655f 696e         sample_in
+000019d0: 6469 6365 7320 3d20 7261 6e64 6f6d 2e63  dices = random.c
+000019e0: 686f 6963 6573 2872 616e 6765 284e 292c  hoices(range(N),
+000019f0: 2077 6569 6768 7473 3d77 6569 6768 745f   weights=weight_
+00001a00: 696e 7476 2c20 6b3d 6e5f 7361 6d70 6c65  intv, k=n_sample
+00001a10: 290d 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
+00001a20: 6d6f 6465 203d 3d20 2272 6f62 7573 7422  mode == "robust"
+00001a30: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+00001a40: 616d 706c 655f 696e 6469 6365 7320 3d20  ample_indices = 
+00001a50: 5b67 756d 6265 6c5f 6d61 7828 7765 6967  [gumbel_max(weig
+00001a60: 6874 5f69 6e74 7629 2066 6f72 205f 2069  ht_intv) for _ i
+00001a70: 6e20 7261 6e67 6528 6e5f 7361 6d70 6c65  n range(n_sample
+00001a80: 295d 0d0a 2020 2020 2020 2020 656c 7365  )]..        else
+00001a90: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00001aa0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00001ab0: 2249 6e76 616c 6964 206d 6f64 652e 2043  "Invalid mode. C
+00001ac0: 686f 6f73 6520 6569 7468 6572 2027 6661  hoose either 'fa
+00001ad0: 7374 2720 6f72 2027 726f 6275 7374 272e  st' or 'robust'.
+00001ae0: 2229 0d0a 2020 2020 2020 2020 0d0a 2020  ")..        ..  
+00001af0: 2020 2020 2020 666f 7220 7661 7220 696e        for var in
+00001b00: 2076 6172 5f6e 616d 6573 3a0d 0a20 2020   var_names:..   
+00001b10: 2020 2020 2020 2020 2062 6f6f 7473 7472           bootstr
+00001b20: 6170 5f64 6174 615b 7661 725d 2e61 7070  ap_data[var].app
+00001b30: 656e 6428 6461 7461 5b76 6172 5d5b 7361  end(data[var][sa
+00001b40: 6d70 6c65 5f69 6e64 6963 6573 5d29 0d0a  mple_indices])..
+00001b50: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00001b60: 2020 2020 2020 666f 7220 696e 7476 5f76        for intv_v
+00001b70: 6172 2069 6e20 696e 7476 5f76 6172 5f6e  ar in intv_var_n
+00001b80: 616d 655f 696e 5f64 6174 613a 0d0a 2020  ame_in_data:..  
+00001b90: 2020 2020 2020 2020 2020 626f 6f74 7374            bootst
+00001ba0: 7261 705f 6461 7461 5b22 696e 7476 5f22  rap_data["intv_"
+00001bb0: 2b69 6e74 765f 7661 725d 2e61 7070 656e  +intv_var].appen
+00001bc0: 6428 6e70 2e61 7272 6179 285b 7620 666f  d(np.array([v fo
+00001bd0: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+00001be0: 2873 616d 706c 655f 696e 6469 6365 7329  (sample_indices)
+00001bf0: 295d 2929 0d0a 2020 2020 0d0a 2020 2020  )]))..    ..    
+00001c00: 666f 7220 7661 7220 696e 2062 6f6f 7473  for var in boots
+00001c10: 7472 6170 5f64 6174 615f 6b65 7973 3a0d  trap_data_keys:.
+00001c20: 0a20 2020 2020 2020 2062 6f6f 7473 7472  .        bootstr
+00001c30: 6170 5f64 6174 615b 7661 725d 203d 206e  ap_data[var] = n
+00001c40: 702e 7673 7461 636b 2862 6f6f 7473 7472  p.vstack(bootstr
+00001c50: 6170 5f64 6174 615b 7661 725d 290d 0a20  ap_data[var]).. 
+00001c60: 2020 2020 2020 2062 6f6f 7473 7472 6170         bootstrap
+00001c70: 5f64 6174 615b 7661 722e 7265 706c 6163  _data[var.replac
+00001c80: 6528 2227 222c 2022 2229 5d20 3d20 626f  e("'", "")] = bo
+00001c90: 6f74 7374 7261 705f 6461 7461 2e70 6f70  otstrap_data.pop
+00001ca0: 2876 6172 290d 0a20 2020 2072 6574 7572  (var)..    retur
+00001cb0: 6e20 626f 6f74 7374 7261 705f 6461 7461  n bootstrap_data
+00001cc0: 0d0a 0d0a 6465 6620 7369 6d75 5f62 6f6f  ....def simu_boo
+00001cd0: 7473 7472 6170 7065 7228 6461 7461 2c20  tstrapper(data, 
+00001ce0: 7765 6967 6874 5f66 756e 632c 2069 6e74  weight_func, int
+00001cf0: 765f 7661 725f 7661 6c75 652c 206e 5f73  v_var_value, n_s
+00001d00: 616d 706c 652c 206d 6f64 6520 3d20 2266  ample, mode = "f
+00001d10: 6173 7422 293a 0d0a 2020 2020 2222 220d  ast"):..    """.
+00001d20: 0a20 2020 2050 6572 666f 726d 2073 696d  .    Perform sim
+00001d30: 756c 6174 696f 6e61 6c20 626f 6f74 7374  ulational bootst
+00001d40: 7261 7070 696e 6720 6f6e 2074 6865 2069  rapping on the i
+00001d50: 6e70 7574 206f 6273 6572 7661 7469 6f6e  nput observation
+00001d60: 616c 2064 6174 6120 7573 696e 6720 7468  al data using th
+00001d70: 6520 7072 6f76 6964 6564 2077 6569 6768  e provided weigh
+00001d80: 7420 6675 6e63 7469 6f6e 2061 6e64 200d  t function and .
+00001d90: 0a20 2020 2064 6573 6967 6e61 7465 6420  .    designated 
+00001da0: 696e 7465 7276 696f 6e20 7661 6c75 6573  intervion values
+00001db0: 2e0d 0a0d 0a20 2020 2050 6172 616d 6574  .....    Paramet
+00001dc0: 6572 733a 0d0a 2020 2020 2020 2020 6461  ers:..        da
+00001dd0: 7461 2028 6469 6374 293a 2041 2064 6963  ta (dict): A dic
+00001de0: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
+00001df0: 6e67 2076 6172 6961 626c 6520 6e61 6d65  ng variable name
+00001e00: 7320 6173 206b 6579 7320 616e 6420 7468  s as keys and th
+00001e10: 6569 7220 636f 7272 6573 706f 6e64 696e  eir correspondin
+00001e20: 6720 6461 7461 2061 7272 6179 7320 6173  g data arrays as
+00001e30: 2076 616c 7565 732e 0d0a 2020 2020 2020   values...      
+00001e40: 2020 7765 6967 6874 5f66 756e 6320 2866    weight_func (f
+00001e50: 756e 6374 696f 6e29 3a20 5468 6520 6361  unction): The ca
+00001e60: 7573 616c 2062 6f6f 7473 7472 6170 7069  usal bootstrappi
+00001e70: 6e67 2077 6569 6768 7420 6675 6e63 7469  ng weight functi
+00001e80: 6f6e 2e0d 0a20 2020 2020 2020 2069 6e74  on...        int
+00001e90: 765f 7661 725f 7661 6c75 6520 2864 6963  v_var_value (dic
+00001ea0: 7429 3a20 4120 6469 6374 696f 6e61 7279  t): A dictionary
+00001eb0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00001ec0: 696e 7465 7276 656e 7469 6f6e 2076 6172  intervention var
+00001ed0: 6961 626c 6520 6e61 6d65 2061 7320 6120  iable name as a 
+00001ee0: 6b65 7920 616e 6420 6974 7320 6461 7461  key and its data
+00001ef0: 2061 7272 6179 2061 7320 7468 6520 7661   array as the va
+00001f00: 6c75 652e 0d0a 2020 2020 2020 2020 6e5f  lue...        n_
+00001f10: 7361 6d70 6c65 2028 696e 7429 3a20 5468  sample (int): Th
+00001f20: 6520 6e75 6d62 6572 206f 6620 7361 6d70  e number of samp
+00001f30: 6c65 7320 746f 2062 6520 6765 6e65 7261  les to be genera
+00001f40: 7465 6420 7468 726f 7567 6820 626f 6f74  ted through boot
+00001f50: 7374 7261 7070 696e 672e 0d0a 2020 2020  strapping...    
+00001f60: 2020 2020 6d6f 6465 2028 7374 722c 206f      mode (str, o
+00001f70: 7074 696f 6e61 6c29 3a20 5468 6520 6d6f  ptional): The mo
+00001f80: 6465 2066 6f72 2062 6f6f 7473 7472 6170  de for bootstrap
+00001f90: 7069 6e67 2e20 4f70 7469 6f6e 733a 2027  ping. Options: '
+00001fa0: 6661 7374 2720 6f72 2027 726f 6275 7374  fast' or 'robust
+00001fb0: 272e 2044 6566 6175 6c74 7320 746f 2027  '. Defaults to '
+00001fc0: 6661 7374 272e 0d0a 0d0a 2020 2020 5265  fast'.....    Re
+00001fd0: 7475 726e 733a 0d0a 2020 2020 2020 2020  turns:..        
+00001fe0: 6469 6374 3a20 4120 6469 6374 696f 6e61  dict: A dictiona
+00001ff0: 7279 2063 6f6e 7461 696e 696e 6720 7661  ry containing va
+00002000: 7269 6162 6c65 206e 616d 6573 2061 7320  riable names as 
+00002010: 6b65 7973 2061 6e64 2074 6865 6972 2063  keys and their c
+00002020: 6f72 7265 7370 6f6e 6469 6e67 2062 6f6f  orresponding boo
+00002030: 7473 7472 6170 7065 6420 6461 7461 2061  tstrapped data a
+00002040: 7272 6179 7320 6173 2076 616c 7565 732e  rrays as values.
+00002050: 0d0a 2020 2020 2222 220d 0a20 2020 200d  ..    """..    .
+00002060: 0a20 2020 2077 6569 6768 7473 203d 2077  .    weights = w
+00002070: 6569 6768 745f 636f 6d70 7574 6528 7765  eight_compute(we
+00002080: 6967 6874 5f66 756e 632c 2064 6174 612c  ight_func, data,
+00002090: 2069 6e74 765f 7661 725f 7661 6c75 6529   intv_var_value)
+000020a0: 0d0a 2020 2020 0d0a 2020 2020 696e 7476  ..    ..    intv
+000020b0: 5f76 6172 5f6e 616d 6520 3d20 6c69 7374  _var_name = list
+000020c0: 2869 6e74 765f 7661 725f 7661 6c75 652e  (intv_var_value.
+000020d0: 6b65 7973 2829 290d 0a20 2020 2076 6172  keys())..    var
+000020e0: 5f6e 616d 6573 203d 206c 6973 7428 6461  _names = list(da
+000020f0: 7461 2e6b 6579 7328 2929 0d0a 2020 2020  ta.keys())..    
+00002100: 4e20 3d20 6461 7461 5b76 6172 5f6e 616d  N = data[var_nam
+00002110: 6573 5b30 5d5d 2e73 6861 7065 5b30 5d0d  es[0]].shape[0].
+00002120: 0a20 2020 2023 2076 6172 5f6e 616d 6573  .    # var_names
+00002130: 203d 205b 6974 656d 2066 6f72 2069 7465   = [item for ite
+00002140: 6d20 696e 2076 6172 5f6e 616d 6573 2069  m in var_names i
+00002150: 6620 2869 7465 6d20 696e 2076 6172 5f6e  f (item in var_n
+00002160: 616d 6573 2920 616e 6420 2869 7465 6d2e  ames) and (item.
+00002170: 7265 706c 6163 6528 2227 222c 2222 2920  replace("'","") 
+00002180: 6e6f 7420 696e 2069 6e74 765f 7661 725f  not in intv_var_
+00002190: 6e61 6d65 295d 0d0a 2020 2020 626f 6f74  name)]..    boot
+000021a0: 7374 7261 705f 6461 7461 203d 207b 7d0d  strap_data = {}.
+000021b0: 0a20 2020 2023 2073 616d 706c 655f 696e  .    # sample_in
+000021c0: 6469 6365 7320 3d20 7261 6e64 6f6d 2e63  dices = random.c
+000021d0: 686f 6963 6573 285b 6e20 666f 7220 6e20  hoices([n for n 
+000021e0: 696e 2072 616e 6765 284e 295d 2c20 7765  in range(N)], we
+000021f0: 6967 6874 7320 3d20 7765 6967 6874 732c  ights = weights,
+00002200: 206b 203d 206e 5f73 616d 706c 6529 0d0a   k = n_sample)..
+00002210: 2020 2020 6966 206d 6f64 6520 3d3d 2022      if mode == "
+00002220: 6661 7374 223a 0d0a 2020 2020 2020 2020  fast":..        
+00002230: 7361 6d70 6c65 5f69 6e64 6963 6573 203d  sample_indices =
+00002240: 2072 616e 646f 6d2e 6368 6f69 6365 7328   random.choices(
+00002250: 7261 6e67 6528 4e29 2c20 7765 6967 6874  range(N), weight
+00002260: 733d 7765 6967 6874 732c 206b 3d6e 5f73  s=weights, k=n_s
+00002270: 616d 706c 6529 0d0a 2020 2020 656c 6966  ample)..    elif
+00002280: 206d 6f64 6520 3d3d 2022 726f 6275 7374   mode == "robust
+00002290: 223a 0d0a 2020 2020 2020 2020 7361 6d70  ":..        samp
+000022a0: 6c65 5f69 6e64 6963 6573 203d 205b 6775  le_indices = [gu
+000022b0: 6d62 656c 5f6d 6178 2877 6569 6768 7473  mbel_max(weights
+000022c0: 2920 666f 7220 5f20 696e 2072 616e 6765  ) for _ in range
+000022d0: 286e 5f73 616d 706c 6529 5d0d 0a20 2020  (n_sample)]..   
+000022e0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000022f0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00002300: 2822 496e 7661 6c69 6420 6d6f 6465 2e20  ("Invalid mode. 
+00002310: 4368 6f6f 7365 2065 6974 6865 7220 2766  Choose either 'f
+00002320: 6173 7427 206f 7220 2772 6f62 7573 7427  ast' or 'robust'
+00002330: 2e22 290d 0a20 2020 200d 0a20 2020 2066  .")..    ..    f
+00002340: 6f72 2076 6172 2069 6e20 7661 725f 6e61  or var in var_na
+00002350: 6d65 733a 0d0a 2020 2020 2020 2020 626f  mes:..        bo
+00002360: 6f74 7374 7261 705f 6461 7461 5b76 6172  otstrap_data[var
+00002370: 2e72 6570 6c61 6365 2822 2722 2c22 2229  .replace("'","")
+00002380: 5d20 3d20 6461 7461 5b76 6172 5d5b 7361  ] = data[var][sa
+00002390: 6d70 6c65 5f69 6e64 6963 6573 5d0d 0a20  mple_indices].. 
+000023a0: 2020 2066 6f72 2069 6e74 765f 7661 7220     for intv_var 
+000023b0: 696e 2069 6e74 765f 7661 725f 6e61 6d65  in intv_var_name
+000023c0: 3a0d 0a20 2020 2020 2020 2069 6e74 765f  :..        intv_
+000023d0: 7661 6c75 655f 693d 206e 702e 6172 7261  value_i= np.arra
+000023e0: 7928 696e 7476 5f76 6172 5f76 616c 7565  y(intv_var_value
+000023f0: 5b69 6e74 765f 7661 725d 290d 0a20 2020  [intv_var])..   
+00002400: 2020 2020 2069 6620 696e 7476 5f76 616c       if intv_val
+00002410: 7565 5f69 2e6e 6469 6d20 3d3d 2031 3a0d  ue_i.ndim == 1:.
+00002420: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
+00002430: 765f 7661 6c75 655f 6920 3d20 696e 7476  v_value_i = intv
+00002440: 5f76 616c 7565 5f69 2e72 6573 6861 7065  _value_i.reshape
+00002450: 282d 312c 3129 0d0a 2020 2020 2020 2020  (-1,1)..        
+00002460: 626f 6f74 7374 7261 705f 6461 7461 5b22  bootstrap_data["
+00002470: 696e 7476 5f22 2b69 6e74 765f 7661 7220  intv_"+intv_var 
+00002480: 6966 2069 6e74 765f 7661 7220 696e 2062  if intv_var in b
+00002490: 6f6f 7473 7472 6170 5f64 6174 612e 6b65  ootstrap_data.ke
+000024a0: 7973 2829 2065 6c73 6520 696e 7476 5f76  ys() else intv_v
+000024b0: 6172 5d20 3d20 696e 7476 5f76 616c 7565  ar] = intv_value
+000024c0: 5f69 5b73 616d 706c 655f 696e 6469 6365  _i[sample_indice
+000024d0: 735d 0d0a 2020 2020 7265 7475 726e 2062  s]..    return b
+000024e0: 6f6f 7473 7472 6170 5f64 6174 612c 2077  ootstrap_data, w
+000024f0: 6569 6768 7473 0d0a 0d0a 6465 6620 6765  eights....def ge
+00002500: 6e65 7261 6c5f 6362 5f61 6e61 6c79 7369  neral_cb_analysi
+00002510: 7328 6361 7573 616c 5f67 7261 7068 2c20  s(causal_graph, 
+00002520: 6566 6665 6374 5f76 6172 5f6e 616d 652c  effect_var_name,
+00002530: 2063 6175 7365 5f76 6172 5f6e 616d 652c   cause_var_name,
+00002540: 2069 6e66 6f5f 7072 696e 7420 3d20 5472   info_print = Tr
+00002550: 7565 2c20 6964 6d6f 6465 203d 2022 616c  ue, idmode = "al
+00002560: 6c22 2c20 6964 6772 6565 6479 203d 2054  l", idgreedy = T
+00002570: 7275 6529 3a0d 0a20 2020 200d 0a20 2020  rue):..    ..   
+00002580: 2022 2222 0d0a 2020 2020 5065 7266 6f72   """..    Perfor
+00002590: 6d20 7072 652d 616e 616c 7973 6973 2066  m pre-analysis f
+000025a0: 6f72 2074 6865 2067 6976 656e 2063 6175  or the given cau
+000025b0: 7361 6c20 6772 6170 6820 7769 7468 2069  sal graph with i
+000025c0: 6e74 656e 6465 6420 6361 7573 6528 696e  ntended cause(in
+000025d0: 7465 6e76 656e 7469 6f6e 616c 2920 616e  tenventional) an
+000025e0: 6420 6566 6665 6374 2076 6172 6961 626c  d effect variabl
+000025f0: 6573 2074 6f20 0d0a 2020 2020 666f 726d  es to ..    form
+00002600: 756c 6174 6520 7468 6520 7765 6967 6874  ulate the weight
+00002610: 2066 756e 6374 696f 6e2e 0d0a 0d0a 2020   function.....  
+00002620: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
+00002630: 6765 6e65 7261 7465 7320 6361 7573 616c  generates causal
+00002640: 2062 6f6f 7473 7472 6170 7069 6e67 2077   bootstrapping w
+00002650: 6569 6768 7420 6675 6e63 7469 6f6e 2061  eight function a
+00002660: 6e64 2072 6571 7569 7265 6420 6469 7374  nd required dist
+00002670: 7269 6275 7469 6f6e 730d 0a20 2020 2066  ributions..    f
+00002680: 6f72 2061 2067 6976 656e 2063 6175 7361  or a given causa
+00002690: 6c20 6772 6170 6820 616e 6420 6120 7370  l graph and a sp
+000026a0: 6563 6966 6965 6420 696e 7465 7276 656e  ecified interven
+000026b0: 7469 6f6e 2e0d 0a0d 0a20 2020 2050 6172  tion.....    Par
+000026c0: 616d 6574 6572 733a 0d0a 2020 2020 2d20  ameters:..    - 
+000026d0: 6361 7573 616c 5f67 7261 7068 2028 6772  causal_graph (gr
+000026e0: 6170 6c2e 6164 6d67 2e41 444d 4720 6f62  apl.admg.ADMG ob
+000026f0: 6a65 6374 293a 2041 2063 6175 7361 6c20  ject): A causal 
+00002700: 6772 6170 6820 7265 7072 6573 656e 7469  graph representi
+00002710: 6e67 2074 6865 2072 656c 6174 696f 6e73  ng the relations
+00002720: 6869 7073 2062 6574 7765 656e 2076 6172  hips between var
+00002730: 6961 626c 6573 2e0d 0a20 2020 202d 2065  iables...    - e
+00002740: 6666 6563 745f 7661 725f 6e61 6d65 2028  ffect_var_name (
+00002750: 7374 7229 3a20 5468 6520 6e61 6d65 206f  str): The name o
+00002760: 6620 7468 6520 6566 6665 6374 2076 6172  f the effect var
+00002770: 6961 626c 6520 666f 7220 7468 6520 6361  iable for the ca
+00002780: 7573 616c 2069 6e74 6572 7665 6e74 696f  usal interventio
+00002790: 6e2e 0d0a 2020 2020 2d20 6361 7573 655f  n...    - cause_
+000027a0: 7661 725f 6e61 6d65 2028 7374 7229 3a20  var_name (str): 
+000027b0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
+000027c0: 6361 7573 6520 7661 7269 6162 6c65 2072  cause variable r
+000027d0: 6573 706f 6e73 6962 6c65 2066 6f72 2074  esponsible for t
+000027e0: 6865 2069 6e74 6572 7665 6e74 696f 6e2e  he intervention.
+000027f0: 0d0a 2020 2020 2d20 696e 666f 5f70 7269  ..    - info_pri
+00002800: 6e74 efbc 8862 6f6f 6c2c 206f 7074 696f  nt...bool, optio
+00002810: 6e61 6c29 3a20 4120 626f 6f6c 6561 6e20  nal): A boolean 
+00002820: 696e 6469 6361 7469 6e67 2077 6865 7468  indicating wheth
+00002830: 6572 2074 6f20 7072 696e 7420 7468 6520  er to print the 
+00002840: 7765 6967 6874 2066 756e 6374 696f 6e20  weight function 
+00002850: 616e 6420 7265 7175 6972 6564 2064 6973  and required dis
+00002860: 7472 6962 7574 696f 6e73 2e20 4465 6661  tributions. Defa
+00002870: 756c 7420 6973 2054 7275 652e 0d0a 2020  ult is True...  
+00002880: 2020 2d20 6964 6d6f 6465 2028 7374 722c    - idmode (str,
+00002890: 206f 7074 696f 6e61 6c29 3a20 4120 7374   optional): A st
+000028a0: 7269 6e67 2069 6e64 6963 6174 696e 6720  ring indicating 
+000028b0: 7468 6520 6d6f 6465 2066 6f72 2069 6465  the mode for ide
+000028c0: 6e74 6966 7969 6e67 2074 6865 2069 6e74  ntifying the int
+000028d0: 6572 7665 6e74 696f 6e61 6c20 7072 6f62  erventional prob
+000028e0: 6162 696c 6974 792e 2049 7420 6361 6e20  ability. It can 
+000028f0: 6265 2065 6974 6865 7220 2761 6c6c 272c  be either 'all',
+00002900: 2027 7368 6f72 7465 7374 272c 2027 6d6f   'shortest', 'mo
+00002910: 7374 6d72 6727 206f 7220 2772 616e 646f  stmrg' or 'rando
+00002920: 6d27 2e20 4465 6661 756c 7420 6973 2027  m'. Default is '
+00002930: 616c 6c27 2e0d 0a20 2020 202d 2069 6467  all'...    - idg
+00002940: 7265 6564 7920 2862 6f6f 6c2c 206f 7074  reedy (bool, opt
+00002950: 696f 6e61 6c29 3a20 4120 626f 6f6c 6561  ional): A boolea
+00002960: 6e20 696e 6469 6361 7469 6e67 2077 6865  n indicating whe
+00002970: 7468 6572 2074 6f20 7573 6520 7468 6520  ther to use the 
+00002980: 6772 6565 6479 2073 7472 6174 6567 7920  greedy strategy 
+00002990: 666f 7220 6964 656e 7469 6679 696e 6720  for identifying 
+000029a0: 7468 6520 696e 7465 7276 656e 7469 6f6e  the intervention
+000029b0: 616c 2070 726f 6261 6269 6c69 7479 2e20  al probability. 
+000029c0: 4465 6661 756c 7420 6973 2054 7275 652e  Default is True.
+000029d0: 0d0a 0d0a 2020 2020 5265 7475 726e 733a  ....    Returns:
+000029e0: 0d0a 2020 2020 2d20 7765 6967 6874 5f66  ..    - weight_f
+000029f0: 756e 635f 6c61 6d20 2866 756e 6374 696f  unc_lam (functio
+00002a00: 6e29 3a20 4120 6c61 6d62 6461 2066 756e  n): A lambda fun
+00002a10: 6374 696f 6e20 746f 2063 616c 6375 6c61  ction to calcula
+00002a20: 7465 2063 6175 7361 6c20 626f 6f74 7374  te causal bootst
+00002a30: 7261 7070 696e 6720 7765 6967 6874 732e  rapping weights.
+00002a40: 0d0a 2020 2020 2d20 7765 6967 6874 5f66  ..    - weight_f
+00002a50: 756e 635f 7374 7220 2873 7472 293a 2054  unc_str (str): T
+00002a60: 6865 2073 7472 696e 6720 7265 7072 6573  he string repres
+00002a70: 656e 7461 7469 6f6e 206f 6620 7468 6520  entation of the 
+00002a80: 6361 7573 616c 2062 6f6f 7473 7472 6170  causal bootstrap
+00002a90: 7069 6e67 2077 6569 6768 7473 2066 756e  ping weights fun
+00002aa0: 6374 696f 6e2e 0d0a 0d0a 2020 2020 5573  ction.....    Us
+00002ab0: 6167 6520 496e 7374 7275 6374 696f 6e73  age Instructions
+00002ac0: 3a0d 0a20 2020 2031 2e20 4361 6c6c 2074  :..    1. Call t
+00002ad0: 6869 7320 6675 6e63 7469 6f6e 2077 6974  his function wit
+00002ae0: 6820 7468 6520 6361 7573 616c 2067 7261  h the causal gra
+00002af0: 7068 2061 6e64 2076 6172 6961 626c 6520  ph and variable 
+00002b00: 6e61 6d65 732e 0d0a 2020 2020 322e 2049  names...    2. I
+00002b10: 6620 7468 6520 696e 7465 7276 656e 7469  f the interventi
+00002b20: 6f6e 2069 7320 6964 656e 7469 6669 6162  on is identifiab
+00002b30: 6c65 2c20 6974 2077 696c 6c20 7265 7475  le, it will retu
+00002b40: 726e 2061 206c 616d 6264 6120 6675 6e63  rn a lambda func
+00002b50: 7469 6f6e 2061 6e64 2074 6865 2077 6569  tion and the wei
+00002b60: 6768 7473 2066 756e 6374 696f 6e20 7374  ghts function st
+00002b70: 7269 6e67 2e0d 0a20 2020 2033 2e20 5072  ring...    3. Pr
+00002b80: 6570 6172 6520 696e 7075 7473 2066 6f72  epare inputs for
+00002b90: 2074 6865 206c 616d 6264 6120 6675 6e63   the lambda func
+00002ba0: 7469 6f6e 3a0d 0a20 2020 2020 2020 2d20  tion:..       - 
+00002bb0: 6469 7374 5f6d 6170 3a20 4120 6469 6374  dist_map: A dict
+00002bc0: 696f 6e61 7279 2063 6f6e 7461 696e 696e  ionary containin
+00002bd0: 6720 7265 7175 6972 6564 2070 726f 6261  g required proba
+00002be0: 6269 6c69 7479 2064 6973 7472 6962 7574  bility distribut
+00002bf0: 696f 6e73 2e0d 0a20 2020 2020 2020 2d20  ions...       - 
+00002c00: 4e3a 2053 616d 706c 6520 7369 7a65 2066  N: Sample size f
+00002c10: 6f72 2074 6865 2069 6e74 6572 7665 6e74  or the intervent
+00002c20: 696f 6e2e 0d0a 2020 2020 2020 202d 206b  ion...       - k
+00002c30: 6572 6e65 6c3a 2028 4f70 7469 6f6e 616c  ernel: (Optional
+00002c40: 2920 4120 6b65 726e 656c 2066 756e 6374  ) A kernel funct
+00002c50: 696f 6e20 6966 206e 6565 6465 642e 0d0a  ion if needed...
+00002c60: 2020 2020 342e 2043 616c 6c20 7765 6967      4. Call weig
+00002c70: 6874 5f66 756e 635f 6c61 6d28 6469 7374  ht_func_lam(dist
+00002c80: 5f6d 6170 2c20 4e2c 206b 6572 6e65 6c29  _map, N, kernel)
+00002c90: 2074 6f20 6573 7469 6d61 7465 2074 6865   to estimate the
+00002ca0: 2063 6175 7361 6c20 6566 6665 6374 2e0d   causal effect..
+00002cb0: 0a20 2020 2022 2222 2020 2020 0d0a 2020  .    """    ..  
+00002cc0: 2020 0d0a 2020 2020 6772 6170 6c5f 6f62    ..    grapl_ob
+00002cd0: 6a20 3d20 6473 6c2e 4772 6170 6c44 534c  j = dsl.GraplDSL
+00002ce0: 2829 0d0a 2020 2020 4720 3d20 6772 6170  ()..    G = grap
+00002cf0: 6c5f 6f62 6a2e 7265 6164 6772 6170 6c28  l_obj.readgrapl(
+00002d00: 6361 7573 616c 5f67 7261 7068 290d 0a20  causal_graph).. 
+00002d10: 2020 2069 645f 7374 725f 616c 6c2c 2069     id_str_all, i
+00002d20: 645f 6571 6e5f 616c 6c2c 2069 6465 6e74  d_eqn_all, ident
+00002d30: 6966 6961 626c 6520 3d20 616c 6773 2e69  ifiable = algs.i
+00002d40: 6466 6978 616c 6c28 472c 2073 6574 2863  dfixall(G, set(c
+00002d50: 6175 7365 5f76 6172 5f6e 616d 6529 2c20  ause_var_name), 
+00002d60: 7365 7428 6566 6665 6374 5f76 6172 5f6e  set(effect_var_n
+00002d70: 616d 6529 2c20 0d0a 2020 2020 2020 2020  ame), ..        
+00002d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002db0: 206d 6f64 6520 3d20 6964 6d6f 6465 2c20   mode = idmode, 
+00002dc0: 6772 6565 6479 203d 2069 6467 7265 6564  greedy = idgreed
+00002dd0: 7929 0d0a 0d0a 2020 2020 6966 206e 6f74  y)....    if not
+00002de0: 2069 6465 6e74 6966 6961 626c 653a 0d0a   identifiable:..
+00002df0: 2020 2020 2020 2020 7072 696e 7428 224e          print("N
+00002e00: 6f74 2069 6465 6e74 6966 6961 626c 6522  ot identifiable"
+00002e10: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00002e20: 6e20 4e6f 6e65 2c20 4e6f 6e65 0d0a 0d0a  n None, None....
+00002e30: 2020 2020 6966 2069 646d 6f64 6520 213d      if idmode !=
+00002e40: 2022 616c 6c22 3a0d 0a20 2020 2020 2020   "all":..       
+00002e50: 2069 645f 7374 725f 616c 6c20 3d20 5b69   id_str_all = [i
+00002e60: 645f 7374 725f 616c 6c5d 0d0a 2020 2020  d_str_all]..    
+00002e70: 2020 2020 6964 5f65 716e 5f61 6c6c 203d      id_eqn_all =
+00002e80: 205b 6964 5f65 716e 5f61 6c6c 5d0d 0a20   [id_eqn_all].. 
+00002e90: 2020 2020 2020 200d 0a20 2020 2073 696d         ..    sim
+00002ea0: 706c 6963 6974 795f 7363 6f72 6520 3d20  plicity_score = 
+00002eb0: 300d 0a20 2020 2062 6573 745f 7369 6d70  0..    best_simp
+00002ec0: 5f73 636f 7265 203d 2030 0d0a 2020 2020  _score = 0..    
+00002ed0: 0d0a 2020 2020 6361 7573 655f 7661 7220  ..    cause_var 
+00002ee0: 3d20 6964 5f65 716e 5f61 6c6c 5b30 5d2e  = id_eqn_all[0].
+00002ef0: 6c68 732e 646f 760d 0a20 2020 2065 6666  lhs.dov..    eff
+00002f00: 5f76 6172 203d 2069 645f 6571 6e5f 616c  _var = id_eqn_al
+00002f10: 6c5b 305d 2e6c 6873 2e6e 756d 5b30 5d0d  l[0].lhs.num[0].
+00002f20: 0a20 2020 2066 6f72 2069 2c69 645f 6571  .    for i,id_eq
+00002f30: 6e20 696e 2065 6e75 6d65 7261 7465 2869  n in enumerate(i
+00002f40: 645f 6571 6e5f 616c 6c29 3a0d 0a20 2020  d_eqn_all):..   
+00002f50: 2020 2020 200d 0a20 2020 2020 2020 2077       ..        w
+00002f60: 5f64 656e 6f6d 203d 2069 645f 6571 6e2e  _denom = id_eqn.
+00002f70: 7268 732e 6465 6e0d 0a20 2020 2020 2020  rhs.den..       
+00002f80: 2077 5f64 656e 6f6d 203d 205b 736f 7274   w_denom = [sort
+00002f90: 6564 2877 5f64 656e 6f6d 5b69 5d29 2066  ed(w_denom[i]) f
+00002fa0: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
+00002fb0: 6e28 775f 6465 6e6f 6d29 295d 0d0a 2020  n(w_denom))]..  
+00002fc0: 2020 2020 2020 775f 6e6f 6d20 3d20 6964        w_nom = id
+00002fd0: 5f65 716e 2e72 6873 2e6e 756d 0d0a 2020  _eqn.rhs.num..  
+00002fe0: 2020 2020 2020 775f 6e6f 6d20 3d20 5b73        w_nom = [s
+00002ff0: 6f72 7465 6428 775f 6e6f 6d5b 695d 2920  orted(w_nom[i]) 
+00003000: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
+00003010: 656e 2877 5f6e 6f6d 2929 5d0d 0a20 2020  en(w_nom))]..   
+00003020: 2020 2020 200d 0a20 2020 2020 2020 2065       ..        e
+00003030: 6666 5f76 6172 5f63 6e74 5f6e 6f6d 203d  ff_var_cnt_nom =
+00003040: 206c 656e 285b 3020 666f 7220 775f 6e6f   len([0 for w_no
+00003050: 6d5f 6920 696e 2077 5f6e 6f6d 2066 6f72  m_i in w_nom for
+00003060: 2065 6c65 6d65 6e74 2069 6e20 775f 6e6f   element in w_no
+00003070: 6d5f 6920 6966 206c 6973 7428 6566 665f  m_i if list(eff_
+00003080: 7661 7229 5b30 5d20 696e 2065 6c65 6d65  var)[0] in eleme
+00003090: 6e74 5d29 0d0a 2020 2020 2020 2020 6566  nt])..        ef
+000030a0: 665f 7661 725f 636e 745f 6465 6e6f 6d20  f_var_cnt_denom 
+000030b0: 3d20 6c65 6e28 5b30 2066 6f72 2077 5f64  = len([0 for w_d
+000030c0: 656e 6f6d 5f69 2069 6e20 775f 6465 6e6f  enom_i in w_deno
+000030d0: 6d20 666f 7220 656c 656d 656e 7420 696e  m for element in
+000030e0: 2077 5f64 656e 6f6d 5f69 2069 6620 6c69   w_denom_i if li
+000030f0: 7374 2865 6666 5f76 6172 295b 305d 2069  st(eff_var)[0] i
+00003100: 6e20 656c 656d 656e 745d 290d 0a20 2020  n element])..   
+00003110: 2020 2020 2065 6666 5f76 6172 5f63 6e74       eff_var_cnt
+00003120: 203d 2065 6666 5f76 6172 5f63 6e74 5f6e   = eff_var_cnt_n
+00003130: 6f6d 202b 2065 6666 5f76 6172 5f63 6e74  om + eff_var_cnt
+00003140: 5f64 656e 6f6d 0d0a 2020 2020 2020 2020  _denom..        
+00003150: 0d0a 2020 2020 2020 2020 2320 4368 6563  ..        # Chec
+00003160: 6b20 6966 206f 6e6c 7920 6f6e 6520 6566  k if only one ef
+00003170: 6665 6374 2076 6172 6961 626c 6520 696e  fect variable in
+00003180: 2074 6865 2065 7870 7265 7373 696f 6e0d   the expression.
+00003190: 0a20 2020 2020 2020 2076 616c 6964 5f63  .        valid_c
+000031a0: 6f6e 6431 203d 2065 6666 5f76 6172 5f63  ond1 = eff_var_c
+000031b0: 6e74 3c3d 310d 0a20 2020 2020 2020 2023  nt<=1..        #
+000031c0: 2043 6865 636b 2069 6620 696e 7465 7276   Check if interv
+000031d0: 656e 7469 6f6e 616c 2076 6172 6961 626c  entional variabl
+000031e0: 6520 696e 2074 6865 2065 7870 7265 7373  e in the express
+000031f0: 696f 6e0d 0a20 2020 2020 2020 2076 616c  ion..        val
+00003200: 6964 5f63 6f6e 6432 203d 2028 2861 6e79  id_cond2 = ((any
+00003210: 286c 6973 7428 6361 7573 655f 7661 7229  (list(cause_var)
+00003220: 5b30 5d20 696e 2077 5f6e 6f6d 5f69 2066  [0] in w_nom_i f
+00003230: 6f72 2077 5f6e 6f6d 5f69 2069 6e20 775f  or w_nom_i in w_
+00003240: 6e6f 6d29 2920 6f72 2028 616e 7928 6c69  nom)) or (any(li
+00003250: 7374 2863 6175 7365 5f76 6172 295b 305d  st(cause_var)[0]
+00003260: 2069 6e20 775f 6465 6e6f 6d5f 6920 666f   in w_denom_i fo
+00003270: 7220 775f 6465 6e6f 6d5f 6920 696e 2077  r w_denom_i in w
+00003280: 5f64 656e 6f6d 2929 290d 0a20 2020 2020  _denom)))..     
+00003290: 2020 2023 2043 6865 636b 2069 6620 5061     # Check if Pa
+000032a0: 2865 6666 6563 745f 7661 7229 206f 7220  (effect_var) or 
+000032b0: 5061 2865 6666 6563 745f 7661 7229 5c63  Pa(effect_var)\c
+000032c0: 6175 7365 5f76 6172 2069 7320 696e 2074  ause_var is in t
+000032d0: 6865 206e 6f6d 696e 6174 6f72 0d0a 2020  he nominator..  
+000032e0: 2020 2020 2020 6570 7369 6c6f 203d 2069        epsilo = i
+000032f0: 645f 6571 6e2e 7268 732e 6d72 670d 0a20  d_eqn.rhs.mrg.. 
+00003300: 2020 2020 2020 2059 7550 613d 2073 6f72         YuPa= sor
+00003310: 7465 6428 6570 7369 6c6f 2e75 6e69 6f6e  ted(epsilo.union
+00003320: 2865 6666 5f76 6172 2929 0d0a 2020 2020  (eff_var))..    
+00003330: 2020 2020 5875 5975 5061 203d 2073 6f72      XuYuPa = sor
+00003340: 7465 6428 7365 7428 5975 5061 292e 756e  ted(set(YuPa).un
+00003350: 696f 6e28 6361 7573 655f 7661 7229 290d  ion(cause_var)).
+00003360: 0a20 2020 2020 2020 2023 2069 6620 5920  .        # if Y 
+00003370: 6973 2069 6e20 7468 6520 5061 2858 290d  is in the Pa(X).
+00003380: 0a20 2020 2020 2020 2059 7550 615f 696e  .        YuPa_in
+00003390: 5f6e 6f6d 203d 2059 7550 6120 696e 2077  _nom = YuPa in w
+000033a0: 5f6e 6f6d 0d0a 2020 2020 2020 2020 2320  _nom..        # 
+000033b0: 6966 2059 2069 7320 6e6f 7420 696e 2074  if Y is not in t
+000033c0: 6865 2050 6128 5829 200d 0a20 2020 2020  he Pa(X) ..     
+000033d0: 2020 2058 7559 7550 615f 696e 5f6e 6f6d     XuYuPa_in_nom
+000033e0: 203d 2058 7559 7550 6120 696e 2077 5f6e   = XuYuPa in w_n
+000033f0: 6f6d 0d0a 2020 2020 2020 2020 7661 6c69  om..        vali
+00003400: 645f 636f 6e64 3320 3d20 5975 5061 5f69  d_cond3 = YuPa_i
+00003410: 6e5f 6e6f 6d20 6f72 2058 7559 7550 615f  n_nom or XuYuPa_
+00003420: 696e 5f6e 6f6d 0d0a 2020 2020 2020 2020  in_nom..        
+00003430: 2320 4368 6563 6b20 6966 2069 7420 6973  # Check if it is
+00003440: 2061 2076 616c 6964 2069 645f 6571 6e0d   a valid id_eqn.
+00003450: 0a20 2020 2020 2020 2076 616c 6964 5f69  .        valid_i
+00003460: 645f 6571 6e20 3d20 7661 6c69 645f 636f  d_eqn = valid_co
+00003470: 6e64 3120 616e 6420 7661 6c69 645f 636f  nd1 and valid_co
+00003480: 6e64 3220 616e 6420 7661 6c69 645f 636f  nd2 and valid_co
+00003490: 6e64 330d 0a20 2020 2020 2020 2023 2043  nd3..        # C
+000034a0: 7269 7465 7269 6120 746f 2073 656c 6563  riteria to selec
+000034b0: 7420 7468 6520 7369 6d70 6c65 7374 2069  t the simplest i
+000034c0: 645f 6571 6e0d 0a20 2020 2020 2020 2073  d_eqn..        s
+000034d0: 696d 706c 6963 6974 795f 7363 6f72 6520  implicity_score 
+000034e0: 3d20 312f 286c 656e 2877 5f6e 6f6d 292b  = 1/(len(w_nom)+
+000034f0: 6c65 6e28 775f 6465 6e6f 6d29 290d 0a20  len(w_denom)).. 
+00003500: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00003510: 2069 6620 7661 6c69 645f 6964 5f65 716e   if valid_id_eqn
+00003520: 2061 6e64 2073 696d 706c 6963 6974 795f   and simplicity_
+00003530: 7363 6f72 6520 3e20 6265 7374 5f73 696d  score > best_sim
+00003540: 705f 7363 6f72 653a 0d0a 2020 2020 2020  p_score:..      
+00003550: 2020 2020 2020 6265 7374 5f73 696d 705f        best_simp_
+00003560: 7363 6f72 6520 3d20 7369 6d70 6c69 6369  score = simplici
+00003570: 7479 5f73 636f 7265 0d0a 2020 2020 2020  ty_score..      
+00003580: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00003590: 2020 2020 6966 2059 7550 615f 696e 5f6e      if YuPa_in_n
+000035a0: 6f6d 3a0d 0a20 2020 2020 2020 2020 2020  om:..           
+000035b0: 2020 2020 206b 6572 6e65 6c5f 666c 6167       kernel_flag
+000035c0: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
+000035d0: 2020 2020 2020 2020 2020 775f 6e6f 6d2e            w_nom.
+000035e0: 7265 6d6f 7665 2859 7550 6129 0d0a 2020  remove(YuPa)..  
+000035f0: 2020 2020 2020 2020 2020 6966 2058 7559            if XuY
+00003600: 7550 615f 696e 5f6e 6f6d 3a0d 0a20 2020  uPa_in_nom:..   
+00003610: 2020 2020 2020 2020 2020 2020 206b 6572               ker
+00003620: 6e65 6c5f 666c 6167 203d 2054 7275 650d  nel_flag = True.
+00003630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003640: 2077 5f6e 6f6d 2e72 656d 6f76 6528 5875   w_nom.remove(Xu
+00003650: 5975 5061 290d 0a20 2020 2020 2020 2020  YuPa)..         
+00003660: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00003670: 2062 6573 745f 775f 6e6f 6d20 3d20 775f   best_w_nom = w_
+00003680: 6e6f 6d0d 0a20 2020 2020 2020 2020 2020  nom..           
+00003690: 2062 6573 745f 775f 6465 6e6f 6d20 3d20   best_w_denom = 
+000036a0: 775f 6465 6e6f 6d0d 0a20 2020 2020 2020  w_denom..       
+000036b0: 2020 2020 2062 6573 745f 6964 5f73 7472       best_id_str
+000036c0: 203d 2069 645f 7374 725f 616c 6c5b 695d   = id_str_all[i]
+000036d0: 0d0a 2020 2020 2020 2020 2020 2020 6265  ..            be
+000036e0: 7374 5f69 645f 6571 6e20 3d20 6964 5f65  st_id_eqn = id_e
+000036f0: 716e 0d0a 2020 2020 0d0a 2020 2020 7765  qn..    ..    we
+00003700: 6967 6874 5f66 756e 635f 6c61 6d20 3d20  ight_func_lam = 
+00003710: 6c61 6d62 6461 2064 6973 745f 6d61 702c  lambda dist_map,
+00003720: 204e 2c20 6b65 726e 656c 3a20 7765 6967   N, kernel: weig
+00003730: 6874 5f66 756e 6328 6265 7374 5f69 645f  ht_func(best_id_
+00003740: 6571 6e2c 2064 6973 745f 6d61 702c 204e  eqn, dist_map, N
+00003750: 2c20 6b65 726e 656c 2920 2020 2020 2020  , kernel)       
+00003760: 200d 0a20 2020 200d 0a20 2020 2077 616e   ..    ..    wan
+00003770: 7465 645f 6469 7374 203d 205b 5d0d 0a20  ted_dist = [].. 
+00003780: 2020 2077 5f6e 6f6d 5f73 7472 203d 2022     w_nom_str = "
+00003790: 220d 0a20 2020 2066 6f72 206e 6f6d 2069  "..    for nom i
+000037a0: 6e20 6265 7374 5f77 5f6e 6f6d 3a0d 0a20  n best_w_nom:.. 
+000037b0: 2020 2020 2020 206a 6f69 6e74 5f76 6172         joint_var
+000037c0: 5f73 7472 203d 2022 220d 0a20 2020 2020  _str = ""..     
+000037d0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+000037e0: 6528 6c65 6e28 6e6f 6d29 293a 0d0a 2020  e(len(nom)):..  
+000037f0: 2020 2020 2020 2020 2020 6a6f 696e 745f            joint_
+00003800: 7661 725f 7374 7220 2b3d 206e 6f6d 5b69  var_str += nom[i
+00003810: 5d0d 0a20 2020 2020 2020 2020 2020 2069  ]..            i
+00003820: 6620 6920 213d 206c 656e 286e 6f6d 292d  f i != len(nom)-
+00003830: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
+00003840: 2020 2020 6a6f 696e 745f 7661 725f 7374      joint_var_st
+00003850: 7220 2b3d 2022 2c22 0d0a 2020 2020 2020  r += ","..      
+00003860: 2020 775f 6e6f 6d5f 7374 7220 2b3d 2022    w_nom_str += "
+00003870: 5028 2220 2b20 6a6f 696e 745f 7661 725f  P(" + joint_var_
+00003880: 7374 7220 2b20 2229 220d 0a20 2020 2020  str + ")"..     
+00003890: 2020 2077 616e 7465 645f 6469 7374 2e61     wanted_dist.a
+000038a0: 7070 656e 6428 2250 2822 202b 206a 6f69  ppend("P(" + joi
+000038b0: 6e74 5f76 6172 5f73 7472 202b 2022 2922  nt_var_str + ")"
+000038c0: 290d 0a20 2020 2069 6620 6b65 726e 656c  )..    if kernel
+000038d0: 5f66 6c61 673a 0d0a 2020 2020 2020 2020  _flag:..        
+000038e0: 6b65 726e 656c 5f66 756e 635f 7374 7220  kernel_func_str 
+000038f0: 3d20 224b 2822 2b6c 6973 7428 6361 7573  = "K("+list(caus
+00003900: 655f 7661 7229 5b30 5d2b 222c 222b 6c69  e_var)[0]+","+li
+00003910: 7374 2863 6175 7365 5f76 6172 295b 305d  st(cause_var)[0]
+00003920: 2b22 2729 220d 0a20 2020 2020 2020 2077  +"')"..        w
+00003930: 5f6e 6f6d 5f73 7472 202b 3d20 6b65 726e  _nom_str += kern
+00003940: 656c 5f66 756e 635f 7374 720d 0a20 2020  el_func_str..   
+00003950: 200d 0a20 2020 2077 5f64 656e 6f6d 5f73   ..    w_denom_s
+00003960: 7472 203d 2022 220d 0a20 2020 2066 6f72  tr = ""..    for
+00003970: 2064 656e 6f6d 2069 6e20 6265 7374 5f77   denom in best_w
+00003980: 5f64 656e 6f6d 3a0d 0a20 2020 2020 2020  _denom:..       
+00003990: 206a 6f69 6e74 5f76 6172 5f73 7472 203d   joint_var_str =
+000039a0: 2022 220d 0a20 2020 2020 2020 2066 6f72   ""..        for
+000039b0: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
+000039c0: 6465 6e6f 6d29 293a 0d0a 2020 2020 2020  denom)):..      
+000039d0: 2020 2020 2020 6a6f 696e 745f 7661 725f        joint_var_
+000039e0: 7374 7220 2b3d 2064 656e 6f6d 5b69 5d0d  str += denom[i].
+000039f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00003a00: 6920 213d 206c 656e 2864 656e 6f6d 292d  i != len(denom)-
+00003a10: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
+00003a20: 2020 2020 6a6f 696e 745f 7661 725f 7374      joint_var_st
+00003a30: 7220 2b3d 2022 2c22 0d0a 2020 2020 2020  r += ","..      
+00003a40: 2020 775f 6465 6e6f 6d5f 7374 7220 2b3d    w_denom_str +=
+00003a50: 2022 5028 2220 2b20 6a6f 696e 745f 7661   "P(" + joint_va
+00003a60: 725f 7374 7220 2b20 2229 220d 0a20 2020  r_str + ")"..   
+00003a70: 2020 2020 2077 616e 7465 645f 6469 7374       wanted_dist
+00003a80: 2e61 7070 656e 6428 2250 2822 202b 206a  .append("P(" + j
+00003a90: 6f69 6e74 5f76 6172 5f73 7472 202b 2022  oint_var_str + "
+00003aa0: 2922 290d 0a20 2020 2020 2020 200d 0a20  )")..        .. 
+00003ab0: 2020 2077 6569 6768 745f 6675 6e63 5f73     weight_func_s
+00003ac0: 7472 203d 2022 5b22 2b77 5f6e 6f6d 5f73  tr = "["+w_nom_s
+00003ad0: 7472 2b22 5d22 2b22 2f4e 2a5b 2220 2b77  tr+"]"+"/N*[" +w
+00003ae0: 5f64 656e 6f6d 5f73 7472 202b 2022 5d22  _denom_str + "]"
+00003af0: 0d0a 2020 2020 2320 7072 696e 7420 6f75  ..    # print ou
+00003b00: 7420 696e 7465 7276 656e 7469 6f6e 616c  t interventional
+00003b10: 2070 726f 6261 6269 6c69 7479 2065 7870   probability exp
+00003b20: 7265 7373 696f 6e20 616e 6420 7265 7175  ression and requ
+00003b30: 6972 6564 2064 6973 7472 6962 7574 696f  ired distributio
+00003b40: 6e73 0d0a 2020 2020 6966 2069 6e66 6f5f  ns..    if info_
+00003b50: 7072 696e 743a 0d0a 2020 2020 2020 2020  print:..        
+00003b60: 7072 696e 7428 2249 6e74 6572 7665 6e74  print("Intervent
+00003b70: 696f 6e61 6c20 7072 6f62 2e3a 7b7d 222e  ional prob.:{}".
+00003b80: 666f 726d 6174 2862 6573 745f 6964 5f73  format(best_id_s
+00003b90: 7472 2929 2020 2020 0d0a 2020 2020 2020  tr))    ..      
+00003ba0: 2020 7072 696e 7428 2243 6175 7361 6c20    print("Causal 
+00003bb0: 626f 6f74 7374 7261 7070 696e 6720 7765  bootstrapping we
+00003bc0: 6967 6874 7320 6675 6e63 7469 6f6e 3a20  ights function: 
+00003bd0: 7b7d 222e 666f 726d 6174 2877 6569 6768  {}".format(weigh
+00003be0: 745f 6675 6e63 5f73 7472 2929 0d0a 2020  t_func_str))..  
+00003bf0: 2020 2020 2020 7072 696e 7428 2252 6571        print("Req
+00003c00: 7569 7265 6420 6469 7374 7269 6275 7469  uired distributi
+00003c10: 6f6e 733a 2229 0d0a 2020 2020 2020 2020  ons:")..        
+00003c20: 6920 3d20 300d 0a20 2020 2020 2020 2066  i = 0..        f
+00003c30: 6f72 2064 6973 7420 696e 2077 616e 7465  or dist in wante
+00003c40: 645f 6469 7374 3a0d 0a20 2020 2020 2020  d_dist:..       
+00003c50: 2020 2020 2069 202b 3d20 310d 0a20 2020       i += 1..   
+00003c60: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+00003c70: 7b7d 3a20 7b7d 222e 666f 726d 6174 2869  {}: {}".format(i
+00003c80: 2c20 6469 7374 2929 0d0a 2020 2020 2020  , dist))..      
+00003c90: 2020 6966 206b 6572 6e65 6c5f 666c 6167    if kernel_flag
+00003ca0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00003cb0: 7269 6e74 2822 4b65 726e 656c 2066 756e  rint("Kernel fun
+00003cc0: 6374 696f 6e20 7265 7175 6972 6564 3a20  ction required: 
+00003cd0: 7b7d 222e 666f 726d 6174 286b 6572 6e65  {}".format(kerne
+00003ce0: 6c5f 6675 6e63 5f73 7472 2929 0d0a 2020  l_func_str))..  
+00003cf0: 2020 0d0a 2020 2020 7265 7475 726e 2077    ..    return w
+00003d00: 6569 6768 745f 6675 6e63 5f6c 616d 2c20  eight_func_lam, 
+00003d10: 7765 6967 6874 5f66 756e 635f 7374 720d  weight_func_str.
+00003d20: 0a0d 0a64 6566 2067 656e 6572 616c 5f63  ...def general_c
+00003d30: 6175 7361 6c5f 626f 6f74 7374 7261 7070  ausal_bootstrapp
+00003d40: 696e 675f 7369 6d70 6c65 2877 6569 6768  ing_simple(weigh
+00003d50: 745f 6675 6e63 5f6c 616d 2c20 6469 7374  t_func_lam, dist
+00003d60: 5f6d 6170 2c20 6461 7461 2c20 696e 7476  _map, data, intv
+00003d70: 5f76 6172 5f6e 616d 652c 206b 6572 6e65  _var_name, kerne
+00003d80: 6c20 3d20 4e6f 6e65 2c20 6d6f 6465 203d  l = None, mode =
+00003d90: 2022 6661 7374 2229 3a0d 0a20 2020 2022   "fast"):..    "
+00003da0: 2222 0d0a 2020 2020 5065 7266 6f72 6d20  ""..    Perform 
+00003db0: 6361 7573 616c 2062 6f6f 7473 7472 6170  causal bootstrap
+00003dc0: 7069 6e67 2066 6f72 2061 2067 656e 6572  ping for a gener
+00003dd0: 616c 2063 6175 7361 6c20 6772 6170 6820  al causal graph 
+00003de0: 6966 2069 7420 6973 2069 6465 6e74 6966  if it is identif
+00003df0: 6961 626c 6520 7573 696e 6720 6120 7370  iable using a sp
+00003e00: 6563 6966 6965 6420 7765 6967 6874 2066  ecified weight f
+00003e10: 756e 6374 696f 6e2e 200d 0a20 2020 2054  unction. ..    T
+00003e20: 6869 7320 6675 6e63 7469 6f6e 2069 7320  his function is 
+00003e30: 6465 7369 676e 6564 2074 6f20 6372 6561  designed to crea
+00003e40: 7465 2061 2062 6f6f 7473 7472 6170 7065  te a bootstrappe
+00003e50: 6420 6461 7461 7365 7420 6261 7365 6420  d dataset based 
+00003e60: 6f6e 2074 6865 2073 7065 6369 6669 6564  on the specified
+00003e70: 2069 6e74 6572 7665 6e74 696f 6e20 7661   intervention va
+00003e80: 7269 6162 6c65 7320 616e 6420 7468 6520  riables and the 
+00003e90: 0d0a 2020 2020 7765 6967 6874 696e 6720  ..    weighting 
+00003ea0: 6675 6e63 7469 6f6e 2e20 5468 6520 6675  function. The fu
+00003eb0: 6e63 7469 6f6e 2061 6c6c 6f77 7320 666f  nction allows fo
+00003ec0: 7220 616e 206f 7074 696f 6e61 6c20 6b65  r an optional ke
+00003ed0: 726e 656c 2074 6f20 6265 2073 7065 6369  rnel to be speci
+00003ee0: 6669 6564 2e0d 0a0d 0a20 2020 2050 6172  fied.....    Par
+00003ef0: 616d 6574 6572 733a 0d0a 2020 2020 2020  ameters:..      
+00003f00: 2020 7765 6967 6874 5f66 756e 635f 6c61    weight_func_la
+00003f10: 6d20 2866 756e 6374 696f 6e29 3a20 4120  m (function): A 
+00003f20: 6c61 6d62 6461 206f 7220 6675 6e63 7469  lambda or functi
+00003f30: 6f6e 2074 6861 7420 6361 6c63 756c 6174  on that calculat
+00003f40: 6573 2077 6569 6768 7473 2e20 4974 2073  es weights. It s
+00003f50: 686f 756c 6420 7461 6b65 2027 6469 7374  hould take 'dist
+00003f60: 5f6d 6170 272c 2027 4e27 2c20 616e 6420  _map', 'N', and 
+00003f70: 6f70 7469 6f6e 616c 6c79 2027 6b65 726e  optionally 'kern
+00003f80: 656c 2720 6173 2061 7267 756d 656e 7473  el' as arguments
+00003f90: 2e0d 0a20 2020 2020 2020 2064 6973 745f  ...        dist_
+00003fa0: 6d61 7020 2864 6963 7429 3a20 416e 206f  map (dict): An o
+00003fb0: 626a 6563 7420 7265 7072 6573 656e 7469  bject representi
+00003fc0: 6e67 2061 2064 6973 7461 6e63 6520 6d61  ng a distance ma
+00003fd0: 702c 2077 6869 6368 2069 7320 7573 6564  p, which is used
+00003fe0: 2062 7920 2777 6569 6768 745f 6675 6e63   by 'weight_func
+00003ff0: 5f6c 616d 2720 746f 2063 616c 6375 6c61  _lam' to calcula
+00004000: 7465 2077 6569 6768 7473 2e0d 0a20 2020  te weights...   
+00004010: 2020 2020 2064 6174 6120 2864 6963 7429       data (dict)
+00004020: 3a20 4120 6469 6374 696f 6e61 7279 2063  : A dictionary c
+00004030: 6f6e 7461 696e 696e 6720 7468 6520 6461  ontaining the da
+00004040: 7461 7365 742e 204b 6579 7320 6172 6520  taset. Keys are 
+00004050: 7661 7269 6162 6c65 206e 616d 6573 2061  variable names a
+00004060: 6e64 2076 616c 7565 7320 6172 6520 636f  nd values are co
+00004070: 7272 6573 706f 6e64 696e 6720 6461 7461  rresponding data
+00004080: 2061 7272 6179 732e 0d0a 2020 2020 2020   arrays...      
+00004090: 2020 696e 7476 5f76 6172 5f6e 616d 6520    intv_var_name 
+000040a0: 2873 7472 293a 2054 6865 206e 616d 6520  (str): The name 
+000040b0: 6f66 2074 6865 2069 6e74 6572 7665 6e74  of the intervent
+000040c0: 696f 6e20 7661 7269 6162 6c65 2e20 5468  ion variable. Th
+000040d0: 6973 2076 6172 6961 626c 6520 7368 6f75  is variable shou
+000040e0: 6c64 2062 6520 6120 6b65 7920 696e 2074  ld be a key in t
+000040f0: 6865 2027 6461 7461 2720 6469 6374 696f  he 'data' dictio
+00004100: 6e61 7279 2e0d 0a20 2020 2020 2020 206b  nary...        k
+00004110: 6572 6e65 6c20 2866 756e 6374 696f 6e2c  ernel (function,
+00004120: 206f 7074 696f 6e61 6c29 3a20 416e 206f   optional): An o
+00004130: 7074 696f 6e61 6c20 6b65 726e 656c 2066  ptional kernel f
+00004140: 756e 6374 696f 6e20 7468 6174 2063 616e  unction that can
+00004150: 2062 6520 7573 6564 2069 6e20 7765 6967   be used in weig
+00004160: 6874 2063 6f6d 7075 7461 7469 6f6e 2e20  ht computation. 
+00004170: 4465 6661 756c 7420 6973 204e 6f6e 652e  Default is None.
+00004180: 0d0a 2020 2020 2020 2020 6d6f 6465 2028  ..        mode (
+00004190: 7374 722c 206f 7074 696f 6e61 6c29 3a20  str, optional): 
+000041a0: 4120 7374 7269 6e67 2069 6e64 6963 6174  A string indicat
+000041b0: 696e 6720 7468 6520 626f 6f74 7374 7261  ing the bootstra
+000041c0: 7070 696e 6720 6d6f 6465 2e20 4974 2063  pping mode. It c
+000041d0: 616e 2062 6520 6569 7468 6572 2027 6661  an be either 'fa
+000041e0: 7374 2720 6f72 2027 726f 6275 7374 2720  st' or 'robust' 
+000041f0: 6465 7065 6e64 696e 6720 6f6e 2074 6865  depending on the
+00004200: 2069 6d70 6c65 6d65 6e74 6174 696f 6e2e   implementation.
+00004210: 2044 6566 6175 6c74 2069 7320 2766 6173   Default is 'fas
+00004220: 7427 2e0d 0a0d 0a20 2020 2052 6574 7572  t'.....    Retur
+00004230: 6e73 3a0d 0a20 2020 2020 2020 2064 6963  ns:..        dic
+00004240: 743a 2041 2064 6963 7469 6f6e 6172 7920  t: A dictionary 
+00004250: 636f 6e74 6169 6e69 6e67 2076 6172 6961  containing varia
+00004260: 626c 6520 6e61 6d65 7320 6173 206b 6579  ble names as key
+00004270: 7320 616e 6420 7468 6569 7220 636f 7272  s and their corr
+00004280: 6573 706f 6e64 696e 6720 626f 6f74 7374  esponding bootst
+00004290: 7261 7070 6564 2064 6174 6120 6172 7261  rapped data arra
+000042a0: 7973 2061 7320 7661 6c75 6573 2e0d 0a20  ys as values... 
+000042b0: 2020 2022 2222 0d0a 2020 2020 6361 7573     """..    caus
+000042c0: 655f 6461 7461 203d 205b 7661 6c75 6520  e_data = [value 
+000042d0: 666f 7220 6b65 792c 2076 616c 7565 2069  for key, value i
+000042e0: 6e20 6461 7461 2e69 7465 6d73 2829 2069  n data.items() i
+000042f0: 6620 696e 7476 5f76 6172 5f6e 616d 6520  f intv_var_name 
+00004300: 696e 206b 6579 5d5b 305d 0d0a 2020 2020  in key][0]..    
+00004310: 696e 7476 5f76 6172 5f6e 616d 655f 696e  intv_var_name_in
+00004320: 5f64 6174 6120 3d20 5b6b 6579 2066 6f72  _data = [key for
+00004330: 206b 6579 2c20 7661 6c75 6520 696e 2064   key, value in d
+00004340: 6174 612e 6974 656d 7328 2920 6966 2069  ata.items() if i
+00004350: 6e74 765f 7661 725f 6e61 6d65 2069 6e20  ntv_var_name in 
+00004360: 6b65 795d 5b30 5d0d 0a20 2020 204e 203d  key][0]..    N =
+00004370: 2063 6175 7365 5f64 6174 612e 7368 6170   cause_data.shap
+00004380: 655b 305d 0d0a 2020 2020 6966 206b 6572  e[0]..    if ker
+00004390: 6e65 6c20 6973 206e 6f74 204e 6f6e 653a  nel is not None:
+000043a0: 0d0a 2020 2020 2020 2020 696e 7476 5f76  ..        intv_v
+000043b0: 6172 5f6e 616d 6520 3d20 5b70 6172 616d  ar_name = [param
+000043c0: 2066 6f72 2070 6172 616d 2069 6e20 696e   for param in in
+000043d0: 7370 6563 742e 7369 676e 6174 7572 6528  spect.signature(
+000043e0: 6b65 726e 656c 292e 7061 7261 6d65 7465  kernel).paramete
+000043f0: 7273 2069 6620 7061 7261 6d20 213d 2069  rs if param != i
+00004400: 6e74 765f 7661 725f 6e61 6d65 5f69 6e5f  ntv_var_name_in_
+00004410: 6461 7461 5d5b 305d 0d0a 2020 2020 0d0a  data][0]..    ..
+00004420: 2020 2020 775f 6675 6e63 203d 2077 6569      w_func = wei
+00004430: 6768 745f 6675 6e63 5f6c 616d 2864 6973  ght_func_lam(dis
+00004440: 745f 6d61 7020 3d20 6469 7374 5f6d 6170  t_map = dist_map
+00004450: 2c20 4e20 3d20 4e2c 206b 6572 6e65 6c20  , N = N, kernel 
+00004460: 3d20 6b65 726e 656c 290d 0a20 2020 2063  = kernel)..    c
+00004470: 6175 7365 5f75 6e69 7175 6520 3d20 7365  ause_unique = se
+00004480: 7428 6361 7573 655f 6461 7461 2e72 6573  t(cause_data.res
+00004490: 6861 7065 282d 3129 290d 0a20 2020 2077  hape(-1))..    w
+000044a0: 6569 6768 7473 203d 206e 702e 7a65 726f  eights = np.zero
+000044b0: 7328 284e 2c20 6c65 6e28 6361 7573 655f  s((N, len(cause_
+000044c0: 756e 6971 7565 2929 290d 0a20 2020 2066  unique)))..    f
+000044d0: 6f72 2069 2c20 7920 696e 2065 6e75 6d65  or i, y in enume
+000044e0: 7261 7465 2863 6175 7365 5f75 6e69 7175  rate(cause_uniqu
+000044f0: 6529 3a0d 0a20 2020 2020 2020 2077 6569  e):..        wei
+00004500: 6768 7473 5b3a 2c69 5d3d 7765 6967 6874  ghts[:,i]=weight
+00004510: 5f63 6f6d 7075 7465 2877 6569 6768 745f  _compute(weight_
+00004520: 6675 6e63 203d 2077 5f66 756e 632c 2064  func = w_func, d
+00004530: 6174 6120 3d20 6461 7461 202c 696e 7476  ata = data ,intv
+00004540: 5f76 6172 203d 207b 696e 7476 5f76 6172  _var = {intv_var
+00004550: 5f6e 616d 653a 205b 7920 666f 7220 6920  _name: [y for i 
+00004560: 696e 2072 616e 6765 284e 295d 7d29 0d0a  in range(N)]})..
+00004570: 2020 2020 2020 2020 0d0a 2020 2020 626f          ..    bo
+00004580: 6f74 7374 7261 7070 6564 5f64 6174 6120  otstrapped_data 
+00004590: 3d20 626f 6f74 7374 7261 7070 6572 2864  = bootstrapper(d
+000045a0: 6174 6120 3d20 6461 7461 2c20 7765 6967  ata = data, weig
+000045b0: 6874 7320 3d20 7765 6967 6874 732c 2069  hts = weights, i
+000045c0: 6e74 765f 7661 725f 6e61 6d65 5f69 6e5f  ntv_var_name_in_
+000045d0: 6461 7461 203d 205b 696e 7476 5f76 6172  data = [intv_var
+000045e0: 5f6e 616d 655f 696e 5f64 6174 615d 2c20  _name_in_data], 
+000045f0: 6d6f 6465 203d 206d 6f64 6529 0d0a 2020  mode = mode)..  
+00004600: 2020 0d0a 2020 2020 7265 7475 726e 2062    ..    return b
+00004610: 6f6f 7473 7472 6170 7065 645f 6461 7461  ootstrapped_data
+00004620: 0d0a 0d0a 6465 6620 6765 6e65 7261 6c5f  ....def general_
+00004630: 6361 7573 616c 5f62 6f6f 7473 7472 6170  causal_bootstrap
+00004640: 7069 6e67 5f73 696d 7528 7765 6967 6874  ping_simu(weight
+00004650: 5f66 756e 635f 6c61 6d2c 2064 6973 745f  _func_lam, dist_
+00004660: 6d61 702c 2064 6174 612c 2069 6e74 765f  map, data, intv_
+00004670: 7661 725f 7661 6c75 652c 206e 5f73 616d  var_value, n_sam
+00004680: 706c 652c 206b 6572 6e65 6c20 3d20 4e6f  ple, kernel = No
+00004690: 6e65 2c20 6d6f 6465 203d 2022 6661 7374  ne, mode = "fast
+000046a0: 2229 3a0d 0a20 2020 2022 2222 0d0a 2020  "):..    """..  
+000046b0: 2020 5065 7266 6f72 6d20 7369 6d75 6c61    Perform simula
+000046c0: 7469 6f6e 616c 2063 6175 7361 6c20 626f  tional causal bo
+000046d0: 6f74 7374 7261 7070 696e 6720 666f 7220  otstrapping for 
+000046e0: 6120 6765 6e65 7261 6c20 6361 7573 616c  a general causal
+000046f0: 2067 7261 7068 2069 6620 6974 2069 7320   graph if it is 
+00004700: 6964 656e 7469 6669 6162 6c65 2075 7369  identifiable usi
+00004710: 6e67 2061 2073 7065 6369 6669 6564 2077  ng a specified w
+00004720: 6569 6768 7420 6675 6e63 7469 6f6e 2e20  eight function. 
+00004730: 0d0a 2020 2020 5468 6973 2066 756e 6374  ..    This funct
+00004740: 696f 6e20 6973 2064 6573 6967 6e65 6420  ion is designed 
+00004750: 746f 2063 7265 6174 6520 6120 626f 6f74  to create a boot
+00004760: 7374 7261 7070 6564 2064 6174 6173 6574  strapped dataset
+00004770: 2062 6173 6564 206f 6e20 7468 6520 7370   based on the sp
+00004780: 6563 6966 6965 6420 696e 7465 7276 656e  ecified interven
+00004790: 7469 6f6e 207b 7661 7269 6162 6c65 3a76  tion {variable:v
+000047a0: 616c 7565 737d 2070 6169 7220 616e 6420  alues} pair and 
+000047b0: 7468 6520 7765 6967 6874 696e 6720 6675  the weighting fu
+000047c0: 6e63 7469 6f6e 2e0d 0a20 2020 2054 6865  nction...    The
+000047d0: 2066 756e 6374 696f 6e20 616c 6c6f 7773   function allows
+000047e0: 2066 6f72 2061 6e20 6f70 7469 6f6e 616c   for an optional
+000047f0: 206b 6572 6e65 6c20 746f 2062 6520 7370   kernel to be sp
+00004800: 6563 6966 6965 642e 0d0a 0d0a 2020 2020  ecified.....    
+00004810: 5061 7261 6d65 7465 7273 3a0d 0a20 2020  Parameters:..   
+00004820: 2020 2020 2077 6569 6768 745f 6675 6e63       weight_func
+00004830: 5f6c 616d 2028 6675 6e63 7469 6f6e 293a  _lam (function):
+00004840: 2041 206c 616d 6264 6120 6f72 2066 756e   A lambda or fun
+00004850: 6374 696f 6e20 7468 6174 2063 616c 6375  ction that calcu
+00004860: 6c61 7465 7320 7765 6967 6874 732e 2049  lates weights. I
+00004870: 7420 7368 6f75 6c64 2074 616b 6520 2764  t should take 'd
+00004880: 6973 745f 6d61 7027 2c20 274e 272c 2061  ist_map', 'N', a
+00004890: 6e64 206f 7074 696f 6e61 6c6c 7920 276b  nd optionally 'k
+000048a0: 6572 6e65 6c27 2061 7320 6172 6775 6d65  ernel' as argume
+000048b0: 6e74 732e 0d0a 2020 2020 2020 2020 6469  nts...        di
+000048c0: 7374 5f6d 6170 2028 6469 6374 293a 2041  st_map (dict): A
+000048d0: 6e20 6f62 6a65 6374 2072 6570 7265 7365  n object represe
+000048e0: 6e74 696e 6720 6120 6469 7374 616e 6365  nting a distance
+000048f0: 206d 6170 2c20 7768 6963 6820 6973 2075   map, which is u
+00004900: 7365 6420 6279 2027 7765 6967 6874 5f66  sed by 'weight_f
+00004910: 756e 635f 6c61 6d27 2074 6f20 6361 6c63  unc_lam' to calc
+00004920: 756c 6174 6520 7765 6967 6874 732e 0d0a  ulate weights...
+00004930: 2020 2020 2020 2020 6461 7461 2028 6469          data (di
+00004940: 6374 293a 2041 2064 6963 7469 6f6e 6172  ct): A dictionar
+00004950: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
+00004960: 2064 6174 6173 6574 2e20 4b65 7973 2061   dataset. Keys a
+00004970: 7265 2076 6172 6961 626c 6520 6e61 6d65  re variable name
+00004980: 7320 616e 6420 7661 6c75 6573 2061 7265  s and values are
+00004990: 2063 6f72 7265 7370 6f6e 6469 6e67 2064   corresponding d
+000049a0: 6174 6120 6172 7261 7973 2e0d 0a20 2020  ata arrays...   
+000049b0: 2020 2020 2069 6e74 765f 7661 725f 7661       intv_var_va
+000049c0: 6c75 6520 2864 6963 7429 3a20 4120 6469  lue (dict): A di
+000049d0: 6374 696f 6e61 7279 2063 6f6e 7461 696e  ctionary contain
+000049e0: 696e 6720 7468 6520 696e 7465 7276 656e  ing the interven
+000049f0: 7469 6f6e 2076 6172 6961 626c 6520 6e61  tion variable na
+00004a00: 6d65 2061 7320 6120 6b65 7920 616e 6420  me as a key and 
+00004a10: 6974 7320 6461 7461 2061 7272 6179 2061  its data array a
+00004a20: 7320 7468 6520 7661 6c75 652e 0d0a 2020  s the value...  
+00004a30: 2020 2020 2020 6e5f 7361 6d70 6c65 2028        n_sample (
+00004a40: 696e 7429 3a20 5468 6520 6e75 6d62 6572  int): The number
+00004a50: 206f 6620 7361 6d70 6c65 7320 746f 2062   of samples to b
+00004a60: 6520 6765 6e65 7261 7465 6420 7468 726f  e generated thro
+00004a70: 7567 6820 626f 6f74 7374 7261 7070 696e  ugh bootstrappin
+00004a80: 672e 0d0a 2020 2020 2020 2020 6b65 726e  g...        kern
+00004a90: 656c 2028 6675 6e63 7469 6f6e 2c20 6f70  el (function, op
+00004aa0: 7469 6f6e 616c 293a 2041 6e20 6f70 7469  tional): An opti
+00004ab0: 6f6e 616c 206b 6572 6e65 6c20 6675 6e63  onal kernel func
+00004ac0: 7469 6f6e 2074 6861 7420 6361 6e20 6265  tion that can be
+00004ad0: 2075 7365 6420 696e 2077 6569 6768 7420   used in weight 
+00004ae0: 636f 6d70 7574 6174 696f 6e2e 2044 6566  computation. Def
+00004af0: 6175 6c74 2069 7320 4e6f 6e65 2e0d 0a20  ault is None... 
+00004b00: 2020 2020 2020 206d 6f64 6520 2873 7472         mode (str
+00004b10: 2c20 6f70 7469 6f6e 616c 293a 2041 2073  , optional): A s
+00004b20: 7472 696e 6720 696e 6469 6361 7469 6e67  tring indicating
+00004b30: 2074 6865 2062 6f6f 7473 7472 6170 7069   the bootstrappi
+00004b40: 6e67 206d 6f64 652e 2049 7420 6361 6e20  ng mode. It can 
+00004b50: 6265 2065 6974 6865 7220 2766 6173 7427  be either 'fast'
+00004b60: 206f 7220 2772 6f62 7573 7427 2064 6570   or 'robust' dep
+00004b70: 656e 6469 6e67 206f 6e20 7468 6520 696d  ending on the im
+00004b80: 706c 656d 656e 7461 7469 6f6e 2e20 4465  plementation. De
+00004b90: 6661 756c 7420 6973 2027 6661 7374 272e  fault is 'fast'.
+00004ba0: 0d0a 0d0a 2020 2020 5265 7475 726e 733a  ....    Returns:
+00004bb0: 0d0a 2020 2020 2020 2020 6469 6374 3a20  ..        dict: 
+00004bc0: 4120 6469 6374 696f 6e61 7279 2063 6f6e  A dictionary con
+00004bd0: 7461 696e 696e 6720 7661 7269 6162 6c65  taining variable
+00004be0: 206e 616d 6573 2061 7320 6b65 7973 2061   names as keys a
+00004bf0: 6e64 2074 6865 6972 2063 6f72 7265 7370  nd their corresp
+00004c00: 6f6e 6469 6e67 2062 6f6f 7473 7472 6170  onding bootstrap
+00004c10: 7065 6420 6461 7461 2061 7272 6179 7320  ped data arrays 
+00004c20: 6173 2076 616c 7565 732e 0d0a 2020 2020  as values...    
+00004c30: 2222 2220 2020 200d 0a20 2020 204e 203d  """    ..    N =
+00004c40: 206c 6973 7428 6461 7461 2e76 616c 7565   list(data.value
+00004c50: 7328 2929 5b30 5d2e 7368 6170 655b 305d  s())[0].shape[0]
+00004c60: 0d0a 2020 2020 775f 6675 6e63 203d 2077  ..    w_func = w
+00004c70: 6569 6768 745f 6675 6e63 5f6c 616d 2864  eight_func_lam(d
+00004c80: 6973 745f 6d61 7020 3d20 6469 7374 5f6d  ist_map = dist_m
+00004c90: 6170 2c20 4e20 3d20 4e2c 206b 6572 6e65  ap, N = N, kerne
+00004ca0: 6c20 3d20 6b65 726e 656c 290d 0a20 2020  l = kernel)..   
+00004cb0: 2062 6f6f 7473 7472 6170 7065 645f 6461   bootstrapped_da
+00004cc0: 7461 2c20 7765 6967 6874 7320 3d20 7369  ta, weights = si
+00004cd0: 6d75 5f62 6f6f 7473 7472 6170 7065 7228  mu_bootstrapper(
+00004ce0: 6461 7461 203d 2064 6174 612c 2077 6569  data = data, wei
+00004cf0: 6768 745f 6675 6e63 203d 2077 5f66 756e  ght_func = w_fun
+00004d00: 632c 2069 6e74 765f 7661 725f 7661 6c75  c, intv_var_valu
+00004d10: 6520 3d20 696e 7476 5f76 6172 5f76 616c  e = intv_var_val
+00004d20: 7565 2c20 6e5f 7361 6d70 6c65 203d 206e  ue, n_sample = n
+00004d30: 5f73 616d 706c 652c 206d 6f64 6520 3d20  _sample, mode = 
+00004d40: 6d6f 6465 290d 0a20 2020 200d 0a20 2020  mode)..    ..   
+00004d50: 2072 6574 7572 6e20 626f 6f74 7374 7261   return bootstra
+00004d60: 7070 6564 5f64 6174 610d 0a0d 0a64 6566  pped_data....def
+00004d70: 2062 6163 6b64 6f6f 725f 7369 6d70 6c65   backdoor_simple
+00004d80: 2863 6175 7365 5f64 6174 612c 2065 6666  (cause_data, eff
+00004d90: 6563 745f 6461 7461 2c20 636f 6e66 6f75  ect_data, confou
+00004da0: 6e64 6572 5f64 6174 612c 2064 6973 745f  nder_data, dist_
+00004db0: 6d61 702c 206b 6572 6e65 6c5f 696e 7476  map, kernel_intv
+00004dc0: 203d 204e 6f6e 652c 206d 6f64 6520 3d20   = None, mode = 
+00004dd0: 2266 6173 7422 293a 0d0a 2020 2020 2222  "fast"):..    ""
+00004de0: 220d 0a20 2020 2050 6572 666f 726d 2062  "..    Perform b
+00004df0: 6163 6b64 6f6f 7220 6361 7573 616c 2062  ackdoor causal b
+00004e00: 6f6f 7473 7472 6170 7069 6e67 2074 6f20  ootstrapping to 
+00004e10: 6465 2d63 6f6e 666f 756e 6420 7468 6520  de-confound the 
+00004e20: 6361 7573 616c 2065 6666 6563 7420 7573  causal effect us
+00004e30: 696e 6720 7468 6520 7072 6f76 6964 6564  ing the provided
+00004e40: 206f 6273 6572 7661 7469 6f6e 616c 200d   observational .
+00004e50: 0a20 2020 2064 6174 6120 616e 6420 6469  .    data and di
+00004e60: 7374 7269 6275 7469 6f6e 206d 6170 732e  stribution maps.
+00004e70: 0d0a 0d0a 2020 2020 5061 7261 6d65 7465  ....    Paramete
+00004e80: 7273 3a0d 0a20 2020 2020 2020 2063 6175  rs:..        cau
+00004e90: 7365 5f64 6174 6120 2864 6963 7429 3a20  se_data (dict): 
+00004ea0: 4120 6469 6374 696f 6e61 7279 2063 6f6e  A dictionary con
+00004eb0: 7461 696e 696e 6720 7468 6520 6361 7573  taining the caus
+00004ec0: 6520 7661 7269 6162 6c65 206e 616d 6520  e variable name 
+00004ed0: 6173 2061 206b 6579 2061 6e64 2069 7473  as a key and its
+00004ee0: 2064 6174 6120 6172 7261 7920 6173 2074   data array as t
+00004ef0: 6865 2076 616c 7565 2e0d 0a20 2020 2020  he value...     
+00004f00: 2020 2065 6666 6563 745f 6461 7461 2028     effect_data (
+00004f10: 6469 6374 293a 2041 2064 6963 7469 6f6e  dict): A diction
+00004f20: 6172 7920 636f 6e74 6169 6e69 6e67 2074  ary containing t
+00004f30: 6865 2065 6666 6563 7420 7661 7269 6162  he effect variab
+00004f40: 6c65 206e 616d 6520 6173 2061 206b 6579  le name as a key
+00004f50: 2061 6e64 2069 7473 2064 6174 6120 6172   and its data ar
+00004f60: 7261 7920 6173 2074 6865 2076 616c 7565  ray as the value
+00004f70: 2e0d 0a20 2020 2020 2020 2063 6f6e 666f  ...        confo
+00004f80: 756e 6465 725f 6461 7461 2028 6469 6374  under_data (dict
+00004f90: 293a 2041 2064 6963 7469 6f6e 6172 7920  ): A dictionary 
+00004fa0: 636f 6e74 6169 6e69 6e67 2074 6865 2063  containing the c
+00004fb0: 6f6e 666f 756e 6465 7220 7661 7269 6162  onfounder variab
+00004fc0: 6c65 206e 616d 6520 6173 2061 206b 6579  le name as a key
+00004fd0: 2061 6e64 2069 7473 2064 6174 6120 6172   and its data ar
+00004fe0: 7261 7920 6173 2074 6865 2076 616c 7565  ray as the value
+00004ff0: 2e0d 0a20 2020 2020 2020 2064 6973 745f  ...        dist_
+00005000: 6d61 7020 2864 6963 7429 3a20 4120 6469  map (dict): A di
+00005010: 6374 696f 6e61 7279 206d 6170 7069 6e67  ctionary mapping
+00005020: 2074 7570 6c65 7320 6f66 2076 6172 6961   tuples of varia
+00005030: 626c 6520 636f 6d62 696e 6174 696f 6e73  ble combinations
+00005040: 2074 6f20 7468 6569 7220 636f 7272 6573   to their corres
+00005050: 706f 6e64 696e 6720 6469 7374 7269 6275  ponding distribu
+00005060: 7469 6f6e 2066 756e 6374 696f 6e73 2e0d  tion functions..
+00005070: 0a20 2020 2020 2020 206b 6572 6e65 6c5f  .        kernel_
+00005080: 696e 7476 2028 6675 6e63 7469 6f6e 2c20  intv (function, 
+00005090: 6f70 7469 6f6e 616c 293a 2054 6865 206b  optional): The k
+000050a0: 6572 6e65 6c20 6675 6e63 7469 6f6e 2074  ernel function t
+000050b0: 6f20 6265 2075 7365 6420 696e 2074 6865  o be used in the
+000050c0: 2062 6163 6b64 6f6f 7220 626f 6f74 7374   backdoor bootst
+000050d0: 7261 7070 696e 6720 666f 7220 7468 6520  rapping for the 
+000050e0: 6361 7573 6520 7661 7269 6162 6c65 2e20  cause variable. 
+000050f0: 4465 6661 756c 7473 2074 6f20 4e6f 6e65  Defaults to None
+00005100: 2e0d 0a20 2020 2020 2020 206d 6f64 6520  ...        mode 
+00005110: 2873 7472 2c20 6f70 7469 6f6e 616c 293a  (str, optional):
+00005120: 2041 2073 7472 696e 6720 696e 6469 6361   A string indica
+00005130: 7469 6e67 2074 6865 2062 6f6f 7473 7472  ting the bootstr
+00005140: 6170 7069 6e67 206d 6f64 652e 2049 7420  apping mode. It 
+00005150: 6361 6e20 6265 2065 6974 6865 7220 2766  can be either 'f
+00005160: 6173 7427 206f 7220 2772 6f62 7573 7427  ast' or 'robust'
+00005170: 2064 6570 656e 6469 6e67 206f 6e20 7468   depending on th
+00005180: 6520 696d 706c 656d 656e 7461 7469 6f6e  e implementation
+00005190: 2e20 4465 6661 756c 7420 6973 2027 6661  . Default is 'fa
+000051a0: 7374 272e 0d0a 2020 2020 2020 2020 0d0a  st'...        ..
+000051b0: 2020 2020 5265 7475 726e 733a 0d0a 2020      Returns:..  
+000051c0: 2020 2020 2020 6469 6374 3a20 4120 6469        dict: A di
+000051d0: 6374 696f 6e61 7279 2063 6f6e 7461 696e  ctionary contain
+000051e0: 696e 6720 7661 7269 6162 6c65 206e 616d  ing variable nam
+000051f0: 6573 2061 7320 6b65 7973 2061 6e64 2074  es as keys and t
+00005200: 6865 6972 2063 6f72 7265 7370 6f6e 6469  heir correspondi
+00005210: 6e67 2064 652d 636f 6e66 6f75 6e64 6564  ng de-confounded
+00005220: 2064 6174 6120 6172 7261 7973 2061 7320   data arrays as 
+00005230: 7661 6c75 6573 2e0d 0a20 2020 2022 2222  values...    """
+00005240: 0d0a 2020 2020 0d0a 2020 2020 6361 7573  ..    ..    caus
+00005250: 655f 7661 725f 6e61 6d65 203d 206c 6973  e_var_name = lis
+00005260: 7428 6361 7573 655f 6461 7461 2e6b 6579  t(cause_data.key
+00005270: 7328 2929 5b30 5d0d 0a20 2020 2065 6666  s())[0]..    eff
+00005280: 6563 745f 7661 725f 6e61 6d65 203d 206c  ect_var_name = l
+00005290: 6973 7428 6566 6665 6374 5f64 6174 612e  ist(effect_data.
+000052a0: 6b65 7973 2829 295b 305d 0d0a 2020 2020  keys())[0]..    
+000052b0: 636f 6e66 6f75 6e64 6572 5f76 6172 5f6e  confounder_var_n
+000052c0: 616d 6520 3d20 6c69 7374 2863 6f6e 666f  ame = list(confo
+000052d0: 756e 6465 725f 6461 7461 2e6b 6579 7328  under_data.keys(
+000052e0: 2929 5b30 5d0d 0a20 2020 200d 0a20 2020  ))[0]..    ..   
+000052f0: 2064 6174 6120 3d20 6361 7573 655f 6461   data = cause_da
+00005300: 7461 2e63 6f70 7928 290d 0a20 2020 2064  ta.copy()..    d
+00005310: 6174 612e 7570 6461 7465 2865 6666 6563  ata.update(effec
+00005320: 745f 6461 7461 290d 0a20 2020 2064 6174  t_data)..    dat
+00005330: 612e 7570 6461 7465 2863 6f6e 666f 756e  a.update(confoun
+00005340: 6465 725f 6461 7461 290d 0a20 2020 200d  der_data)..    .
+00005350: 0a20 2020 2063 6175 7361 6c5f 6772 6170  .    causal_grap
+00005360: 6820 3d20 6361 7573 655f 7661 725f 6e61  h = cause_var_na
+00005370: 6d65 202b 2022 3b22 202b 2065 6666 6563  me + ";" + effec
+00005380: 745f 7661 725f 6e61 6d65 202b 2022 3b22  t_var_name + ";"
+00005390: 202b 2063 6f6e 666f 756e 6465 725f 7661   + confounder_va
+000053a0: 725f 6e61 6d65 202b 2022 3b20 5c6e 220d  r_name + "; \n".
+000053b0: 0a20 2020 2063 6175 7361 6c5f 6772 6170  .    causal_grap
+000053c0: 6820 3d20 6361 7573 616c 5f67 7261 7068  h = causal_graph
+000053d0: 202b 2063 6175 7365 5f76 6172 5f6e 616d   + cause_var_nam
+000053e0: 6520 2b20 222d 3e22 202b 2065 6666 6563  e + "->" + effec
+000053f0: 745f 7661 725f 6e61 6d65 202b 2022 3b20  t_var_name + "; 
+00005400: 5c6e 220d 0a20 2020 2063 6175 7361 6c5f  \n"..    causal_
+00005410: 6772 6170 6820 3d20 6361 7573 616c 5f67  graph = causal_g
+00005420: 7261 7068 202b 2063 6f6e 666f 756e 6465  raph + confounde
+00005430: 725f 7661 725f 6e61 6d65 202b 2022 2d3e  r_var_name + "->
+00005440: 2220 2b20 6566 6665 6374 5f76 6172 5f6e  " + effect_var_n
+00005450: 616d 6520 2b20 223b 205c 6e22 0d0a 2020  ame + "; \n"..  
+00005460: 2020 6361 7573 616c 5f67 7261 7068 203d    causal_graph =
+00005470: 2063 6175 7361 6c5f 6772 6170 6820 2b20   causal_graph + 
+00005480: 636f 6e66 6f75 6e64 6572 5f76 6172 5f6e  confounder_var_n
+00005490: 616d 6520 2b20 222d 3e22 202b 2063 6175  ame + "->" + cau
+000054a0: 7365 5f76 6172 5f6e 616d 6520 2b20 223b  se_var_name + ";
+000054b0: 205c 6e22 0d0a 2020 2020 0d0a 2020 2020   \n"..    ..    
+000054c0: 7765 6967 6874 5f66 756e 635f 6c61 6d2c  weight_func_lam,
+000054d0: 2077 6569 6768 745f 6675 6e63 5f73 7472   weight_func_str
+000054e0: 203d 2067 656e 6572 616c 5f63 625f 616e   = general_cb_an
+000054f0: 616c 7973 6973 2863 6175 7361 6c5f 6772  alysis(causal_gr
+00005500: 6170 6820 3d20 6361 7573 616c 5f67 7261  aph = causal_gra
+00005510: 7068 2c20 0d0a 2020 2020 2020 2020 2020  ph, ..          
 00005520: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005540: 2020 2020 2020 2020 2020 206b 6572 6e65             kerne
-00005550: 6c20 3d20 6b65 726e 656c 5f69 6e74 762c  l = kernel_intv,
-00005560: 206d 6f64 6520 3d20 6d6f 6465 290d 0a0d   mode = mode)...
-00005570: 0a20 2020 2072 6574 7572 6e20 6362 5f64  .    return cb_d
-00005580: 6174 610d 0a0d 0a64 6566 2062 6163 6b64  ata....def backd
-00005590: 6f6f 725f 7369 6d75 2863 6175 7365 5f64  oor_simu(cause_d
-000055a0: 6174 612c 2065 6666 6563 745f 6461 7461  ata, effect_data
-000055b0: 2c20 636f 6e66 6f75 6e64 6572 5f64 6174  , confounder_dat
-000055c0: 612c 2064 6973 745f 6d61 702c 2069 6e74  a, dist_map, int
-000055d0: 765f 7661 6c75 652c 206e 5f73 616d 706c  v_value, n_sampl
-000055e0: 652c 206b 6572 6e65 6c5f 696e 7476 203d  e, kernel_intv =
-000055f0: 204e 6f6e 652c 206d 6f64 6520 3d20 2266   None, mode = "f
-00005600: 6173 7422 293a 0d0a 2020 2020 2222 220d  ast"):..    """.
-00005610: 0a20 2020 2050 6572 666f 726d 2073 696d  .    Perform sim
-00005620: 756c 6174 696f 6e61 6c20 6261 636b 646f  ulational backdo
-00005630: 6f72 2063 6175 7361 6c20 626f 6f74 7374  or causal bootst
-00005640: 7261 7070 696e 6720 746f 2064 652d 636f  rapping to de-co
-00005650: 6e66 6f75 6e64 2074 6865 2063 6175 7361  nfound the causa
-00005660: 6c20 6566 6665 6374 2075 7369 6e67 2074  l effect using t
-00005670: 6865 2070 726f 7669 6465 6420 0d0a 2020  he provided ..  
-00005680: 2020 6f62 7365 7276 6174 696f 6e61 6c20    observational 
-00005690: 6461 7461 2061 6e64 2064 6973 7472 6962  data and distrib
-000056a0: 7574 696f 6e20 6d61 7073 2e0d 0a0d 0a20  ution maps..... 
-000056b0: 2020 2050 6172 616d 6574 6572 733a 0d0a     Parameters:..
-000056c0: 2020 2020 2020 2020 6361 7573 655f 6461          cause_da
-000056d0: 7461 2028 6469 6374 293a 2041 2064 6963  ta (dict): A dic
-000056e0: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
-000056f0: 6e67 2074 6865 2063 6175 7365 2076 6172  ng the cause var
-00005700: 6961 626c 6520 6e61 6d65 2061 7320 6120  iable name as a 
-00005710: 6b65 7920 616e 6420 6974 7320 6461 7461  key and its data
-00005720: 2061 7272 6179 2061 7320 7468 6520 7661   array as the va
-00005730: 6c75 652e 0d0a 2020 2020 2020 2020 6566  lue...        ef
-00005740: 6665 6374 5f64 6174 6120 2864 6963 7429  fect_data (dict)
-00005750: 3a20 4120 6469 6374 696f 6e61 7279 2063  : A dictionary c
-00005760: 6f6e 7461 696e 696e 6720 7468 6520 6566  ontaining the ef
-00005770: 6665 6374 2076 6172 6961 626c 6520 6e61  fect variable na
-00005780: 6d65 2061 7320 6120 6b65 7920 616e 6420  me as a key and 
-00005790: 6974 7320 6461 7461 2061 7272 6179 2061  its data array a
-000057a0: 7320 7468 6520 7661 6c75 652e 0d0a 2020  s the value...  
-000057b0: 2020 2020 2020 636f 6e66 6f75 6e64 6572        confounder
-000057c0: 5f64 6174 6120 2864 6963 7429 3a20 4120  _data (dict): A 
-000057d0: 6469 6374 696f 6e61 7279 2063 6f6e 7461  dictionary conta
-000057e0: 696e 696e 6720 7468 6520 636f 6e66 6f75  ining the confou
-000057f0: 6e64 6572 2076 6172 6961 626c 6520 6e61  nder variable na
-00005800: 6d65 2061 7320 6120 6b65 7920 616e 6420  me as a key and 
-00005810: 6974 7320 6461 7461 2061 7272 6179 2061  its data array a
-00005820: 7320 7468 6520 7661 6c75 652e 0d0a 2020  s the value...  
-00005830: 2020 2020 2020 6469 7374 5f6d 6170 2028        dist_map (
-00005840: 6469 6374 293a 2041 2064 6963 7469 6f6e  dict): A diction
-00005850: 6172 7920 6d61 7070 696e 6720 7475 706c  ary mapping tupl
-00005860: 6573 206f 6620 7661 7269 6162 6c65 2063  es of variable c
-00005870: 6f6d 6269 6e61 7469 6f6e 7320 746f 2074  ombinations to t
-00005880: 6865 6972 2063 6f72 7265 7370 6f6e 6469  heir correspondi
-00005890: 6e67 2064 6973 7472 6962 7574 696f 6e20  ng distribution 
-000058a0: 6675 6e63 7469 6f6e 732e 0d0a 2020 2020  functions...    
-000058b0: 2020 2020 696e 7476 5f76 616c 7565 2028      intv_value (
-000058c0: 6c69 7374 293a 2041 206c 6973 7420 636f  list): A list co
-000058d0: 6e74 6169 6e69 6e67 2074 6865 2069 6e74  ntaining the int
-000058e0: 6572 7665 6e74 696f 6e61 6c20 7661 6c75  erventional valu
-000058f0: 652e 0d0a 2020 2020 2020 2020 6e5f 7361  e...        n_sa
-00005900: 6d70 6c65 2028 696e 7429 3a20 5468 6520  mple (int): The 
-00005910: 6e75 6d62 6572 206f 6620 7361 6d70 6c65  number of sample
-00005920: 7320 746f 2062 6520 6765 6e65 7261 7465  s to be generate
-00005930: 6420 7468 726f 7567 6820 626f 6f74 7374  d through bootst
-00005940: 7261 7070 696e 672e 0d0a 2020 2020 2020  rapping...      
-00005950: 2020 6b65 726e 656c 5f69 6e74 7620 2866    kernel_intv (f
-00005960: 756e 6374 696f 6e2c 206f 7074 696f 6e61  unction, optiona
-00005970: 6c29 3a20 5468 6520 6b65 726e 656c 2066  l): The kernel f
-00005980: 756e 6374 696f 6e20 746f 2062 6520 7573  unction to be us
-00005990: 6564 2069 6e20 7468 6520 6261 636b 646f  ed in the backdo
-000059a0: 6f72 2061 646a 7573 746d 656e 7420 666f  or adjustment fo
-000059b0: 7220 7468 6520 6361 7573 6520 7661 7269  r the cause vari
-000059c0: 6162 6c65 2e20 4465 6661 756c 7473 2074  able. Defaults t
-000059d0: 6f20 4e6f 6e65 2e0d 0a20 2020 2020 2020  o None...       
-000059e0: 206d 6f64 6520 2873 7472 2c20 6f70 7469   mode (str, opti
-000059f0: 6f6e 616c 293a 2041 2073 7472 696e 6720  onal): A string 
-00005a00: 696e 6469 6361 7469 6e67 2074 6865 2062  indicating the b
-00005a10: 6f6f 7473 7472 6170 7069 6e67 206d 6f64  ootstrapping mod
-00005a20: 652e 2049 7420 6361 6e20 6265 2065 6974  e. It can be eit
-00005a30: 6865 7220 2766 6173 7427 206f 7220 2772  her 'fast' or 'r
-00005a40: 6f62 7573 7427 2064 6570 656e 6469 6e67  obust' depending
-00005a50: 206f 6e20 7468 6520 696d 706c 656d 656e   on the implemen
-00005a60: 7461 7469 6f6e 2e20 4465 6661 756c 7420  tation. Default 
-00005a70: 6973 2027 6661 7374 272e 0d0a 2020 2020  is 'fast'...    
-00005a80: 2020 2020 0d0a 2020 2020 5265 7475 726e      ..    Return
-00005a90: 733a 0d0a 2020 2020 2020 2020 6469 6374  s:..        dict
-00005aa0: 3a20 4120 6469 6374 696f 6e61 7279 2063  : A dictionary c
-00005ab0: 6f6e 7461 696e 696e 6720 7661 7269 6162  ontaining variab
-00005ac0: 6c65 206e 616d 6573 2061 7320 6b65 7973  le names as keys
-00005ad0: 2061 6e64 2074 6865 6972 2063 6f72 7265   and their corre
-00005ae0: 7370 6f6e 6469 6e67 2064 652d 636f 6e66  sponding de-conf
-00005af0: 6f75 6e64 6564 2064 6174 6120 6172 7261  ounded data arra
-00005b00: 7973 2061 7320 7661 6c75 6573 2e0d 0a20  ys as values... 
-00005b10: 2020 2022 2222 0d0a 2009 0d0a 2020 2020     """.. ...    
-00005b20: 6361 7573 655f 7661 725f 6e61 6d65 203d  cause_var_name =
-00005b30: 206c 6973 7428 6361 7573 655f 6461 7461   list(cause_data
-00005b40: 2e6b 6579 7328 2929 5b30 5d0d 0a20 2020  .keys())[0]..   
-00005b50: 2065 6666 6563 745f 7661 725f 6e61 6d65   effect_var_name
-00005b60: 203d 206c 6973 7428 6566 6665 6374 5f64   = list(effect_d
-00005b70: 6174 612e 6b65 7973 2829 295b 305d 0d0a  ata.keys())[0]..
-00005b80: 2020 2020 636f 6e66 6f75 6e64 6572 5f76      confounder_v
-00005b90: 6172 5f6e 616d 6520 3d20 6c69 7374 2863  ar_name = list(c
-00005ba0: 6f6e 666f 756e 6465 725f 6461 7461 2e6b  onfounder_data.k
-00005bb0: 6579 7328 2929 5b30 5d0d 0a20 2020 200d  eys())[0]..    .
-00005bc0: 0a20 2020 2064 6174 6120 3d20 6361 7573  .    data = caus
-00005bd0: 655f 6461 7461 2e63 6f70 7928 290d 0a20  e_data.copy().. 
-00005be0: 2020 2064 6174 612e 7570 6461 7465 2865     data.update(e
-00005bf0: 6666 6563 745f 6461 7461 290d 0a20 2020  ffect_data)..   
-00005c00: 2064 6174 612e 7570 6461 7465 2863 6f6e   data.update(con
-00005c10: 666f 756e 6465 725f 6461 7461 290d 0a20  founder_data).. 
-00005c20: 2020 200d 0a20 2020 2063 6175 7361 6c5f     ..    causal_
-00005c30: 6772 6170 6820 3d20 6361 7573 655f 7661  graph = cause_va
-00005c40: 725f 6e61 6d65 202b 2022 3b22 202b 2065  r_name + ";" + e
-00005c50: 6666 6563 745f 7661 725f 6e61 6d65 202b  ffect_var_name +
-00005c60: 2022 3b22 202b 2063 6f6e 666f 756e 6465   ";" + confounde
-00005c70: 725f 7661 725f 6e61 6d65 202b 2022 3b20  r_var_name + "; 
-00005c80: 5c6e 220d 0a20 2020 2063 6175 7361 6c5f  \n"..    causal_
-00005c90: 6772 6170 6820 3d20 6361 7573 616c 5f67  graph = causal_g
-00005ca0: 7261 7068 202b 2063 6175 7365 5f76 6172  raph + cause_var
-00005cb0: 5f6e 616d 6520 2b20 222d 3e22 202b 2065  _name + "->" + e
-00005cc0: 6666 6563 745f 7661 725f 6e61 6d65 202b  ffect_var_name +
-00005cd0: 2022 3b20 5c6e 220d 0a20 2020 2063 6175   "; \n"..    cau
-00005ce0: 7361 6c5f 6772 6170 6820 3d20 6361 7573  sal_graph = caus
-00005cf0: 616c 5f67 7261 7068 202b 2063 6f6e 666f  al_graph + confo
-00005d00: 756e 6465 725f 7661 725f 6e61 6d65 202b  under_var_name +
-00005d10: 2022 2d3e 2220 2b20 6566 6665 6374 5f76   "->" + effect_v
-00005d20: 6172 5f6e 616d 6520 2b20 223b 205c 6e22  ar_name + "; \n"
-00005d30: 0d0a 2020 2020 6361 7573 616c 5f67 7261  ..    causal_gra
-00005d40: 7068 203d 2063 6175 7361 6c5f 6772 6170  ph = causal_grap
-00005d50: 6820 2b20 636f 6e66 6f75 6e64 6572 5f76  h + confounder_v
-00005d60: 6172 5f6e 616d 6520 2b20 222d 3e22 202b  ar_name + "->" +
-00005d70: 2063 6175 7365 5f76 6172 5f6e 616d 6520   cause_var_name 
-00005d80: 2b20 223b 205c 6e22 0d0a 2020 2020 0d0a  + "; \n"..    ..
-00005d90: 2020 2020 7765 6967 6874 5f66 756e 635f      weight_func_
-00005da0: 6c61 6d2c 2077 6569 6768 745f 6675 6e63  lam, weight_func
-00005db0: 5f73 7472 203d 2067 656e 6572 616c 5f63  _str = general_c
-00005dc0: 625f 616e 616c 7973 6973 2863 6175 7361  b_analysis(causa
-00005dd0: 6c5f 6772 6170 6820 3d20 6361 7573 616c  l_graph = causal
-00005de0: 5f67 7261 7068 2c20 0d0a 2020 2020 2020  _graph, ..      
-00005df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e20: 2020 2020 2065 6666 6563 745f 7661 725f       effect_var_
-00005e30: 6e61 6d65 203d 2065 6666 6563 745f 7661  name = effect_va
-00005e40: 725f 6e61 6d65 2c20 0d0a 2020 2020 2020  r_name, ..      
-00005e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e80: 2020 2020 2063 6175 7365 5f76 6172 5f6e       cause_var_n
-00005e90: 616d 6520 3d20 6361 7573 655f 7661 725f  ame = cause_var_
-00005ea0: 6e61 6d65 2c20 696e 666f 5f70 7269 6e74  name, info_print
-00005eb0: 3d20 4661 6c73 6529 0d0a 2020 2020 0d0a  = False)..    ..
-00005ec0: 2020 2020 6966 206b 6572 6e65 6c5f 696e      if kernel_in
-00005ed0: 7476 2069 7320 4e6f 6e65 3a0d 0a20 2020  tv is None:..   
-00005ee0: 2020 2020 2069 6e74 765f 7661 725f 6e61       intv_var_na
-00005ef0: 6d65 203d 2022 696e 7476 5f22 202b 2063  me = "intv_" + c
-00005f00: 6175 7365 5f76 6172 5f6e 616d 650d 0a20  ause_var_name.. 
-00005f10: 2020 2020 2020 206b 6572 6e65 6c5f 696e         kernel_in
-00005f20: 7476 203d 2065 7661 6c28 226c 616d 6264  tv = eval("lambd
-00005f30: 6120 222b 696e 7476 5f76 6172 5f6e 616d  a "+intv_var_nam
-00005f40: 652b 222c 222b 6361 7573 655f 7661 725f  e+","+cause_var_
-00005f50: 6e61 6d65 2b22 3a20 3120 6966 2022 2b69  name+": 1 if "+i
-00005f60: 6e74 765f 7661 725f 6e61 6d65 2b22 3d3d  ntv_var_name+"==
-00005f70: 2220 2b20 6361 7573 655f 7661 725f 6e61  " + cause_var_na
-00005f80: 6d65 202b 2022 2065 6c73 6520 3022 290d  me + " else 0").
-00005f90: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
-00005fa0: 2020 2020 6b65 726e 656c 5f70 6172 616d      kernel_param
-00005fb0: 7320 3d20 7365 7428 696e 7370 6563 742e  s = set(inspect.
-00005fc0: 7369 676e 6174 7572 6528 6b65 726e 656c  signature(kernel
-00005fd0: 5f69 6e74 7629 2e70 6172 616d 6574 6572  _intv).parameter
-00005fe0: 732e 6b65 7973 2829 290d 0a20 2020 2020  s.keys())..     
-00005ff0: 2020 2069 6e74 765f 7661 725f 6e61 6d65     intv_var_name
-00006000: 203d 206c 6973 7428 6b65 726e 656c 5f70   = list(kernel_p
-00006010: 6172 616d 7320 2d20 7365 7428 6461 7461  arams - set(data
-00006020: 2e6b 6579 7328 2929 290d 0a20 2020 2020  .keys()))..     
-00006030: 2020 2069 6620 6c65 6e28 696e 7476 5f76     if len(intv_v
-00006040: 6172 5f6e 616d 6529 203d 3d20 303a 0d0a  ar_name) == 0:..
-00006050: 2020 2020 2020 2020 2020 2020 696e 7476              intv
-00006060: 5f76 6172 5f6e 616d 6520 3d20 2269 6e74  _var_name = "int
-00006070: 765f 2220 2b20 6361 7573 655f 7661 725f  v_" + cause_var_
-00006080: 6e61 6d65 0d0a 2020 2020 2020 2020 656c  name..        el
-00006090: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000060a0: 2069 6e74 765f 7661 725f 6e61 6d65 203d   intv_var_name =
-000060b0: 2069 6e74 765f 7661 725f 6e61 6d65 5b30   intv_var_name[0
-000060c0: 5d0d 0a20 2020 2063 625f 6461 7461 203d  ]..    cb_data =
-000060d0: 2067 656e 6572 616c 5f63 6175 7361 6c5f   general_causal_
-000060e0: 626f 6f74 7374 7261 7070 696e 675f 7369  bootstrapping_si
-000060f0: 6d75 2877 6569 6768 745f 6675 6e63 5f6c  mu(weight_func_l
-00006100: 616d 203d 2077 6569 6768 745f 6675 6e63  am = weight_func
-00006110: 5f6c 616d 2c20 0d0a 2020 2020 2020 2020  _lam, ..        
-00006120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006140: 2020 2020 2020 2020 6469 7374 5f6d 6170          dist_map
-00006150: 203d 2064 6973 745f 6d61 702c 2064 6174   = dist_map, dat
-00006160: 6120 3d20 6461 7461 2c20 0d0a 2020 2020  a = data, ..    
-00006170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006190: 2020 2020 2020 2020 2020 2020 696e 7476              intv
-000061a0: 5f76 6172 5f76 616c 7565 203d 207b 696e  _var_value = {in
-000061b0: 7476 5f76 6172 5f6e 616d 653a 2069 6e74  tv_var_name: int
-000061c0: 765f 7661 6c75 657d 2c20 0d0a 2020 2020  v_value}, ..    
+00005540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005550: 2065 6666 6563 745f 7661 725f 6e61 6d65   effect_var_name
+00005560: 203d 2065 6666 6563 745f 7661 725f 6e61   = effect_var_na
+00005570: 6d65 2c20 0d0a 2020 2020 2020 2020 2020  me, ..          
+00005580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000055a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000055b0: 2063 6175 7365 5f76 6172 5f6e 616d 6520   cause_var_name 
+000055c0: 3d20 6361 7573 655f 7661 725f 6e61 6d65  = cause_var_name
+000055d0: 2c20 696e 666f 5f70 7269 6e74 3d20 4661  , info_print= Fa
+000055e0: 6c73 6529 0d0a 2020 2020 0d0a 2020 2020  lse)..    ..    
+000055f0: 6966 206b 6572 6e65 6c5f 696e 7476 2069  if kernel_intv i
+00005600: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+00005610: 2069 6e74 765f 7661 725f 6e61 6d65 203d   intv_var_name =
+00005620: 2022 696e 7476 5f22 202b 2063 6175 7365   "intv_" + cause
+00005630: 5f76 6172 5f6e 616d 650d 0a20 2020 2020  _var_name..     
+00005640: 2020 206b 6572 6e65 6c5f 696e 7476 203d     kernel_intv =
+00005650: 2065 7661 6c28 226c 616d 6264 6120 222b   eval("lambda "+
+00005660: 696e 7476 5f76 6172 5f6e 616d 652b 222c  intv_var_name+",
+00005670: 222b 6361 7573 655f 7661 725f 6e61 6d65  "+cause_var_name
+00005680: 2b22 3a20 3120 6966 2022 2b69 6e74 765f  +": 1 if "+intv_
+00005690: 7661 725f 6e61 6d65 2b22 3d3d 2220 2b20  var_name+"==" + 
+000056a0: 6361 7573 655f 7661 725f 6e61 6d65 202b  cause_var_name +
+000056b0: 2022 2065 6c73 6520 3022 290d 0a20 2020   " else 0")..   
+000056c0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+000056d0: 6b65 726e 656c 5f70 6172 616d 7320 3d20  kernel_params = 
+000056e0: 7365 7428 696e 7370 6563 742e 7369 676e  set(inspect.sign
+000056f0: 6174 7572 6528 6b65 726e 656c 5f69 6e74  ature(kernel_int
+00005700: 7629 2e70 6172 616d 6574 6572 732e 6b65  v).parameters.ke
+00005710: 7973 2829 290d 0a20 2020 2020 2020 2069  ys())..        i
+00005720: 6e74 765f 7661 725f 6e61 6d65 203d 206c  ntv_var_name = l
+00005730: 6973 7428 6b65 726e 656c 5f70 6172 616d  ist(kernel_param
+00005740: 7320 2d20 7365 7428 6461 7461 2e6b 6579  s - set(data.key
+00005750: 7328 2929 290d 0a20 2020 2020 2020 2069  s()))..        i
+00005760: 6620 6c65 6e28 696e 7476 5f76 6172 5f6e  f len(intv_var_n
+00005770: 616d 6529 203d 3d20 303a 0d0a 2020 2020  ame) == 0:..    
+00005780: 2020 2020 2020 2020 696e 7476 5f76 6172          intv_var
+00005790: 5f6e 616d 6520 3d20 2269 6e74 765f 2220  _name = "intv_" 
+000057a0: 2b20 6361 7573 655f 7661 725f 6e61 6d65  + cause_var_name
+000057b0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+000057c0: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
+000057d0: 765f 7661 725f 6e61 6d65 203d 2069 6e74  v_var_name = int
+000057e0: 765f 7661 725f 6e61 6d65 5b30 5d0d 0a20  v_var_name[0].. 
+000057f0: 2020 2063 625f 6461 7461 203d 2067 656e     cb_data = gen
+00005800: 6572 616c 5f63 6175 7361 6c5f 626f 6f74  eral_causal_boot
+00005810: 7374 7261 7070 696e 675f 7369 6d70 6c65  strapping_simple
+00005820: 2877 6569 6768 745f 6675 6e63 5f6c 616d  (weight_func_lam
+00005830: 203d 2077 6569 6768 745f 6675 6e63 5f6c   = weight_func_l
+00005840: 616d 2c20 0d0a 2020 2020 2020 2020 2020  am, ..          
+00005850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005870: 2020 2020 2020 2020 6469 7374 5f6d 6170          dist_map
+00005880: 203d 2064 6973 745f 6d61 702c 2064 6174   = dist_map, dat
+00005890: 6120 3d20 6461 7461 2c20 0d0a 2020 2020  a = data, ..    
+000058a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058c0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000058d0: 7476 5f76 6172 5f6e 616d 6520 3d20 6361  tv_var_name = ca
+000058e0: 7573 655f 7661 725f 6e61 6d65 2c20 0d0a  use_var_name, ..
+000058f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005920: 2020 6b65 726e 656c 203d 206b 6572 6e65    kernel = kerne
+00005930: 6c5f 696e 7476 2c20 6d6f 6465 203d 206d  l_intv, mode = m
+00005940: 6f64 6529 0d0a 0d0a 2020 2020 7265 7475  ode)....    retu
+00005950: 726e 2063 625f 6461 7461 0d0a 0d0a 6465  rn cb_data....de
+00005960: 6620 6261 636b 646f 6f72 5f73 696d 7528  f backdoor_simu(
+00005970: 6361 7573 655f 6461 7461 2c20 6566 6665  cause_data, effe
+00005980: 6374 5f64 6174 612c 2063 6f6e 666f 756e  ct_data, confoun
+00005990: 6465 725f 6461 7461 2c20 6469 7374 5f6d  der_data, dist_m
+000059a0: 6170 2c20 696e 7476 5f76 616c 7565 2c20  ap, intv_value, 
+000059b0: 6e5f 7361 6d70 6c65 2c20 6b65 726e 656c  n_sample, kernel
+000059c0: 5f69 6e74 7620 3d20 4e6f 6e65 2c20 6d6f  _intv = None, mo
+000059d0: 6465 203d 2022 6661 7374 2229 3a0d 0a20  de = "fast"):.. 
+000059e0: 2020 2022 2222 0d0a 2020 2020 5065 7266     """..    Perf
+000059f0: 6f72 6d20 7369 6d75 6c61 7469 6f6e 616c  orm simulational
+00005a00: 2062 6163 6b64 6f6f 7220 6361 7573 616c   backdoor causal
+00005a10: 2062 6f6f 7473 7472 6170 7069 6e67 2074   bootstrapping t
+00005a20: 6f20 6465 2d63 6f6e 666f 756e 6420 7468  o de-confound th
+00005a30: 6520 6361 7573 616c 2065 6666 6563 7420  e causal effect 
+00005a40: 7573 696e 6720 7468 6520 7072 6f76 6964  using the provid
+00005a50: 6564 200d 0a20 2020 206f 6273 6572 7661  ed ..    observa
+00005a60: 7469 6f6e 616c 2064 6174 6120 616e 6420  tional data and 
+00005a70: 6469 7374 7269 6275 7469 6f6e 206d 6170  distribution map
+00005a80: 732e 0d0a 0d0a 2020 2020 5061 7261 6d65  s.....    Parame
+00005a90: 7465 7273 3a0d 0a20 2020 2020 2020 2063  ters:..        c
+00005aa0: 6175 7365 5f64 6174 6120 2864 6963 7429  ause_data (dict)
+00005ab0: 3a20 4120 6469 6374 696f 6e61 7279 2063  : A dictionary c
+00005ac0: 6f6e 7461 696e 696e 6720 7468 6520 6361  ontaining the ca
+00005ad0: 7573 6520 7661 7269 6162 6c65 206e 616d  use variable nam
+00005ae0: 6520 6173 2061 206b 6579 2061 6e64 2069  e as a key and i
+00005af0: 7473 2064 6174 6120 6172 7261 7920 6173  ts data array as
+00005b00: 2074 6865 2076 616c 7565 2e0d 0a20 2020   the value...   
+00005b10: 2020 2020 2065 6666 6563 745f 6461 7461       effect_data
+00005b20: 2028 6469 6374 293a 2041 2064 6963 7469   (dict): A dicti
+00005b30: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
+00005b40: 2074 6865 2065 6666 6563 7420 7661 7269   the effect vari
+00005b50: 6162 6c65 206e 616d 6520 6173 2061 206b  able name as a k
+00005b60: 6579 2061 6e64 2069 7473 2064 6174 6120  ey and its data 
+00005b70: 6172 7261 7920 6173 2074 6865 2076 616c  array as the val
+00005b80: 7565 2e0d 0a20 2020 2020 2020 2063 6f6e  ue...        con
+00005b90: 666f 756e 6465 725f 6461 7461 2028 6469  founder_data (di
+00005ba0: 6374 293a 2041 2064 6963 7469 6f6e 6172  ct): A dictionar
+00005bb0: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
+00005bc0: 2063 6f6e 666f 756e 6465 7220 7661 7269   confounder vari
+00005bd0: 6162 6c65 206e 616d 6520 6173 2061 206b  able name as a k
+00005be0: 6579 2061 6e64 2069 7473 2064 6174 6120  ey and its data 
+00005bf0: 6172 7261 7920 6173 2074 6865 2076 616c  array as the val
+00005c00: 7565 2e0d 0a20 2020 2020 2020 2064 6973  ue...        dis
+00005c10: 745f 6d61 7020 2864 6963 7429 3a20 4120  t_map (dict): A 
+00005c20: 6469 6374 696f 6e61 7279 206d 6170 7069  dictionary mappi
+00005c30: 6e67 2074 7570 6c65 7320 6f66 2076 6172  ng tuples of var
+00005c40: 6961 626c 6520 636f 6d62 696e 6174 696f  iable combinatio
+00005c50: 6e73 2074 6f20 7468 6569 7220 636f 7272  ns to their corr
+00005c60: 6573 706f 6e64 696e 6720 6469 7374 7269  esponding distri
+00005c70: 6275 7469 6f6e 2066 756e 6374 696f 6e73  bution functions
+00005c80: 2e0d 0a20 2020 2020 2020 2069 6e74 765f  ...        intv_
+00005c90: 7661 6c75 6520 286c 6973 7429 3a20 4120  value (list): A 
+00005ca0: 6c69 7374 2063 6f6e 7461 696e 696e 6720  list containing 
+00005cb0: 7468 6520 696e 7465 7276 656e 7469 6f6e  the intervention
+00005cc0: 616c 2076 616c 7565 2e0d 0a20 2020 2020  al value...     
+00005cd0: 2020 206e 5f73 616d 706c 6520 2869 6e74     n_sample (int
+00005ce0: 293a 2054 6865 206e 756d 6265 7220 6f66  ): The number of
+00005cf0: 2073 616d 706c 6573 2074 6f20 6265 2067   samples to be g
+00005d00: 656e 6572 6174 6564 2074 6872 6f75 6768  enerated through
+00005d10: 2062 6f6f 7473 7472 6170 7069 6e67 2e0d   bootstrapping..
+00005d20: 0a20 2020 2020 2020 206b 6572 6e65 6c5f  .        kernel_
+00005d30: 696e 7476 2028 6675 6e63 7469 6f6e 2c20  intv (function, 
+00005d40: 6f70 7469 6f6e 616c 293a 2054 6865 206b  optional): The k
+00005d50: 6572 6e65 6c20 6675 6e63 7469 6f6e 2074  ernel function t
+00005d60: 6f20 6265 2075 7365 6420 696e 2074 6865  o be used in the
+00005d70: 2062 6163 6b64 6f6f 7220 6164 6a75 7374   backdoor adjust
+00005d80: 6d65 6e74 2066 6f72 2074 6865 2063 6175  ment for the cau
+00005d90: 7365 2076 6172 6961 626c 652e 2044 6566  se variable. Def
+00005da0: 6175 6c74 7320 746f 204e 6f6e 652e 0d0a  aults to None...
+00005db0: 2020 2020 2020 2020 6d6f 6465 2028 7374          mode (st
+00005dc0: 722c 206f 7074 696f 6e61 6c29 3a20 4120  r, optional): A 
+00005dd0: 7374 7269 6e67 2069 6e64 6963 6174 696e  string indicatin
+00005de0: 6720 7468 6520 626f 6f74 7374 7261 7070  g the bootstrapp
+00005df0: 696e 6720 6d6f 6465 2e20 4974 2063 616e  ing mode. It can
+00005e00: 2062 6520 6569 7468 6572 2027 6661 7374   be either 'fast
+00005e10: 2720 6f72 2027 726f 6275 7374 2720 6465  ' or 'robust' de
+00005e20: 7065 6e64 696e 6720 6f6e 2074 6865 2069  pending on the i
+00005e30: 6d70 6c65 6d65 6e74 6174 696f 6e2e 2044  mplementation. D
+00005e40: 6566 6175 6c74 2069 7320 2766 6173 7427  efault is 'fast'
+00005e50: 2e0d 0a20 2020 2020 2020 200d 0a20 2020  ...        ..   
+00005e60: 2052 6574 7572 6e73 3a0d 0a20 2020 2020   Returns:..     
+00005e70: 2020 2064 6963 743a 2041 2064 6963 7469     dict: A dicti
+00005e80: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
+00005e90: 2076 6172 6961 626c 6520 6e61 6d65 7320   variable names 
+00005ea0: 6173 206b 6579 7320 616e 6420 7468 6569  as keys and thei
+00005eb0: 7220 636f 7272 6573 706f 6e64 696e 6720  r corresponding 
+00005ec0: 6465 2d63 6f6e 666f 756e 6465 6420 6461  de-confounded da
+00005ed0: 7461 2061 7272 6179 7320 6173 2076 616c  ta arrays as val
+00005ee0: 7565 732e 0d0a 2020 2020 2222 220d 0a20  ues...    """.. 
+00005ef0: 090d 0a20 2020 2063 6175 7365 5f76 6172  ...    cause_var
+00005f00: 5f6e 616d 6520 3d20 6c69 7374 2863 6175  _name = list(cau
+00005f10: 7365 5f64 6174 612e 6b65 7973 2829 295b  se_data.keys())[
+00005f20: 305d 0d0a 2020 2020 6566 6665 6374 5f76  0]..    effect_v
+00005f30: 6172 5f6e 616d 6520 3d20 6c69 7374 2865  ar_name = list(e
+00005f40: 6666 6563 745f 6461 7461 2e6b 6579 7328  ffect_data.keys(
+00005f50: 2929 5b30 5d0d 0a20 2020 2063 6f6e 666f  ))[0]..    confo
+00005f60: 756e 6465 725f 7661 725f 6e61 6d65 203d  under_var_name =
+00005f70: 206c 6973 7428 636f 6e66 6f75 6e64 6572   list(confounder
+00005f80: 5f64 6174 612e 6b65 7973 2829 295b 305d  _data.keys())[0]
+00005f90: 0d0a 2020 2020 0d0a 2020 2020 6461 7461  ..    ..    data
+00005fa0: 203d 2063 6175 7365 5f64 6174 612e 636f   = cause_data.co
+00005fb0: 7079 2829 0d0a 2020 2020 6461 7461 2e75  py()..    data.u
+00005fc0: 7064 6174 6528 6566 6665 6374 5f64 6174  pdate(effect_dat
+00005fd0: 6129 0d0a 2020 2020 6461 7461 2e75 7064  a)..    data.upd
+00005fe0: 6174 6528 636f 6e66 6f75 6e64 6572 5f64  ate(confounder_d
+00005ff0: 6174 6129 0d0a 2020 2020 0d0a 2020 2020  ata)..    ..    
+00006000: 6361 7573 616c 5f67 7261 7068 203d 2063  causal_graph = c
+00006010: 6175 7365 5f76 6172 5f6e 616d 6520 2b20  ause_var_name + 
+00006020: 223b 2220 2b20 6566 6665 6374 5f76 6172  ";" + effect_var
+00006030: 5f6e 616d 6520 2b20 223b 2220 2b20 636f  _name + ";" + co
+00006040: 6e66 6f75 6e64 6572 5f76 6172 5f6e 616d  nfounder_var_nam
+00006050: 6520 2b20 223b 205c 6e22 0d0a 2020 2020  e + "; \n"..    
+00006060: 6361 7573 616c 5f67 7261 7068 203d 2063  causal_graph = c
+00006070: 6175 7361 6c5f 6772 6170 6820 2b20 6361  ausal_graph + ca
+00006080: 7573 655f 7661 725f 6e61 6d65 202b 2022  use_var_name + "
+00006090: 2d3e 2220 2b20 6566 6665 6374 5f76 6172  ->" + effect_var
+000060a0: 5f6e 616d 6520 2b20 223b 205c 6e22 0d0a  _name + "; \n"..
+000060b0: 2020 2020 6361 7573 616c 5f67 7261 7068      causal_graph
+000060c0: 203d 2063 6175 7361 6c5f 6772 6170 6820   = causal_graph 
+000060d0: 2b20 636f 6e66 6f75 6e64 6572 5f76 6172  + confounder_var
+000060e0: 5f6e 616d 6520 2b20 222d 3e22 202b 2065  _name + "->" + e
+000060f0: 6666 6563 745f 7661 725f 6e61 6d65 202b  ffect_var_name +
+00006100: 2022 3b20 5c6e 220d 0a20 2020 2063 6175   "; \n"..    cau
+00006110: 7361 6c5f 6772 6170 6820 3d20 6361 7573  sal_graph = caus
+00006120: 616c 5f67 7261 7068 202b 2063 6f6e 666f  al_graph + confo
+00006130: 756e 6465 725f 7661 725f 6e61 6d65 202b  under_var_name +
+00006140: 2022 2d3e 2220 2b20 6361 7573 655f 7661   "->" + cause_va
+00006150: 725f 6e61 6d65 202b 2022 3b20 5c6e 220d  r_name + "; \n".
+00006160: 0a20 2020 200d 0a20 2020 2077 6569 6768  .    ..    weigh
+00006170: 745f 6675 6e63 5f6c 616d 2c20 7765 6967  t_func_lam, weig
+00006180: 6874 5f66 756e 635f 7374 7220 3d20 6765  ht_func_str = ge
+00006190: 6e65 7261 6c5f 6362 5f61 6e61 6c79 7369  neral_cb_analysi
+000061a0: 7328 6361 7573 616c 5f67 7261 7068 203d  s(causal_graph =
+000061b0: 2063 6175 7361 6c5f 6772 6170 682c 200d   causal_graph, .
+000061c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 000061d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000061e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000061f0: 2020 2020 2020 2020 2020 2020 6e5f 7361              n_sa
-00006200: 6d70 6c65 203d 206e 5f73 616d 706c 652c  mple = n_sample,
-00006210: 206b 6572 6e65 6c20 3d20 6b65 726e 656c   kernel = kernel
-00006220: 5f69 6e74 762c 206d 6f64 6520 3d20 6d6f  _intv, mode = mo
-00006230: 6465 290d 0a20 2020 2072 6574 7572 6e20  de)..    return 
-00006240: 6362 5f64 6174 610d 0a0d 0a64 6566 2066  cb_data....def f
-00006250: 726f 6e74 646f 6f72 5f73 696d 706c 6528  rontdoor_simple(
-00006260: 6361 7573 655f 6461 7461 2c20 6d65 6469  cause_data, medi
-00006270: 6174 6f72 5f64 6174 612c 2065 6666 6563  ator_data, effec
-00006280: 745f 6461 7461 2c20 6469 7374 5f6d 6170  t_data, dist_map
-00006290: 2c20 6d6f 6465 203d 2022 6661 7374 2229  , mode = "fast")
-000062a0: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-000062b0: 5065 7266 6f72 6d20 666f 6e74 646f 6f72  Perform fontdoor
-000062c0: 2063 6175 7361 6c20 626f 6f74 7374 7261   causal bootstra
-000062d0: 7070 696e 6720 746f 2064 652d 636f 6e66  pping to de-conf
-000062e0: 6f75 6e64 2074 6865 2063 6175 7361 6c20  ound the causal 
-000062f0: 6566 6665 6374 2075 7369 6e67 2074 6865  effect using the
-00006300: 2070 726f 7669 6465 6420 6f62 7365 7276   provided observ
-00006310: 6174 696f 6e61 6c20 0d0a 2020 2020 6461  ational ..    da
-00006320: 7461 2061 6e64 2064 6973 7472 6962 7574  ta and distribut
-00006330: 696f 6e20 6d61 7073 2e0d 0a0d 0a20 2020  ion maps.....   
-00006340: 2050 6172 616d 6574 6572 733a 0d0a 2020   Parameters:..  
-00006350: 2020 2020 2020 6361 7573 655f 6461 7461        cause_data
-00006360: 2028 6469 6374 293a 2041 2064 6963 7469   (dict): A dicti
-00006370: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
-00006380: 2074 6865 2063 6175 7365 2076 6172 6961   the cause varia
-00006390: 626c 6520 6e61 6d65 2061 7320 6120 6b65  ble name as a ke
-000063a0: 7920 616e 6420 6974 7320 6461 7461 2061  y and its data a
-000063b0: 7272 6179 2061 7320 7468 6520 7661 6c75  rray as the valu
-000063c0: 652e 0d0a 2020 2020 2020 2020 6d65 6469  e...        medi
-000063d0: 6174 6f72 5f64 6174 6120 2864 6963 7429  ator_data (dict)
-000063e0: 3a20 4120 6469 6374 696f 6e61 7279 2063  : A dictionary c
-000063f0: 6f6e 7461 696e 696e 6720 7468 6520 6d65  ontaining the me
-00006400: 6469 6174 6f72 2076 6172 6961 626c 6520  diator variable 
-00006410: 6e61 6d65 2061 7320 6120 6b65 7920 616e  name as a key an
-00006420: 6420 6974 7320 6461 7461 2061 7272 6179  d its data array
-00006430: 2061 7320 7468 6520 7661 6c75 652e 0d0a   as the value...
-00006440: 2020 2020 2020 2020 6566 6665 6374 5f64          effect_d
-00006450: 6174 6120 2864 6963 7429 3a20 4120 6469  ata (dict): A di
-00006460: 6374 696f 6e61 7279 2063 6f6e 7461 696e  ctionary contain
-00006470: 696e 6720 7468 6520 6566 6665 6374 2076  ing the effect v
-00006480: 6172 6961 626c 6520 6e61 6d65 2061 7320  ariable name as 
-00006490: 6120 6b65 7920 616e 6420 6974 7320 6461  a key and its da
-000064a0: 7461 2061 7272 6179 2061 7320 7468 6520  ta array as the 
-000064b0: 7661 6c75 652e 0d0a 2020 2020 2020 2020  value...        
-000064c0: 6469 7374 5f6d 6170 2028 6469 6374 293a  dist_map (dict):
-000064d0: 2041 2064 6963 7469 6f6e 6172 7920 6d61   A dictionary ma
-000064e0: 7070 696e 6720 7475 706c 6573 206f 6620  pping tuples of 
-000064f0: 7661 7269 6162 6c65 2063 6f6d 6269 6e61  variable combina
-00006500: 7469 6f6e 7320 746f 2074 6865 6972 2063  tions to their c
-00006510: 6f72 7265 7370 6f6e 6469 6e67 2064 6973  orresponding dis
-00006520: 7472 6962 7574 696f 6e20 6675 6e63 7469  tribution functi
-00006530: 6f6e 732e 0d0a 2020 2020 2020 2020 6d6f  ons...        mo
-00006540: 6465 2028 7374 722c 206f 7074 696f 6e61  de (str, optiona
-00006550: 6c29 3a20 4120 7374 7269 6e67 2069 6e64  l): A string ind
-00006560: 6963 6174 696e 6720 7468 6520 626f 6f74  icating the boot
-00006570: 7374 7261 7070 696e 6720 6d6f 6465 2e20  strapping mode. 
-00006580: 4974 2063 616e 2062 6520 6569 7468 6572  It can be either
-00006590: 2027 6661 7374 2720 6f72 2027 726f 6275   'fast' or 'robu
-000065a0: 7374 2720 6465 7065 6e64 696e 6720 6f6e  st' depending on
-000065b0: 2074 6865 2069 6d70 6c65 6d65 6e74 6174   the implementat
-000065c0: 696f 6e2e 2044 6566 6175 6c74 2069 7320  ion. Default is 
-000065d0: 2766 6173 7427 2e0d 0a0d 0a20 2020 2052  'fast'.....    R
-000065e0: 6574 7572 6e73 3a0d 0a20 2020 2020 2020  eturns:..       
-000065f0: 2064 6963 743a 2041 2064 6963 7469 6f6e   dict: A diction
-00006600: 6172 7920 636f 6e74 6169 6e69 6e67 2076  ary containing v
-00006610: 6172 6961 626c 6520 6e61 6d65 7320 6173  ariable names as
-00006620: 206b 6579 7320 616e 6420 7468 6569 7220   keys and their 
-00006630: 636f 7272 6573 706f 6e64 696e 6720 6465  corresponding de
-00006640: 2d63 6f6e 666f 756e 6465 6420 6461 7461  -confounded data
-00006650: 2061 7272 6179 7320 6173 2076 616c 7565   arrays as value
-00006660: 732e 0d0a 2020 2020 2222 220d 0a0d 0a20  s...    """.... 
-00006670: 2020 2063 6175 7365 5f76 6172 5f6e 616d     cause_var_nam
-00006680: 6520 3d20 6c69 7374 2863 6175 7365 5f64  e = list(cause_d
-00006690: 6174 612e 6b65 7973 2829 295b 305d 0d0a  ata.keys())[0]..
-000066a0: 2020 2020 6566 6665 6374 5f76 6172 5f6e      effect_var_n
-000066b0: 616d 6520 3d20 6c69 7374 2865 6666 6563  ame = list(effec
-000066c0: 745f 6461 7461 2e6b 6579 7328 2929 5b30  t_data.keys())[0
-000066d0: 5d0d 0a20 2020 206d 6564 6961 746f 725f  ]..    mediator_
-000066e0: 7661 725f 6e61 6d65 203d 206c 6973 7428  var_name = list(
-000066f0: 6d65 6469 6174 6f72 5f64 6174 612e 6b65  mediator_data.ke
-00006700: 7973 2829 295b 305d 0d0a 2020 2020 0d0a  ys())[0]..    ..
-00006710: 2020 2020 6461 7461 203d 207b 6361 7573      data = {caus
-00006720: 655f 7661 725f 6e61 6d65 2b22 2722 3a20  e_var_name+"'": 
-00006730: 6c69 7374 2863 6175 7365 5f64 6174 612e  list(cause_data.
-00006740: 7661 6c75 6573 2829 295b 305d 7d0d 0a20  values())[0]}.. 
-00006750: 2020 2064 6174 612e 7570 6461 7465 2865     data.update(e
-00006760: 6666 6563 745f 6461 7461 290d 0a20 2020  ffect_data)..   
-00006770: 2064 6174 612e 7570 6461 7465 286d 6564   data.update(med
-00006780: 6961 746f 725f 6461 7461 290d 0a20 2020  iator_data)..   
-00006790: 200d 0a20 2020 2063 6175 7361 6c5f 6772   ..    causal_gr
-000067a0: 6170 6820 3d20 6361 7573 655f 7661 725f  aph = cause_var_
-000067b0: 6e61 6d65 202b 2022 3b22 202b 2065 6666  name + ";" + eff
-000067c0: 6563 745f 7661 725f 6e61 6d65 202b 2022  ect_var_name + "
-000067d0: 3b22 202b 206d 6564 6961 746f 725f 7661  ;" + mediator_va
-000067e0: 725f 6e61 6d65 202b 2022 3b20 5c6e 220d  r_name + "; \n".
-000067f0: 0a20 2020 2063 6175 7361 6c5f 6772 6170  .    causal_grap
-00006800: 6820 3d20 6361 7573 616c 5f67 7261 7068  h = causal_graph
-00006810: 202b 2063 6175 7365 5f76 6172 5f6e 616d   + cause_var_nam
-00006820: 6520 2b20 222d 3e22 202b 206d 6564 6961  e + "->" + media
-00006830: 746f 725f 7661 725f 6e61 6d65 202b 2022  tor_var_name + "
-00006840: 3b20 5c6e 220d 0a20 2020 2063 6175 7361  ; \n"..    causa
-00006850: 6c5f 6772 6170 6820 3d20 6361 7573 616c  l_graph = causal
-00006860: 5f67 7261 7068 202b 206d 6564 6961 746f  _graph + mediato
-00006870: 725f 7661 725f 6e61 6d65 202b 2022 2d3e  r_var_name + "->
-00006880: 2220 2b20 6566 6665 6374 5f76 6172 5f6e  " + effect_var_n
-00006890: 616d 6520 2b20 223b 205c 6e22 0d0a 2020  ame + "; \n"..  
-000068a0: 2020 6361 7573 616c 5f67 7261 7068 203d    causal_graph =
-000068b0: 2063 6175 7361 6c5f 6772 6170 6820 2b20   causal_graph + 
-000068c0: 6361 7573 655f 7661 725f 6e61 6d65 202b  cause_var_name +
-000068d0: 2022 3c2d 3e22 202b 2065 6666 6563 745f   "<->" + effect_
-000068e0: 7661 725f 6e61 6d65 202b 2022 3b20 5c6e  var_name + "; \n
-000068f0: 220d 0a20 2020 200d 0a20 2020 2077 6569  "..    ..    wei
-00006900: 6768 745f 6675 6e63 5f6c 616d 2c20 7765  ght_func_lam, we
-00006910: 6967 6874 5f66 756e 635f 7374 7220 3d20  ight_func_str = 
-00006920: 6765 6e65 7261 6c5f 6362 5f61 6e61 6c79  general_cb_analy
-00006930: 7369 7328 6361 7573 616c 5f67 7261 7068  sis(causal_graph
-00006940: 203d 2063 6175 7361 6c5f 6772 6170 682c   = causal_graph,
-00006950: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00006960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006980: 2020 2020 2020 2020 2020 2020 2020 6566                ef
-00006990: 6665 6374 5f76 6172 5f6e 616d 6520 3d20  fect_var_name = 
-000069a0: 6566 6665 6374 5f76 6172 5f6e 616d 652c  effect_var_name,
-000069b0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-000069c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000069d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000069e0: 2020 2020 2020 2020 2020 2020 2020 6361                ca
-000069f0: 7573 655f 7661 725f 6e61 6d65 203d 2063  use_var_name = c
-00006a00: 6175 7365 5f76 6172 5f6e 616d 652c 2069  ause_var_name, i
-00006a10: 6e66 6f5f 7072 696e 743d 2046 616c 7365  nfo_print= False
-00006a20: 290d 0a20 2020 2063 625f 6461 7461 203d  )..    cb_data =
-00006a30: 2067 656e 6572 616c 5f63 6175 7361 6c5f   general_causal_
-00006a40: 626f 6f74 7374 7261 7070 696e 675f 7369  bootstrapping_si
-00006a50: 6d70 6c65 2877 6569 6768 745f 6675 6e63  mple(weight_func
-00006a60: 5f6c 616d 203d 2077 6569 6768 745f 6675  _lam = weight_fu
-00006a70: 6e63 5f6c 616d 2c20 0d0a 2020 2020 2020  nc_lam, ..      
-00006a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006aa0: 2020 2020 2020 2020 2020 2020 6469 7374              dist
-00006ab0: 5f6d 6170 203d 2064 6973 745f 6d61 702c  _map = dist_map,
-00006ac0: 2064 6174 6120 3d20 6461 7461 2c20 0d0a   data = data, ..
-00006ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006b00: 2020 696e 7476 5f76 6172 5f6e 616d 6520    intv_var_name 
-00006b10: 3d20 6361 7573 655f 7661 725f 6e61 6d65  = cause_var_name
-00006b20: 2c20 6d6f 6465 203d 206d 6f64 6529 0d0a  , mode = mode)..
-00006b30: 0d0a 2020 2020 7265 7475 726e 2063 625f  ..    return cb_
-00006b40: 6461 7461 0d0a 0d0a 6465 6620 6672 6f6e  data....def fron
-00006b50: 7464 6f6f 725f 7369 6d75 2863 6175 7365  tdoor_simu(cause
-00006b60: 5f64 6174 612c 206d 6564 6961 746f 725f  _data, mediator_
-00006b70: 6461 7461 2c20 6566 6665 6374 5f64 6174  data, effect_dat
-00006b80: 612c 2064 6973 745f 6d61 702c 2069 6e74  a, dist_map, int
-00006b90: 765f 7661 6c75 652c 206e 5f73 616d 706c  v_value, n_sampl
-00006ba0: 652c 206d 6f64 6520 3d20 2266 6173 7422  e, mode = "fast"
-00006bb0: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-00006bc0: 2050 6572 666f 726d 2073 696d 756c 6174   Perform simulat
-00006bd0: 696f 6e61 6c20 6672 6f6e 7464 6f6f 7220  ional frontdoor 
-00006be0: 6361 7573 616c 2062 6f6f 7473 7472 6170  causal bootstrap
-00006bf0: 7069 6e67 2074 6f20 6465 2d63 6f6e 666f  ping to de-confo
-00006c00: 756e 6420 7468 6520 6361 7573 616c 2065  und the causal e
-00006c10: 6666 6563 7420 7573 696e 6720 7468 6520  ffect using the 
-00006c20: 7072 6f76 6964 6564 200d 0a20 2020 206f  provided ..    o
-00006c30: 6273 6572 7661 7469 6f6e 616c 2064 6174  bservational dat
-00006c40: 6120 616e 6420 6469 7374 7269 6275 7469  a and distributi
-00006c50: 6f6e 206d 6170 732e 0d0a 0d0a 2020 2020  on maps.....    
-00006c60: 5061 7261 6d65 7465 7273 3a0d 0a20 2020  Parameters:..   
-00006c70: 2020 2020 2063 6175 7365 5f64 6174 6120       cause_data 
-00006c80: 2864 6963 7429 3a20 4120 6469 6374 696f  (dict): A dictio
-00006c90: 6e61 7279 2063 6f6e 7461 696e 696e 6720  nary containing 
-00006ca0: 7468 6520 6361 7573 6520 7661 7269 6162  the cause variab
-00006cb0: 6c65 206e 616d 6520 6173 2061 206b 6579  le name as a key
-00006cc0: 2061 6e64 2069 7473 2064 6174 6120 6172   and its data ar
-00006cd0: 7261 7920 6173 2074 6865 2076 616c 7565  ray as the value
-00006ce0: 2e0d 0a20 2020 2020 2020 206d 6564 6961  ...        media
-00006cf0: 746f 725f 6461 7461 2028 6469 6374 293a  tor_data (dict):
-00006d00: 2041 2064 6963 7469 6f6e 6172 7920 636f   A dictionary co
-00006d10: 6e74 6169 6e69 6e67 2074 6865 206d 6564  ntaining the med
-00006d20: 6961 746f 7220 7661 7269 6162 6c65 206e  iator variable n
-00006d30: 616d 6520 6173 2061 206b 6579 2061 6e64  ame as a key and
-00006d40: 2069 7473 2064 6174 6120 6172 7261 7920   its data array 
-00006d50: 6173 2074 6865 2076 616c 7565 2e0d 0a20  as the value... 
-00006d60: 2020 2020 2020 2065 6666 6563 745f 6461         effect_da
-00006d70: 7461 2028 6469 6374 293a 2041 2064 6963  ta (dict): A dic
-00006d80: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
-00006d90: 6e67 2074 6865 2065 6666 6563 7420 7661  ng the effect va
-00006da0: 7269 6162 6c65 206e 616d 6520 6173 2061  riable name as a
-00006db0: 206b 6579 2061 6e64 2069 7473 2064 6174   key and its dat
-00006dc0: 6120 6172 7261 7920 6173 2074 6865 2076  a array as the v
-00006dd0: 616c 7565 2e0d 0a20 2020 2020 2020 2064  alue...        d
-00006de0: 6973 745f 6d61 7020 2864 6963 7429 3a20  ist_map (dict): 
-00006df0: 4120 6469 6374 696f 6e61 7279 206d 6170  A dictionary map
-00006e00: 7069 6e67 2074 7570 6c65 7320 6f66 2076  ping tuples of v
-00006e10: 6172 6961 626c 6520 636f 6d62 696e 6174  ariable combinat
-00006e20: 696f 6e73 2074 6f20 7468 6569 7220 636f  ions to their co
-00006e30: 7272 6573 706f 6e64 696e 6720 6469 7374  rresponding dist
-00006e40: 7269 6275 7469 6f6e 2066 756e 6374 696f  ribution functio
-00006e50: 6e73 2e0d 0a20 2020 2020 2020 2069 6e74  ns...        int
-00006e60: 765f 7661 6c75 6520 286c 6973 7429 3a20  v_value (list): 
-00006e70: 4120 6c69 7374 2063 6f6e 7461 696e 696e  A list containin
-00006e80: 6720 7468 6520 696e 7465 7276 656e 7469  g the interventi
-00006e90: 6f6e 616c 2076 616c 7565 2e0d 0a20 2020  onal value...   
-00006ea0: 2020 2020 206e 5f73 616d 706c 6520 2869       n_sample (i
-00006eb0: 6e74 293a 2054 6865 206e 756d 6265 7220  nt): The number 
-00006ec0: 6f66 2073 616d 706c 6573 2074 6f20 6265  of samples to be
-00006ed0: 2067 656e 6572 6174 6564 2074 6872 6f75   generated throu
-00006ee0: 6768 2062 6f6f 7473 7472 6170 7069 6e67  gh bootstrapping
-00006ef0: 2e0d 0a20 2020 2020 2020 206d 6f64 6520  ...        mode 
-00006f00: 2873 7472 2c20 6f70 7469 6f6e 616c 293a  (str, optional):
-00006f10: 2041 2073 7472 696e 6720 696e 6469 6361   A string indica
-00006f20: 7469 6e67 2074 6865 2062 6f6f 7473 7472  ting the bootstr
-00006f30: 6170 7069 6e67 206d 6f64 652e 2049 7420  apping mode. It 
-00006f40: 6361 6e20 6265 2065 6974 6865 7220 2766  can be either 'f
-00006f50: 6173 7427 206f 7220 2772 6f62 7573 7427  ast' or 'robust'
-00006f60: 2064 6570 656e 6469 6e67 206f 6e20 7468   depending on th
-00006f70: 6520 696d 706c 656d 656e 7461 7469 6f6e  e implementation
-00006f80: 2e20 4465 6661 756c 7420 6973 2027 6661  . Default is 'fa
-00006f90: 7374 272e 0d0a 0d0a 2020 2020 5265 7475  st'.....    Retu
-00006fa0: 726e 733a 0d0a 2020 2020 2020 2020 6469  rns:..        di
-00006fb0: 6374 3a20 4120 6469 6374 696f 6e61 7279  ct: A dictionary
-00006fc0: 2063 6f6e 7461 696e 696e 6720 7661 7269   containing vari
-00006fd0: 6162 6c65 206e 616d 6573 2061 7320 6b65  able names as ke
-00006fe0: 7973 2061 6e64 2074 6865 6972 2063 6f72  ys and their cor
-00006ff0: 7265 7370 6f6e 6469 6e67 2064 652d 636f  responding de-co
-00007000: 6e66 6f75 6e64 6564 2064 6174 6120 6172  nfounded data ar
-00007010: 7261 7973 2061 7320 7661 6c75 6573 2e0d  rays as values..
-00007020: 0a20 2020 2022 2222 0d0a 2020 2020 0d0a  .    """..    ..
-00007030: 2020 2020 6361 7573 655f 7661 725f 6e61      cause_var_na
-00007040: 6d65 203d 206c 6973 7428 6361 7573 655f  me = list(cause_
-00007050: 6461 7461 2e6b 6579 7328 2929 5b30 5d0d  data.keys())[0].
-00007060: 0a20 2020 2065 6666 6563 745f 7661 725f  .    effect_var_
-00007070: 6e61 6d65 203d 206c 6973 7428 6566 6665  name = list(effe
-00007080: 6374 5f64 6174 612e 6b65 7973 2829 295b  ct_data.keys())[
-00007090: 305d 0d0a 2020 2020 6d65 6469 6174 6f72  0]..    mediator
-000070a0: 5f76 6172 5f6e 616d 6520 3d20 6c69 7374  _var_name = list
-000070b0: 286d 6564 6961 746f 725f 6461 7461 2e6b  (mediator_data.k
-000070c0: 6579 7328 2929 5b30 5d0d 0a20 2020 200d  eys())[0]..    .
-000070d0: 0a20 2020 2064 6174 6120 3d20 7b63 6175  .    data = {cau
-000070e0: 7365 5f76 6172 5f6e 616d 652b 2227 223a  se_var_name+"'":
-000070f0: 206c 6973 7428 6361 7573 655f 6461 7461   list(cause_data
-00007100: 2e76 616c 7565 7328 2929 5b30 5d7d 0d0a  .values())[0]}..
-00007110: 2020 2020 6461 7461 2e75 7064 6174 6528      data.update(
-00007120: 6566 6665 6374 5f64 6174 6129 0d0a 2020  effect_data)..  
-00007130: 2020 6461 7461 2e75 7064 6174 6528 6d65    data.update(me
-00007140: 6469 6174 6f72 5f64 6174 6129 0d0a 2020  diator_data)..  
-00007150: 2020 0d0a 2020 2020 6361 7573 616c 5f67    ..    causal_g
-00007160: 7261 7068 203d 2063 6175 7365 5f76 6172  raph = cause_var
-00007170: 5f6e 616d 6520 2b20 223b 2220 2b20 6566  _name + ";" + ef
-00007180: 6665 6374 5f76 6172 5f6e 616d 6520 2b20  fect_var_name + 
-00007190: 223b 2220 2b20 6d65 6469 6174 6f72 5f76  ";" + mediator_v
-000071a0: 6172 5f6e 616d 6520 2b20 223b 205c 6e22  ar_name + "; \n"
-000071b0: 0d0a 2020 2020 6361 7573 616c 5f67 7261  ..    causal_gra
-000071c0: 7068 203d 2063 6175 7361 6c5f 6772 6170  ph = causal_grap
-000071d0: 6820 2b20 6361 7573 655f 7661 725f 6e61  h + cause_var_na
-000071e0: 6d65 202b 2022 2d3e 2220 2b20 6d65 6469  me + "->" + medi
-000071f0: 6174 6f72 5f76 6172 5f6e 616d 6520 2b20  ator_var_name + 
-00007200: 223b 205c 6e22 0d0a 2020 2020 6361 7573  "; \n"..    caus
-00007210: 616c 5f67 7261 7068 203d 2063 6175 7361  al_graph = causa
-00007220: 6c5f 6772 6170 6820 2b20 6d65 6469 6174  l_graph + mediat
-00007230: 6f72 5f76 6172 5f6e 616d 6520 2b20 222d  or_var_name + "-
-00007240: 3e22 202b 2065 6666 6563 745f 7661 725f  >" + effect_var_
-00007250: 6e61 6d65 202b 2022 3b20 5c6e 220d 0a20  name + "; \n".. 
-00007260: 2020 2063 6175 7361 6c5f 6772 6170 6820     causal_graph 
-00007270: 3d20 6361 7573 616c 5f67 7261 7068 202b  = causal_graph +
-00007280: 2063 6175 7365 5f76 6172 5f6e 616d 6520   cause_var_name 
-00007290: 2b20 223c 2d3e 2220 2b20 6566 6665 6374  + "<->" + effect
-000072a0: 5f76 6172 5f6e 616d 6520 2b20 223b 205c  _var_name + "; \
-000072b0: 6e22 0d0a 2020 2020 0d0a 2020 2020 7765  n"..    ..    we
-000072c0: 6967 6874 5f66 756e 635f 6c61 6d2c 2077  ight_func_lam, w
-000072d0: 6569 6768 745f 6675 6e63 5f73 7472 203d  eight_func_str =
-000072e0: 2067 656e 6572 616c 5f63 625f 616e 616c   general_cb_anal
-000072f0: 7973 6973 2863 6175 7361 6c5f 6772 6170  ysis(causal_grap
-00007300: 6820 3d20 6361 7573 616c 5f67 7261 7068  h = causal_graph
-00007310: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00007320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007340: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00007350: 6666 6563 745f 7661 725f 6e61 6d65 203d  ffect_var_name =
-00007360: 2065 6666 6563 745f 7661 725f 6e61 6d65   effect_var_name
-00007370: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
-00007380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000073a0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000073b0: 6175 7365 5f76 6172 5f6e 616d 6520 3d20  ause_var_name = 
-000073c0: 6361 7573 655f 7661 725f 6e61 6d65 2c20  cause_var_name, 
-000073d0: 696e 666f 5f70 7269 6e74 3d20 4661 6c73  info_print= Fals
-000073e0: 6529 0d0a 2020 2020 696e 7476 5f76 6172  e)..    intv_var
-000073f0: 5f6e 616d 6520 3d20 6361 7573 655f 7661  _name = cause_va
-00007400: 725f 6e61 6d65 0d0a 2020 2020 6362 5f64  r_name..    cb_d
-00007410: 6174 6120 3d20 6765 6e65 7261 6c5f 6361  ata = general_ca
-00007420: 7573 616c 5f62 6f6f 7473 7472 6170 7069  usal_bootstrappi
-00007430: 6e67 5f73 696d 7528 7765 6967 6874 5f66  ng_simu(weight_f
-00007440: 756e 635f 6c61 6d20 3d20 7765 6967 6874  unc_lam = weight
-00007450: 5f66 756e 635f 6c61 6d2c 200d 0a20 2020  _func_lam, ..   
-00007460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007480: 2020 2020 2020 2020 2020 2020 2064 6973               dis
-00007490: 745f 6d61 7020 3d20 6469 7374 5f6d 6170  t_map = dist_map
-000074a0: 2c20 6461 7461 203d 2064 6174 612c 200d  , data = data, .
-000074b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000074c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000074d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000074e0: 2069 6e74 765f 7661 725f 7661 6c75 6520   intv_var_value 
-000074f0: 3d20 7b69 6e74 765f 7661 725f 6e61 6d65  = {intv_var_name
-00007500: 3a20 696e 7476 5f76 616c 7565 7d2c 200d  : intv_value}, .
-00007510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007540: 206e 5f73 616d 706c 6520 3d20 6e5f 7361   n_sample = n_sa
-00007550: 6d70 6c65 2c20 6d6f 6465 203d 206d 6f64  mple, mode = mod
-00007560: 6529 0d0a 2020 2020 7265 7475 726e 2063  e)..    return c
-00007570: 625f 6461 7461                           b_data
+000061f0: 2020 2020 2020 2020 2020 2020 6566 6665              effe
+00006200: 6374 5f76 6172 5f6e 616d 6520 3d20 6566  ct_var_name = ef
+00006210: 6665 6374 5f76 6172 5f6e 616d 652c 200d  fect_var_name, .
+00006220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006250: 2020 2020 2020 2020 2020 2020 6361 7573              caus
+00006260: 655f 7661 725f 6e61 6d65 203d 2063 6175  e_var_name = cau
+00006270: 7365 5f76 6172 5f6e 616d 652c 2069 6e66  se_var_name, inf
+00006280: 6f5f 7072 696e 743d 2046 616c 7365 290d  o_print= False).
+00006290: 0a20 2020 200d 0a20 2020 2069 6620 6b65  .    ..    if ke
+000062a0: 726e 656c 5f69 6e74 7620 6973 204e 6f6e  rnel_intv is Non
+000062b0: 653a 0d0a 2020 2020 2020 2020 696e 7476  e:..        intv
+000062c0: 5f76 6172 5f6e 616d 6520 3d20 2269 6e74  _var_name = "int
+000062d0: 765f 2220 2b20 6361 7573 655f 7661 725f  v_" + cause_var_
+000062e0: 6e61 6d65 0d0a 2020 2020 2020 2020 6b65  name..        ke
+000062f0: 726e 656c 5f69 6e74 7620 3d20 6576 616c  rnel_intv = eval
+00006300: 2822 6c61 6d62 6461 2022 2b69 6e74 765f  ("lambda "+intv_
+00006310: 7661 725f 6e61 6d65 2b22 2c22 2b63 6175  var_name+","+cau
+00006320: 7365 5f76 6172 5f6e 616d 652b 223a 2031  se_var_name+": 1
+00006330: 2069 6620 222b 696e 7476 5f76 6172 5f6e   if "+intv_var_n
+00006340: 616d 652b 223d 3d22 202b 2063 6175 7365  ame+"==" + cause
+00006350: 5f76 6172 5f6e 616d 6520 2b20 2220 656c  _var_name + " el
+00006360: 7365 2030 2229 0d0a 2020 2020 656c 7365  se 0")..    else
+00006370: 3a0d 0a20 2020 2020 2020 206b 6572 6e65  :..        kerne
+00006380: 6c5f 7061 7261 6d73 203d 2073 6574 2869  l_params = set(i
+00006390: 6e73 7065 6374 2e73 6967 6e61 7475 7265  nspect.signature
+000063a0: 286b 6572 6e65 6c5f 696e 7476 292e 7061  (kernel_intv).pa
+000063b0: 7261 6d65 7465 7273 2e6b 6579 7328 2929  rameters.keys())
+000063c0: 0d0a 2020 2020 2020 2020 696e 7476 5f76  ..        intv_v
+000063d0: 6172 5f6e 616d 6520 3d20 6c69 7374 286b  ar_name = list(k
+000063e0: 6572 6e65 6c5f 7061 7261 6d73 202d 2073  ernel_params - s
+000063f0: 6574 2864 6174 612e 6b65 7973 2829 2929  et(data.keys()))
+00006400: 0d0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
+00006410: 2869 6e74 765f 7661 725f 6e61 6d65 2920  (intv_var_name) 
+00006420: 3d3d 2030 3a0d 0a20 2020 2020 2020 2020  == 0:..         
+00006430: 2020 2069 6e74 765f 7661 725f 6e61 6d65     intv_var_name
+00006440: 203d 2022 696e 7476 5f22 202b 2063 6175   = "intv_" + cau
+00006450: 7365 5f76 6172 5f6e 616d 650d 0a20 2020  se_var_name..   
+00006460: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00006470: 2020 2020 2020 2020 696e 7476 5f76 6172          intv_var
+00006480: 5f6e 616d 6520 3d20 696e 7476 5f76 6172  _name = intv_var
+00006490: 5f6e 616d 655b 305d 0d0a 2020 2020 6362  _name[0]..    cb
+000064a0: 5f64 6174 6120 3d20 6765 6e65 7261 6c5f  _data = general_
+000064b0: 6361 7573 616c 5f62 6f6f 7473 7472 6170  causal_bootstrap
+000064c0: 7069 6e67 5f73 696d 7528 7765 6967 6874  ping_simu(weight
+000064d0: 5f66 756e 635f 6c61 6d20 3d20 7765 6967  _func_lam = weig
+000064e0: 6874 5f66 756e 635f 6c61 6d2c 200d 0a20  ht_func_lam, .. 
+000064f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006510: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00006520: 6973 745f 6d61 7020 3d20 6469 7374 5f6d  ist_map = dist_m
+00006530: 6170 2c20 6461 7461 203d 2064 6174 612c  ap, data = data,
+00006540: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+00006550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006570: 2020 2069 6e74 765f 7661 725f 7661 6c75     intv_var_valu
+00006580: 6520 3d20 7b69 6e74 765f 7661 725f 6e61  e = {intv_var_na
+00006590: 6d65 3a20 696e 7476 5f76 616c 7565 7d2c  me: intv_value},
+000065a0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000065b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000065c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000065d0: 2020 206e 5f73 616d 706c 6520 3d20 6e5f     n_sample = n_
+000065e0: 7361 6d70 6c65 2c20 6b65 726e 656c 203d  sample, kernel =
+000065f0: 206b 6572 6e65 6c5f 696e 7476 2c20 6d6f   kernel_intv, mo
+00006600: 6465 203d 206d 6f64 6529 0d0a 2020 2020  de = mode)..    
+00006610: 7265 7475 726e 2063 625f 6461 7461 0d0a  return cb_data..
+00006620: 0d0a 6465 6620 6672 6f6e 7464 6f6f 725f  ..def frontdoor_
+00006630: 7369 6d70 6c65 2863 6175 7365 5f64 6174  simple(cause_dat
+00006640: 612c 206d 6564 6961 746f 725f 6461 7461  a, mediator_data
+00006650: 2c20 6566 6665 6374 5f64 6174 612c 2064  , effect_data, d
+00006660: 6973 745f 6d61 702c 206d 6f64 6520 3d20  ist_map, mode = 
+00006670: 2266 6173 7422 293a 0d0a 2020 2020 2222  "fast"):..    ""
+00006680: 220d 0a20 2020 2050 6572 666f 726d 2066  "..    Perform f
+00006690: 6f6e 7464 6f6f 7220 6361 7573 616c 2062  ontdoor causal b
+000066a0: 6f6f 7473 7472 6170 7069 6e67 2074 6f20  ootstrapping to 
+000066b0: 6465 2d63 6f6e 666f 756e 6420 7468 6520  de-confound the 
+000066c0: 6361 7573 616c 2065 6666 6563 7420 7573  causal effect us
+000066d0: 696e 6720 7468 6520 7072 6f76 6964 6564  ing the provided
+000066e0: 206f 6273 6572 7661 7469 6f6e 616c 200d   observational .
+000066f0: 0a20 2020 2064 6174 6120 616e 6420 6469  .    data and di
+00006700: 7374 7269 6275 7469 6f6e 206d 6170 732e  stribution maps.
+00006710: 0d0a 0d0a 2020 2020 5061 7261 6d65 7465  ....    Paramete
+00006720: 7273 3a0d 0a20 2020 2020 2020 2063 6175  rs:..        cau
+00006730: 7365 5f64 6174 6120 2864 6963 7429 3a20  se_data (dict): 
+00006740: 4120 6469 6374 696f 6e61 7279 2063 6f6e  A dictionary con
+00006750: 7461 696e 696e 6720 7468 6520 6361 7573  taining the caus
+00006760: 6520 7661 7269 6162 6c65 206e 616d 6520  e variable name 
+00006770: 6173 2061 206b 6579 2061 6e64 2069 7473  as a key and its
+00006780: 2064 6174 6120 6172 7261 7920 6173 2074   data array as t
+00006790: 6865 2076 616c 7565 2e0d 0a20 2020 2020  he value...     
+000067a0: 2020 206d 6564 6961 746f 725f 6461 7461     mediator_data
+000067b0: 2028 6469 6374 293a 2041 2064 6963 7469   (dict): A dicti
+000067c0: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
+000067d0: 2074 6865 206d 6564 6961 746f 7220 7661   the mediator va
+000067e0: 7269 6162 6c65 206e 616d 6520 6173 2061  riable name as a
+000067f0: 206b 6579 2061 6e64 2069 7473 2064 6174   key and its dat
+00006800: 6120 6172 7261 7920 6173 2074 6865 2076  a array as the v
+00006810: 616c 7565 2e0d 0a20 2020 2020 2020 2065  alue...        e
+00006820: 6666 6563 745f 6461 7461 2028 6469 6374  ffect_data (dict
+00006830: 293a 2041 2064 6963 7469 6f6e 6172 7920  ): A dictionary 
+00006840: 636f 6e74 6169 6e69 6e67 2074 6865 2065  containing the e
+00006850: 6666 6563 7420 7661 7269 6162 6c65 206e  ffect variable n
+00006860: 616d 6520 6173 2061 206b 6579 2061 6e64  ame as a key and
+00006870: 2069 7473 2064 6174 6120 6172 7261 7920   its data array 
+00006880: 6173 2074 6865 2076 616c 7565 2e0d 0a20  as the value... 
+00006890: 2020 2020 2020 2064 6973 745f 6d61 7020         dist_map 
+000068a0: 2864 6963 7429 3a20 4120 6469 6374 696f  (dict): A dictio
+000068b0: 6e61 7279 206d 6170 7069 6e67 2074 7570  nary mapping tup
+000068c0: 6c65 7320 6f66 2076 6172 6961 626c 6520  les of variable 
+000068d0: 636f 6d62 696e 6174 696f 6e73 2074 6f20  combinations to 
+000068e0: 7468 6569 7220 636f 7272 6573 706f 6e64  their correspond
+000068f0: 696e 6720 6469 7374 7269 6275 7469 6f6e  ing distribution
+00006900: 2066 756e 6374 696f 6e73 2e0d 0a20 2020   functions...   
+00006910: 2020 2020 206d 6f64 6520 2873 7472 2c20       mode (str, 
+00006920: 6f70 7469 6f6e 616c 293a 2041 2073 7472  optional): A str
+00006930: 696e 6720 696e 6469 6361 7469 6e67 2074  ing indicating t
+00006940: 6865 2062 6f6f 7473 7472 6170 7069 6e67  he bootstrapping
+00006950: 206d 6f64 652e 2049 7420 6361 6e20 6265   mode. It can be
+00006960: 2065 6974 6865 7220 2766 6173 7427 206f   either 'fast' o
+00006970: 7220 2772 6f62 7573 7427 2064 6570 656e  r 'robust' depen
+00006980: 6469 6e67 206f 6e20 7468 6520 696d 706c  ding on the impl
+00006990: 656d 656e 7461 7469 6f6e 2e20 4465 6661  ementation. Defa
+000069a0: 756c 7420 6973 2027 6661 7374 272e 0d0a  ult is 'fast'...
+000069b0: 0d0a 2020 2020 5265 7475 726e 733a 0d0a  ..    Returns:..
+000069c0: 2020 2020 2020 2020 6469 6374 3a20 4120          dict: A 
+000069d0: 6469 6374 696f 6e61 7279 2063 6f6e 7461  dictionary conta
+000069e0: 696e 696e 6720 7661 7269 6162 6c65 206e  ining variable n
+000069f0: 616d 6573 2061 7320 6b65 7973 2061 6e64  ames as keys and
+00006a00: 2074 6865 6972 2063 6f72 7265 7370 6f6e   their correspon
+00006a10: 6469 6e67 2064 652d 636f 6e66 6f75 6e64  ding de-confound
+00006a20: 6564 2064 6174 6120 6172 7261 7973 2061  ed data arrays a
+00006a30: 7320 7661 6c75 6573 2e0d 0a20 2020 2022  s values...    "
+00006a40: 2222 0d0a 0d0a 2020 2020 6361 7573 655f  ""....    cause_
+00006a50: 7661 725f 6e61 6d65 203d 206c 6973 7428  var_name = list(
+00006a60: 6361 7573 655f 6461 7461 2e6b 6579 7328  cause_data.keys(
+00006a70: 2929 5b30 5d0d 0a20 2020 2065 6666 6563  ))[0]..    effec
+00006a80: 745f 7661 725f 6e61 6d65 203d 206c 6973  t_var_name = lis
+00006a90: 7428 6566 6665 6374 5f64 6174 612e 6b65  t(effect_data.ke
+00006aa0: 7973 2829 295b 305d 0d0a 2020 2020 6d65  ys())[0]..    me
+00006ab0: 6469 6174 6f72 5f76 6172 5f6e 616d 6520  diator_var_name 
+00006ac0: 3d20 6c69 7374 286d 6564 6961 746f 725f  = list(mediator_
+00006ad0: 6461 7461 2e6b 6579 7328 2929 5b30 5d0d  data.keys())[0].
+00006ae0: 0a20 2020 200d 0a20 2020 2064 6174 6120  .    ..    data 
+00006af0: 3d20 7b63 6175 7365 5f76 6172 5f6e 616d  = {cause_var_nam
+00006b00: 652b 2227 223a 206c 6973 7428 6361 7573  e+"'": list(caus
+00006b10: 655f 6461 7461 2e76 616c 7565 7328 2929  e_data.values())
+00006b20: 5b30 5d7d 0d0a 2020 2020 6461 7461 2e75  [0]}..    data.u
+00006b30: 7064 6174 6528 6566 6665 6374 5f64 6174  pdate(effect_dat
+00006b40: 6129 0d0a 2020 2020 6461 7461 2e75 7064  a)..    data.upd
+00006b50: 6174 6528 6d65 6469 6174 6f72 5f64 6174  ate(mediator_dat
+00006b60: 6129 0d0a 2020 2020 0d0a 2020 2020 6361  a)..    ..    ca
+00006b70: 7573 616c 5f67 7261 7068 203d 2063 6175  usal_graph = cau
+00006b80: 7365 5f76 6172 5f6e 616d 6520 2b20 223b  se_var_name + ";
+00006b90: 2220 2b20 6566 6665 6374 5f76 6172 5f6e  " + effect_var_n
+00006ba0: 616d 6520 2b20 223b 2220 2b20 6d65 6469  ame + ";" + medi
+00006bb0: 6174 6f72 5f76 6172 5f6e 616d 6520 2b20  ator_var_name + 
+00006bc0: 223b 205c 6e22 0d0a 2020 2020 6361 7573  "; \n"..    caus
+00006bd0: 616c 5f67 7261 7068 203d 2063 6175 7361  al_graph = causa
+00006be0: 6c5f 6772 6170 6820 2b20 6361 7573 655f  l_graph + cause_
+00006bf0: 7661 725f 6e61 6d65 202b 2022 2d3e 2220  var_name + "->" 
+00006c00: 2b20 6d65 6469 6174 6f72 5f76 6172 5f6e  + mediator_var_n
+00006c10: 616d 6520 2b20 223b 205c 6e22 0d0a 2020  ame + "; \n"..  
+00006c20: 2020 6361 7573 616c 5f67 7261 7068 203d    causal_graph =
+00006c30: 2063 6175 7361 6c5f 6772 6170 6820 2b20   causal_graph + 
+00006c40: 6d65 6469 6174 6f72 5f76 6172 5f6e 616d  mediator_var_nam
+00006c50: 6520 2b20 222d 3e22 202b 2065 6666 6563  e + "->" + effec
+00006c60: 745f 7661 725f 6e61 6d65 202b 2022 3b20  t_var_name + "; 
+00006c70: 5c6e 220d 0a20 2020 2063 6175 7361 6c5f  \n"..    causal_
+00006c80: 6772 6170 6820 3d20 6361 7573 616c 5f67  graph = causal_g
+00006c90: 7261 7068 202b 2063 6175 7365 5f76 6172  raph + cause_var
+00006ca0: 5f6e 616d 6520 2b20 223c 2d3e 2220 2b20  _name + "<->" + 
+00006cb0: 6566 6665 6374 5f76 6172 5f6e 616d 6520  effect_var_name 
+00006cc0: 2b20 223b 205c 6e22 0d0a 2020 2020 0d0a  + "; \n"..    ..
+00006cd0: 2020 2020 7765 6967 6874 5f66 756e 635f      weight_func_
+00006ce0: 6c61 6d2c 2077 6569 6768 745f 6675 6e63  lam, weight_func
+00006cf0: 5f73 7472 203d 2067 656e 6572 616c 5f63  _str = general_c
+00006d00: 625f 616e 616c 7973 6973 2863 6175 7361  b_analysis(causa
+00006d10: 6c5f 6772 6170 6820 3d20 6361 7573 616c  l_graph = causal
+00006d20: 5f67 7261 7068 2c20 0d0a 2020 2020 2020  _graph, ..      
+00006d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006d60: 2020 2020 2065 6666 6563 745f 7661 725f       effect_var_
+00006d70: 6e61 6d65 203d 2065 6666 6563 745f 7661  name = effect_va
+00006d80: 725f 6e61 6d65 2c20 0d0a 2020 2020 2020  r_name, ..      
+00006d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006dc0: 2020 2020 2063 6175 7365 5f76 6172 5f6e       cause_var_n
+00006dd0: 616d 6520 3d20 6361 7573 655f 7661 725f  ame = cause_var_
+00006de0: 6e61 6d65 2c20 696e 666f 5f70 7269 6e74  name, info_print
+00006df0: 3d20 4661 6c73 6529 0d0a 2020 2020 6362  = False)..    cb
+00006e00: 5f64 6174 6120 3d20 6765 6e65 7261 6c5f  _data = general_
+00006e10: 6361 7573 616c 5f62 6f6f 7473 7472 6170  causal_bootstrap
+00006e20: 7069 6e67 5f73 696d 706c 6528 7765 6967  ping_simple(weig
+00006e30: 6874 5f66 756e 635f 6c61 6d20 3d20 7765  ht_func_lam = we
+00006e40: 6967 6874 5f66 756e 635f 6c61 6d2c 200d  ight_func_lam, .
+00006e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e80: 2020 2064 6973 745f 6d61 7020 3d20 6469     dist_map = di
+00006e90: 7374 5f6d 6170 2c20 6461 7461 203d 2064  st_map, data = d
+00006ea0: 6174 612c 200d 0a20 2020 2020 2020 2020  ata, ..         
+00006eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006ed0: 2020 2020 2020 2020 2069 6e74 765f 7661           intv_va
+00006ee0: 725f 6e61 6d65 203d 2063 6175 7365 5f76  r_name = cause_v
+00006ef0: 6172 5f6e 616d 652c 206d 6f64 6520 3d20  ar_name, mode = 
+00006f00: 6d6f 6465 290d 0a0d 0a20 2020 2072 6574  mode)....    ret
+00006f10: 7572 6e20 6362 5f64 6174 610d 0a0d 0a64  urn cb_data....d
+00006f20: 6566 2066 726f 6e74 646f 6f72 5f73 696d  ef frontdoor_sim
+00006f30: 7528 6361 7573 655f 6461 7461 2c20 6d65  u(cause_data, me
+00006f40: 6469 6174 6f72 5f64 6174 612c 2065 6666  diator_data, eff
+00006f50: 6563 745f 6461 7461 2c20 6469 7374 5f6d  ect_data, dist_m
+00006f60: 6170 2c20 696e 7476 5f76 616c 7565 2c20  ap, intv_value, 
+00006f70: 6e5f 7361 6d70 6c65 2c20 6d6f 6465 203d  n_sample, mode =
+00006f80: 2022 6661 7374 2229 3a0d 0a20 2020 2022   "fast"):..    "
+00006f90: 2222 0d0a 2020 2020 5065 7266 6f72 6d20  ""..    Perform 
+00006fa0: 7369 6d75 6c61 7469 6f6e 616c 2066 726f  simulational fro
+00006fb0: 6e74 646f 6f72 2063 6175 7361 6c20 626f  ntdoor causal bo
+00006fc0: 6f74 7374 7261 7070 696e 6720 746f 2064  otstrapping to d
+00006fd0: 652d 636f 6e66 6f75 6e64 2074 6865 2063  e-confound the c
+00006fe0: 6175 7361 6c20 6566 6665 6374 2075 7369  ausal effect usi
+00006ff0: 6e67 2074 6865 2070 726f 7669 6465 6420  ng the provided 
+00007000: 0d0a 2020 2020 6f62 7365 7276 6174 696f  ..    observatio
+00007010: 6e61 6c20 6461 7461 2061 6e64 2064 6973  nal data and dis
+00007020: 7472 6962 7574 696f 6e20 6d61 7073 2e0d  tribution maps..
+00007030: 0a0d 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00007040: 733a 0d0a 2020 2020 2020 2020 6361 7573  s:..        caus
+00007050: 655f 6461 7461 2028 6469 6374 293a 2041  e_data (dict): A
+00007060: 2064 6963 7469 6f6e 6172 7920 636f 6e74   dictionary cont
+00007070: 6169 6e69 6e67 2074 6865 2063 6175 7365  aining the cause
+00007080: 2076 6172 6961 626c 6520 6e61 6d65 2061   variable name a
+00007090: 7320 6120 6b65 7920 616e 6420 6974 7320  s a key and its 
+000070a0: 6461 7461 2061 7272 6179 2061 7320 7468  data array as th
+000070b0: 6520 7661 6c75 652e 0d0a 2020 2020 2020  e value...      
+000070c0: 2020 6d65 6469 6174 6f72 5f64 6174 6120    mediator_data 
+000070d0: 2864 6963 7429 3a20 4120 6469 6374 696f  (dict): A dictio
+000070e0: 6e61 7279 2063 6f6e 7461 696e 696e 6720  nary containing 
+000070f0: 7468 6520 6d65 6469 6174 6f72 2076 6172  the mediator var
+00007100: 6961 626c 6520 6e61 6d65 2061 7320 6120  iable name as a 
+00007110: 6b65 7920 616e 6420 6974 7320 6461 7461  key and its data
+00007120: 2061 7272 6179 2061 7320 7468 6520 7661   array as the va
+00007130: 6c75 652e 0d0a 2020 2020 2020 2020 6566  lue...        ef
+00007140: 6665 6374 5f64 6174 6120 2864 6963 7429  fect_data (dict)
+00007150: 3a20 4120 6469 6374 696f 6e61 7279 2063  : A dictionary c
+00007160: 6f6e 7461 696e 696e 6720 7468 6520 6566  ontaining the ef
+00007170: 6665 6374 2076 6172 6961 626c 6520 6e61  fect variable na
+00007180: 6d65 2061 7320 6120 6b65 7920 616e 6420  me as a key and 
+00007190: 6974 7320 6461 7461 2061 7272 6179 2061  its data array a
+000071a0: 7320 7468 6520 7661 6c75 652e 0d0a 2020  s the value...  
+000071b0: 2020 2020 2020 6469 7374 5f6d 6170 2028        dist_map (
+000071c0: 6469 6374 293a 2041 2064 6963 7469 6f6e  dict): A diction
+000071d0: 6172 7920 6d61 7070 696e 6720 7475 706c  ary mapping tupl
+000071e0: 6573 206f 6620 7661 7269 6162 6c65 2063  es of variable c
+000071f0: 6f6d 6269 6e61 7469 6f6e 7320 746f 2074  ombinations to t
+00007200: 6865 6972 2063 6f72 7265 7370 6f6e 6469  heir correspondi
+00007210: 6e67 2064 6973 7472 6962 7574 696f 6e20  ng distribution 
+00007220: 6675 6e63 7469 6f6e 732e 0d0a 2020 2020  functions...    
+00007230: 2020 2020 696e 7476 5f76 616c 7565 2028      intv_value (
+00007240: 6c69 7374 293a 2041 206c 6973 7420 636f  list): A list co
+00007250: 6e74 6169 6e69 6e67 2074 6865 2069 6e74  ntaining the int
+00007260: 6572 7665 6e74 696f 6e61 6c20 7661 6c75  erventional valu
+00007270: 652e 0d0a 2020 2020 2020 2020 6e5f 7361  e...        n_sa
+00007280: 6d70 6c65 2028 696e 7429 3a20 5468 6520  mple (int): The 
+00007290: 6e75 6d62 6572 206f 6620 7361 6d70 6c65  number of sample
+000072a0: 7320 746f 2062 6520 6765 6e65 7261 7465  s to be generate
+000072b0: 6420 7468 726f 7567 6820 626f 6f74 7374  d through bootst
+000072c0: 7261 7070 696e 672e 0d0a 2020 2020 2020  rapping...      
+000072d0: 2020 6d6f 6465 2028 7374 722c 206f 7074    mode (str, opt
+000072e0: 696f 6e61 6c29 3a20 4120 7374 7269 6e67  ional): A string
+000072f0: 2069 6e64 6963 6174 696e 6720 7468 6520   indicating the 
+00007300: 626f 6f74 7374 7261 7070 696e 6720 6d6f  bootstrapping mo
+00007310: 6465 2e20 4974 2063 616e 2062 6520 6569  de. It can be ei
+00007320: 7468 6572 2027 6661 7374 2720 6f72 2027  ther 'fast' or '
+00007330: 726f 6275 7374 2720 6465 7065 6e64 696e  robust' dependin
+00007340: 6720 6f6e 2074 6865 2069 6d70 6c65 6d65  g on the impleme
+00007350: 6e74 6174 696f 6e2e 2044 6566 6175 6c74  ntation. Default
+00007360: 2069 7320 2766 6173 7427 2e0d 0a0d 0a20   is 'fast'..... 
+00007370: 2020 2052 6574 7572 6e73 3a0d 0a20 2020     Returns:..   
+00007380: 2020 2020 2064 6963 743a 2041 2064 6963       dict: A dic
+00007390: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
+000073a0: 6e67 2076 6172 6961 626c 6520 6e61 6d65  ng variable name
+000073b0: 7320 6173 206b 6579 7320 616e 6420 7468  s as keys and th
+000073c0: 6569 7220 636f 7272 6573 706f 6e64 696e  eir correspondin
+000073d0: 6720 6465 2d63 6f6e 666f 756e 6465 6420  g de-confounded 
+000073e0: 6461 7461 2061 7272 6179 7320 6173 2076  data arrays as v
+000073f0: 616c 7565 732e 0d0a 2020 2020 2222 220d  alues...    """.
+00007400: 0a20 2020 200d 0a20 2020 2063 6175 7365  .    ..    cause
+00007410: 5f76 6172 5f6e 616d 6520 3d20 6c69 7374  _var_name = list
+00007420: 2863 6175 7365 5f64 6174 612e 6b65 7973  (cause_data.keys
+00007430: 2829 295b 305d 0d0a 2020 2020 6566 6665  ())[0]..    effe
+00007440: 6374 5f76 6172 5f6e 616d 6520 3d20 6c69  ct_var_name = li
+00007450: 7374 2865 6666 6563 745f 6461 7461 2e6b  st(effect_data.k
+00007460: 6579 7328 2929 5b30 5d0d 0a20 2020 206d  eys())[0]..    m
+00007470: 6564 6961 746f 725f 7661 725f 6e61 6d65  ediator_var_name
+00007480: 203d 206c 6973 7428 6d65 6469 6174 6f72   = list(mediator
+00007490: 5f64 6174 612e 6b65 7973 2829 295b 305d  _data.keys())[0]
+000074a0: 0d0a 2020 2020 0d0a 2020 2020 6461 7461  ..    ..    data
+000074b0: 203d 207b 6361 7573 655f 7661 725f 6e61   = {cause_var_na
+000074c0: 6d65 2b22 2722 3a20 6c69 7374 2863 6175  me+"'": list(cau
+000074d0: 7365 5f64 6174 612e 7661 6c75 6573 2829  se_data.values()
+000074e0: 295b 305d 7d0d 0a20 2020 2064 6174 612e  )[0]}..    data.
+000074f0: 7570 6461 7465 2865 6666 6563 745f 6461  update(effect_da
+00007500: 7461 290d 0a20 2020 2064 6174 612e 7570  ta)..    data.up
+00007510: 6461 7465 286d 6564 6961 746f 725f 6461  date(mediator_da
+00007520: 7461 290d 0a20 2020 200d 0a20 2020 2063  ta)..    ..    c
+00007530: 6175 7361 6c5f 6772 6170 6820 3d20 6361  ausal_graph = ca
+00007540: 7573 655f 7661 725f 6e61 6d65 202b 2022  use_var_name + "
+00007550: 3b22 202b 2065 6666 6563 745f 7661 725f  ;" + effect_var_
+00007560: 6e61 6d65 202b 2022 3b22 202b 206d 6564  name + ";" + med
+00007570: 6961 746f 725f 7661 725f 6e61 6d65 202b  iator_var_name +
+00007580: 2022 3b20 5c6e 220d 0a20 2020 2063 6175   "; \n"..    cau
+00007590: 7361 6c5f 6772 6170 6820 3d20 6361 7573  sal_graph = caus
+000075a0: 616c 5f67 7261 7068 202b 2063 6175 7365  al_graph + cause
+000075b0: 5f76 6172 5f6e 616d 6520 2b20 222d 3e22  _var_name + "->"
+000075c0: 202b 206d 6564 6961 746f 725f 7661 725f   + mediator_var_
+000075d0: 6e61 6d65 202b 2022 3b20 5c6e 220d 0a20  name + "; \n".. 
+000075e0: 2020 2063 6175 7361 6c5f 6772 6170 6820     causal_graph 
+000075f0: 3d20 6361 7573 616c 5f67 7261 7068 202b  = causal_graph +
+00007600: 206d 6564 6961 746f 725f 7661 725f 6e61   mediator_var_na
+00007610: 6d65 202b 2022 2d3e 2220 2b20 6566 6665  me + "->" + effe
+00007620: 6374 5f76 6172 5f6e 616d 6520 2b20 223b  ct_var_name + ";
+00007630: 205c 6e22 0d0a 2020 2020 6361 7573 616c   \n"..    causal
+00007640: 5f67 7261 7068 203d 2063 6175 7361 6c5f  _graph = causal_
+00007650: 6772 6170 6820 2b20 6361 7573 655f 7661  graph + cause_va
+00007660: 725f 6e61 6d65 202b 2022 3c2d 3e22 202b  r_name + "<->" +
+00007670: 2065 6666 6563 745f 7661 725f 6e61 6d65   effect_var_name
+00007680: 202b 2022 3b20 5c6e 220d 0a20 2020 200d   + "; \n"..    .
+00007690: 0a20 2020 2077 6569 6768 745f 6675 6e63  .    weight_func
+000076a0: 5f6c 616d 2c20 7765 6967 6874 5f66 756e  _lam, weight_fun
+000076b0: 635f 7374 7220 3d20 6765 6e65 7261 6c5f  c_str = general_
+000076c0: 6362 5f61 6e61 6c79 7369 7328 6361 7573  cb_analysis(caus
+000076d0: 616c 5f67 7261 7068 203d 2063 6175 7361  al_graph = causa
+000076e0: 6c5f 6772 6170 682c 200d 0a20 2020 2020  l_graph, ..     
+000076f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007720: 2020 2020 2020 6566 6665 6374 5f76 6172        effect_var
+00007730: 5f6e 616d 6520 3d20 6566 6665 6374 5f76  _name = effect_v
+00007740: 6172 5f6e 616d 652c 200d 0a20 2020 2020  ar_name, ..     
+00007750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007780: 2020 2020 2020 6361 7573 655f 7661 725f        cause_var_
+00007790: 6e61 6d65 203d 2063 6175 7365 5f76 6172  name = cause_var
+000077a0: 5f6e 616d 652c 2069 6e66 6f5f 7072 696e  _name, info_prin
+000077b0: 743d 2046 616c 7365 290d 0a20 2020 2069  t= False)..    i
+000077c0: 6e74 765f 7661 725f 6e61 6d65 203d 2063  ntv_var_name = c
+000077d0: 6175 7365 5f76 6172 5f6e 616d 650d 0a20  ause_var_name.. 
+000077e0: 2020 2063 625f 6461 7461 203d 2067 656e     cb_data = gen
+000077f0: 6572 616c 5f63 6175 7361 6c5f 626f 6f74  eral_causal_boot
+00007800: 7374 7261 7070 696e 675f 7369 6d75 2877  strapping_simu(w
+00007810: 6569 6768 745f 6675 6e63 5f6c 616d 203d  eight_func_lam =
+00007820: 2077 6569 6768 745f 6675 6e63 5f6c 616d   weight_func_lam
+00007830: 2c20 0d0a 2020 2020 2020 2020 2020 2020  , ..            
+00007840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007860: 2020 2020 6469 7374 5f6d 6170 203d 2064      dist_map = d
+00007870: 6973 745f 6d61 702c 2064 6174 6120 3d20  ist_map, data = 
+00007880: 6461 7461 2c20 0d0a 2020 2020 2020 2020  data, ..        
+00007890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000078a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000078b0: 2020 2020 2020 2020 696e 7476 5f76 6172          intv_var
+000078c0: 5f76 616c 7565 203d 207b 696e 7476 5f76  _value = {intv_v
+000078d0: 6172 5f6e 616d 653a 2069 6e74 765f 7661  ar_name: intv_va
+000078e0: 6c75 657d 2c20 0d0a 2020 2020 2020 2020  lue}, ..        
+000078f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007910: 2020 2020 2020 2020 6e5f 7361 6d70 6c65          n_sample
+00007920: 203d 206e 5f73 616d 706c 652c 206d 6f64   = n_sample, mod
+00007930: 6520 3d20 6d6f 6465 290d 0a20 2020 2072  e = mode)..    r
+00007940: 6574 7572 6e20 6362 5f64 6174 61         eturn cb_data
```

### Comparing `CausalBootstrapping-0.1.2/distEst_lib.py` & `CausalBootstrapping-0.1.3/distEst_lib.py`

 * *Files identical despite different names*

### Comparing `CausalBootstrapping-0.1.2/setup.py` & `CausalBootstrapping-0.1.3/setup.py`

 * *Files 19% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 from setuptools import setup, find_packages
 
 setup(
     name='CausalBootstrapping',
-    version='0.1.2',
+    version='0.1.3',
     author='Jianqiao Mao',
     author_email='jxm1417@student.bham.ac.uk',
     license='GPL-3.0',
     description="CausalBootstrapping is an easy-access implementation and extention of causal bootstrapping (CB) technique for causal analysis. With certain input of observational data, causal graph and variable distributions, CB resamples the data by adjusting the variable distributions which follow intended causal effects.",
     url='https://github.com/JianqiaoMao/CausalBootstrapping',
     py_modules=['causalBootstrapping', 'distEst_lib'],
-    install_requires=['numpy', 'grapl-causal'],
+    install_requires=['numpy', 'grapl-causal', 'scipy'],
 )
```

